/*!
*  filename: ej2-data.umd.min.js.map
*  version : 1.0.19
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/

{"version":3,"sources":["ej2-data.umd.js"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","undefined","manager_1","query_1","adaptors_1","util_1","__export","hasOwnProperty","Object","defineProperty","value","apply","ej2_base_1","ej2_base_2","DataManager","dataSource","query","adaptor","_this","dateParse","requests","data","Array","json","offline","url","insertUrl","removeUrl","updateUrl","crudUrl","batchUrl","headers","accept","timeTillExpiration","cachingPageSize","enableCaching","requestType","key","crossDomain","jsonp","dataType","RemoteSaveAdaptor","requiresFormat","DataUtil","throwError","isCors","isNullOrUndefined","defaultQuery","length","isDataAvailable","ODataAdaptor","ready","executeQuery","Query","then","e","result","JsonAdaptor","CacheAdaptor","prototype","setDefaultQuery","executeLocal","processQuery","subQuery","from","fromTable","lookup","lookups","res","requiresCounts","buildHierarchy","fKey","j","extend","processResponse","using","slice","done","fail","always","deffered","Deferred","args","nextTick","getDeferedArgs","resolve","makeRequest","promise","count","aggregates","fn","window","setImmediate","setTimeout","extendRequest","fnSuccess","fnFail","type","cache","processData","onSuccess","onFailure","isSelector","subQuerySelector","error","reject","process","xhr","request","actual","virtualSelectRecords","parseInt","toString","fnQueryChild","selector","subDeffer","childArgs","parent","isChild","subUrl","childReq","subData","httpRequest","getResponseHeader","indexOf","parse","parseJson","virtualRecords","req","ajax","Ajax","beforeSend","send","push","Promise","all","_i","arguments","pResult","cResult","settings","props","keys","keys_1","prop","setRequestHeader","saveChanges","changes","tableName","batchRequest","deff","insert","position","replacer","doAjaxRequest","remove","keyField","update","defer","contentType","record","dataManager","bind","catch","consts","GroupGuid","getValue","inst","endsWith","input","substr","startsWith","start","fnSort","order","toLowerCase","fnAscending","fnDescending","x","y","localeCompare","extractFields","obj","fields","newObj","getObject","replace","select","jsonArray","newData","group","field","level","groupDs","format","jsonData","this_1","items","indx","temp","filter","childLevels","grouped","groupedArray","records","this_2","val","getVal","tempObj","aggs","source","pKey","grp","fKeyData","getFieldList","prefix","copyObj","nameSpace","splits","split","sort","ds","comparer","middle","left","right","merge","fieldName","current","shift","array","index","callAdaptorFunction","fnName","param1","param2","fnOperators","isnull","isPlainObject","constructor","getGuid","rand","crypto","arr","Uint8Array","getRandomValues","Math","random","isNull","getItemFromComparer","keyVal","castRequired","serverTimezoneOffset","Error","message","stack","sum","isNaN","average","min","max","truecount","where","falsecount","operatorSymbols","<",">","<=",">=","==","!=","*=","$=","^=","odBiOperator","lessthan","lessthanorequal","greaterthan","greaterthanorequal","equal","notequal","odUniOperator","endswith","startswith","contains","odv4UniOperator","expected","ignoreCase","notnull","processSymbols","operator","processOperator","jsonText","JSON","jsonReviver","iterateAndReviveArray","iterateAndReviveJson","test","keys_2","dupValue","ms","exec","jsonReplacer","Date","isJson","isGuid","stringify","arrayReplacer","keys_3","d","unixstamp","getTimezoneOffset","toJSON","date","queries","expands","sortedColumns","groupedColumns","params","setKey","execute","clone","cloned","addParams","expand","tables","predicate","Predicate","search","searchKey","fieldNames","sortBy","isFromGroup","sorts","filterQueries","direction","sortByDesc","page","pageIndex","pageSize","range","end","take","nos","skip","hierarchy","selectorFn","foreignKey","requiresCount","aggregate","name","q","filterQueryLists","singles","filtered","isComplex","condition","predicates","and","combinePredicates","combine","or","fromJson","len","fromJSONData","pred","validate","isAnd","ret","toJson","preds","__extends","extendStatics","setPrototypeOf","__proto__","b","__","create","Adaptor","options","pvt","_super","countFlg","agg","dm","addedRecords","changedRecords","deletedRecords","onWhere","onAggregates","onSearch","onSortBy","fnCompare","onGroup","aggQuery","tmp","onPage","size","onRange","onTake","onSkip","onSelect","splice","UrlAdaptor","hierarchyFilters","getQueryRequest","groups","filters","searches","getFiltersFrom","getRequestQuery","reqParams","_a","pvtData","convertToQueryString","request1","action","getAggregateResult","changed","added","deleted","table","keyColumn","predicats","pData","aggregateData","multipartAccept","batch","changeSet","batchPre","contentId","batchContent","changeSetContent","batchChangeSetContentType","getModuleName","onPredicate","requiresCast","guid","returnValue","getField","onComplexPredicate","onEachWhere","join","onEachSearch","onEachSort","reverse","onCount","overrideMimeType","dataCopy","results","emptyAndBatch","processBatchResponse","versionCheck","version","keys_4","initialGuid","cid","cSet","generateInsertRequest","generateUpdateRequest","generateDeleteRequest","stat","method","generateBodyContent","cIdx","jsonObj","substring","exVal","changeGuid","ODataV4Adaptor","getModulename","isDate","WebApiAdaptor","Count","Items","WebMethodAdaptor","param","setValue","timeStamp","isCrudAction","isInsertAction","cacheAdaptor","guidId","localStorage","setItem","setInterval","getItem","forDel","currentTime","requestTime","removeItem","generateKey","forEach","currentFilter","newQuery","cachedItems"],"mappings":"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","file":"ej2-data.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@syncfusion/ej2-base\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@syncfusion/ej2-base\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"@syncfusion/ej2-base\")) : factory(root[\"@syncfusion/ej2-base\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(1), __webpack_require__(4), __webpack_require__(5), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, manager_1, query_1, adaptors_1, util_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(manager_1);\n\t    __export(query_1);\n\t    __export(adaptors_1);\n\t    __export(util_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(2), __webpack_require__(3), __webpack_require__(4), __webpack_require__(5)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, ej2_base_2, util_1, query_1, adaptors_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var DataManager = (function () {\n\t        function DataManager(dataSource, query, adaptor) {\n\t            var _this = this;\n\t            this.dateParse = true;\n\t            this.requests = [];\n\t            if (!dataSource && !this.dataSource) {\n\t                dataSource = [];\n\t            }\n\t            adaptor = adaptor || dataSource.adaptor;\n\t            var data;\n\t            if (dataSource instanceof Array) {\n\t                data = {\n\t                    json: dataSource,\n\t                    offline: true\n\t                };\n\t            }\n\t            else if (typeof dataSource === 'object') {\n\t                if (!dataSource.json) {\n\t                    dataSource.json = [];\n\t                }\n\t                data = {\n\t                    url: dataSource.url,\n\t                    insertUrl: dataSource.insertUrl,\n\t                    removeUrl: dataSource.removeUrl,\n\t                    updateUrl: dataSource.updateUrl,\n\t                    crudUrl: dataSource.crudUrl,\n\t                    batchUrl: dataSource.batchUrl,\n\t                    json: dataSource.json,\n\t                    headers: dataSource.headers,\n\t                    accept: dataSource.accept,\n\t                    data: dataSource.data,\n\t                    timeTillExpiration: dataSource.timeTillExpiration,\n\t                    cachingPageSize: dataSource.cachingPageSize,\n\t                    enableCaching: dataSource.enableCaching,\n\t                    requestType: dataSource.requestType,\n\t                    key: dataSource.key,\n\t                    crossDomain: dataSource.crossDomain,\n\t                    jsonp: dataSource.jsonp,\n\t                    dataType: dataSource.dataType,\n\t                    offline: dataSource.offline !== undefined ? dataSource.offline\n\t                        : dataSource.adaptor instanceof adaptors_1.RemoteSaveAdaptor ? false : dataSource.url ? false : true,\n\t                    requiresFormat: dataSource.requiresFormat\n\t                };\n\t            }\n\t            else {\n\t                util_1.DataUtil.throwError('DataManager: Invalid arguments');\n\t            }\n\t            if (data.requiresFormat === undefined && !util_1.DataUtil.isCors()) {\n\t                data.requiresFormat = ej2_base_2.isNullOrUndefined(data.crossDomain) ? true : data.crossDomain;\n\t            }\n\t            if (data.dataType === undefined) {\n\t                data.dataType = 'json';\n\t            }\n\t            this.dataSource = data;\n\t            this.defaultQuery = query;\n\t            if (data.url && data.offline && !data.json.length) {\n\t                this.isDataAvailable = false;\n\t                this.adaptor = adaptor || new adaptors_1.ODataAdaptor();\n\t                this.dataSource.offline = false;\n\t                this.ready = this.executeQuery(query || new query_1.Query());\n\t                this.ready.then(function (e) {\n\t                    _this.dataSource.offline = true;\n\t                    _this.isDataAvailable = true;\n\t                    data.json = e.result;\n\t                    _this.adaptor = new adaptors_1.JsonAdaptor();\n\t                });\n\t            }\n\t            else {\n\t                this.adaptor = data.offline ? new adaptors_1.JsonAdaptor() : new adaptors_1.ODataAdaptor();\n\t            }\n\t            if (!data.jsonp && this.adaptor instanceof adaptors_1.ODataAdaptor) {\n\t                data.jsonp = 'callback';\n\t            }\n\t            this.adaptor = adaptor || this.adaptor;\n\t            if (data.enableCaching) {\n\t                this.adaptor = new adaptors_1.CacheAdaptor(this.adaptor, data.timeTillExpiration, data.cachingPageSize);\n\t            }\n\t            return this;\n\t        }\n\t        DataManager.prototype.setDefaultQuery = function (query) {\n\t            this.defaultQuery = query;\n\t            return this;\n\t        };\n\t        DataManager.prototype.executeLocal = function (query) {\n\t            if (!this.defaultQuery && !(query instanceof query_1.Query)) {\n\t                util_1.DataUtil.throwError('DataManager - executeLocal() : A query is required to execute');\n\t            }\n\t            if (!this.dataSource.json) {\n\t                util_1.DataUtil.throwError('DataManager - executeLocal() : Json data is required to execute');\n\t            }\n\t            query = query || this.defaultQuery;\n\t            var result = this.adaptor.processQuery(this, query);\n\t            if (query.subQuery) {\n\t                var from = query.subQuery.fromTable;\n\t                var lookup = query.subQuery.lookups;\n\t                var res = query.requiresCounts ? result.result :\n\t                    result;\n\t                if (lookup && lookup instanceof Array) {\n\t                    util_1.DataUtil.buildHierarchy(query.subQuery.fKey, from, res, lookup, query.subQuery.key);\n\t                }\n\t                for (var j = 0; j < res.length; j++) {\n\t                    if (res[j][from] instanceof Array) {\n\t                        res[j] = ej2_base_2.extend({}, {}, res[j]);\n\t                        res[j][from] = this.adaptor.processResponse(query.subQuery.using(new DataManager(res[j][from].slice(0))).executeLocal(), this, query);\n\t                    }\n\t                }\n\t            }\n\t            return this.adaptor.processResponse(result, this, query);\n\t        };\n\t        DataManager.prototype.executeQuery = function (query, done, fail, always) {\n\t            var _this = this;\n\t            if (typeof query === 'function') {\n\t                always = fail;\n\t                fail = done;\n\t                done = query;\n\t                query = null;\n\t            }\n\t            if (!query) {\n\t                query = this.defaultQuery;\n\t            }\n\t            if (!(query instanceof query_1.Query)) {\n\t                util_1.DataUtil.throwError('DataManager - executeQuery() : A query is required to execute');\n\t            }\n\t            var deffered = new Deferred();\n\t            var args = { query: query };\n\t            if (!this.dataSource.offline && this.dataSource.url !== undefined) {\n\t                var result = this.adaptor.processQuery(this, query);\n\t                this.makeRequest(result, deffered, args, query);\n\t            }\n\t            else {\n\t                DataManager.nextTick(function () {\n\t                    var res = _this.executeLocal(query);\n\t                    args = DataManager.getDeferedArgs(query, res, args);\n\t                    deffered.resolve(args);\n\t                });\n\t            }\n\t            return deffered.promise;\n\t        };\n\t        DataManager.getDeferedArgs = function (query, result, args) {\n\t            if (query.requiresCounts) {\n\t                args.result = result.result;\n\t                args.count = result.count;\n\t                args.aggregates = result.aggregates;\n\t            }\n\t            else {\n\t                args.result = result;\n\t            }\n\t            return args;\n\t        };\n\t        DataManager.nextTick = function (fn) {\n\t            (window.setImmediate || window.setTimeout)(fn, 0);\n\t        };\n\t        DataManager.prototype.extendRequest = function (url, fnSuccess, fnFail) {\n\t            return ej2_base_2.extend({}, {\n\t                type: 'GET',\n\t                dataType: this.dataSource.dataType,\n\t                crossDomain: this.dataSource.crossDomain,\n\t                jsonp: this.dataSource.jsonp,\n\t                cache: true,\n\t                processData: false,\n\t                onSuccess: fnSuccess,\n\t                onFailure: fnFail\n\t            }, url);\n\t        };\n\t        DataManager.prototype.makeRequest = function (url, deffered, args, query) {\n\t            var _this = this;\n\t            var isSelector = !!query.subQuerySelector;\n\t            var fnFail = function (e) {\n\t                args.error = e;\n\t                deffered.reject(args);\n\t            };\n\t            var process = function (data, count, xhr, request, actual, aggregates, virtualSelectRecords) {\n\t                args.xhr = xhr;\n\t                args.count = count ? parseInt(count.toString(), 10) : 0;\n\t                args.result = data;\n\t                args.request = request;\n\t                args.aggregates = aggregates;\n\t                args.actual = actual;\n\t                args.virtualSelectRecords = virtualSelectRecords;\n\t                deffered.resolve(args);\n\t            };\n\t            var fnQueryChild = function (data, selector) {\n\t                var subDeffer = new Deferred();\n\t                var childArgs = { parent: args };\n\t                query.subQuery.isChild = true;\n\t                var subUrl = _this.adaptor.processQuery(_this, query.subQuery, data ? _this.adaptor.processResponse(data) : selector);\n\t                var childReq = _this.makeRequest(subUrl, subDeffer, childArgs, query.subQuery);\n\t                if (!isSelector) {\n\t                    subDeffer.then(function (subData) {\n\t                        if (data) {\n\t                            util_1.DataUtil.buildHierarchy(query.subQuery.fKey, query.subQuery.fromTable, data, subData, query.subQuery.key);\n\t                            process(data, subData.count, subData.xhr);\n\t                        }\n\t                    }, fnFail);\n\t                }\n\t                return childReq;\n\t            };\n\t            var fnSuccess = function (data, request) {\n\t                if (request.httpRequest.getResponseHeader('Content-Type').indexOf('xml') === -1 && _this.dateParse) {\n\t                    data = util_1.DataUtil.parse.parseJson(data);\n\t                }\n\t                var result = _this.adaptor.processResponse(data, _this, query, request.httpRequest, request);\n\t                var count = 0;\n\t                var aggregates = null;\n\t                var virtualSelectRecords = 'virtualSelectRecords';\n\t                var virtualRecords = data[virtualSelectRecords];\n\t                if (query.requiresCounts) {\n\t                    count = result.count;\n\t                    aggregates = result.aggregates;\n\t                    result = result.result;\n\t                }\n\t                if (!query.subQuery) {\n\t                    process(result, count, request.httpRequest, request.type, data, aggregates, virtualRecords);\n\t                    return;\n\t                }\n\t                if (!isSelector) {\n\t                    fnQueryChild(result, request);\n\t                }\n\t            };\n\t            var req = this.extendRequest(url, fnSuccess, fnFail);\n\t            var ajax = new ej2_base_1.Ajax(req);\n\t            ajax.beforeSend = function () {\n\t                _this.beforeSend(ajax.httpRequest, ajax);\n\t            };\n\t            req = ajax.send();\n\t            this.requests.push(ajax);\n\t            if (isSelector) {\n\t                var promise = void 0;\n\t                var res = query.subQuerySelector.call(this, { query: query.subQuery, parent: query });\n\t                if (res && res.length) {\n\t                    promise = Promise.all([req, fnQueryChild(null, res)]);\n\t                    promise.then(function () {\n\t                        var args = [];\n\t                        for (var _i = 0; _i < arguments.length; _i++) {\n\t                            args[_i] = arguments[_i];\n\t                        }\n\t                        var result = args[0];\n\t                        var pResult = _this.adaptor.processResponse(result[0], _this, query, _this.requests[0].httpRequest, _this.requests[0]);\n\t                        var count = 0;\n\t                        if (query.requiresCounts) {\n\t                            count = pResult.count;\n\t                            pResult = pResult.result;\n\t                        }\n\t                        var cResult = _this.adaptor.processResponse(result[1], _this, query.subQuery, _this.requests[1].httpRequest, _this.requests[1]);\n\t                        count = 0;\n\t                        if (query.subQuery.requiresCounts) {\n\t                            count = cResult.count;\n\t                            cResult = cResult.result;\n\t                        }\n\t                        util_1.DataUtil.buildHierarchy(query.subQuery.fKey, query.subQuery.fromTable, pResult, cResult, query.subQuery.key);\n\t                        isSelector = false;\n\t                        process(pResult, count, _this.requests[0].httpRequest);\n\t                    });\n\t                }\n\t                else {\n\t                    isSelector = false;\n\t                }\n\t            }\n\t            return req;\n\t        };\n\t        DataManager.prototype.beforeSend = function (request, settings) {\n\t            this.adaptor.beforeSend(this, request, settings);\n\t            var headers = this.dataSource.headers;\n\t            var props;\n\t            for (var i = 0; headers && i < headers.length; i++) {\n\t                props = [];\n\t                var keys = Object.keys(headers[i]);\n\t                for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n\t                    var prop = keys_1[_i];\n\t                    props.push(prop);\n\t                    request.setRequestHeader(prop, headers[i][prop]);\n\t                }\n\t            }\n\t        };\n\t        DataManager.prototype.saveChanges = function (changes, key, tableName, query) {\n\t            var _this = this;\n\t            if (tableName instanceof query_1.Query) {\n\t                query = tableName;\n\t                tableName = null;\n\t            }\n\t            var args = {\n\t                url: tableName,\n\t                key: key || this.dataSource.key\n\t            };\n\t            var req = this.adaptor.batchRequest(this, changes, args, query);\n\t            if (this.dataSource.offline) {\n\t                return req;\n\t            }\n\t            var deff = new Deferred();\n\t            var ajax = new ej2_base_1.Ajax(req);\n\t            ajax.beforeSend = function () {\n\t                _this.beforeSend(ajax.httpRequest, ajax);\n\t            };\n\t            ajax.onSuccess = function (data, request) {\n\t                deff.resolve(_this, [_this.adaptor.processResponse(data, _this, null, request.httpRequest, request, changes)]);\n\t            };\n\t            ajax.onFailure = function (e) {\n\t                deff.reject([{ error: e }]);\n\t            };\n\t            ajax.send();\n\t            return deff.promise;\n\t        };\n\t        DataManager.prototype.insert = function (data, tableName, query, position) {\n\t            data = util_1.DataUtil.parse.replacer(data);\n\t            if (tableName instanceof query_1.Query) {\n\t                query = tableName;\n\t                tableName = null;\n\t            }\n\t            var req = this.adaptor.insert(this, data, tableName, query, position);\n\t            if (this.dataSource.offline) {\n\t                return req;\n\t            }\n\t            return this.doAjaxRequest(req);\n\t        };\n\t        DataManager.prototype.remove = function (keyField, value, tableName, query) {\n\t            if (typeof value === 'object') {\n\t                value = value[keyField];\n\t            }\n\t            if (tableName instanceof query_1.Query) {\n\t                query = tableName;\n\t                tableName = null;\n\t            }\n\t            var res = this.adaptor.remove(this, keyField, value, tableName, query);\n\t            if (this.dataSource.offline) {\n\t                return res;\n\t            }\n\t            return this.doAjaxRequest(res);\n\t        };\n\t        DataManager.prototype.update = function (keyField, value, tableName, query) {\n\t            value = util_1.DataUtil.parse.replacer(value, !this.dataSource.offline);\n\t            if (tableName instanceof query_1.Query) {\n\t                query = tableName;\n\t                tableName = null;\n\t            }\n\t            var res = this.adaptor.update(this, keyField, value, tableName, query);\n\t            if (this.dataSource.offline) {\n\t                return res;\n\t            }\n\t            return this.doAjaxRequest(res);\n\t        };\n\t        DataManager.prototype.doAjaxRequest = function (res) {\n\t            var _this = this;\n\t            var defer = new Deferred();\n\t            res = ej2_base_2.extend({}, {\n\t                type: 'POST',\n\t                contentType: 'application/json; charset=utf-8',\n\t                processData: false\n\t            }, res);\n\t            var ajax = new ej2_base_1.Ajax(res);\n\t            ajax.beforeSend = function () {\n\t                _this.beforeSend(ajax.httpRequest, ajax);\n\t            };\n\t            ajax.onSuccess = function (record, request) {\n\t                try {\n\t                    util_1.DataUtil.parse.parseJson(record);\n\t                }\n\t                catch (e) {\n\t                    record = [];\n\t                }\n\t                record = _this.adaptor.processResponse(util_1.DataUtil.parse.parseJson(record), _this, null, request.httpRequest, request);\n\t                defer.resolve(_this, [{ record: record, dataManager: _this }]);\n\t            };\n\t            ajax.onFailure = function (e) {\n\t                defer.reject([{ error: e }]);\n\t            };\n\t            ajax.send();\n\t            return defer.promise;\n\t        };\n\t        return DataManager;\n\t    }());\n\t    exports.DataManager = DataManager;\n\t    var Deferred = (function () {\n\t        function Deferred() {\n\t            var _this = this;\n\t            this.promise = new Promise(function (resolve, reject) {\n\t                _this.resolve = resolve;\n\t                _this.reject = reject;\n\t            });\n\t            this.then = this.promise.then.bind(this.promise);\n\t            this.catch = this.promise.catch.bind(this.promise);\n\t        }\n\t        return Deferred;\n\t    }());\n\t    exports.Deferred = Deferred;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(1), __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, manager_1, query_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var consts = { GroupGuid: '{271bbba0-1ee7}' };\n\t    var DataUtil = (function () {\n\t        function DataUtil() {\n\t        }\n\t        DataUtil.getValue = function (value, inst) {\n\t            if (typeof value === 'function') {\n\t                return value.call(inst || {});\n\t            }\n\t            return value;\n\t        };\n\t        DataUtil.endsWith = function (input, substr) {\n\t            return input.slice(-substr.length) === substr;\n\t        };\n\t        DataUtil.startsWith = function (input, start) {\n\t            return input.slice(0, start.length) === start;\n\t        };\n\t        DataUtil.fnSort = function (order) {\n\t            order = order ? order.toLowerCase() : 'ascending';\n\t            if (order === 'ascending') {\n\t                return this.fnAscending;\n\t            }\n\t            return this.fnDescending;\n\t        };\n\t        DataUtil.fnAscending = function (x, y) {\n\t            if (y === null || y === undefined) {\n\t                return -1;\n\t            }\n\t            if (typeof x === 'string') {\n\t                return x.localeCompare(y);\n\t            }\n\t            if (x === null || x === undefined) {\n\t                return 1;\n\t            }\n\t            return x - y;\n\t        };\n\t        DataUtil.fnDescending = function (x, y) {\n\t            if (y === null || y === undefined) {\n\t                return 1;\n\t            }\n\t            if (typeof x === 'string') {\n\t                return x.localeCompare(y) * -1;\n\t            }\n\t            if (x === null || x === undefined) {\n\t                return -1;\n\t            }\n\t            return y - x;\n\t        };\n\t        DataUtil.extractFields = function (obj, fields) {\n\t            var newObj = {};\n\t            if (fields.length === 1) {\n\t                return this.getObject(fields[0], obj);\n\t            }\n\t            for (var i = 0; i < fields.length; i++) {\n\t                newObj[fields[i].replace('.', '_')] = this.getObject(fields[i], obj);\n\t            }\n\t            return newObj;\n\t        };\n\t        DataUtil.select = function (jsonArray, fields) {\n\t            var newData = [];\n\t            for (var i = 0; i < jsonArray.length; i++) {\n\t                newData.push(this.extractFields(jsonArray[i], fields));\n\t            }\n\t            return newData;\n\t        };\n\t        DataUtil.group = function (jsonArray, field, aggregates, level, groupDs, format) {\n\t            level = level || 1;\n\t            var jsonData = jsonArray;\n\t            var guid = 'GroupGuid';\n\t            if (jsonData.GroupGuid === consts[guid]) {\n\t                var _loop_1 = function (j) {\n\t                    if (!ej2_base_1.isNullOrUndefined(groupDs)) {\n\t                        var indx = -1;\n\t                        var temp = groupDs.filter(function (e) { return e.key === jsonData[j].key; });\n\t                        indx = groupDs.indexOf(temp[0]);\n\t                        jsonData[j].items = this_1.group(jsonData[j].items, field, aggregates, jsonData.level + 1, groupDs[indx].items, format);\n\t                        jsonData[j].count = groupDs[indx].count;\n\t                    }\n\t                    else {\n\t                        jsonData[j].items = this_1.group(jsonData[j].items, field, aggregates, jsonData.level + 1, null, format);\n\t                        jsonData[j].count = jsonData[j].items.length;\n\t                    }\n\t                };\n\t                var this_1 = this;\n\t                for (var j = 0; j < jsonData.length; j++) {\n\t                    _loop_1(j);\n\t                }\n\t                jsonData.childLevels += 1;\n\t                return jsonData;\n\t            }\n\t            var grouped = {};\n\t            var groupedArray = [];\n\t            groupedArray.GroupGuid = consts[guid];\n\t            groupedArray.level = level;\n\t            groupedArray.childLevels = 0;\n\t            groupedArray.records = jsonData;\n\t            var _loop_2 = function (i) {\n\t                var val = this_2.getVal(jsonData, i, field);\n\t                if (!ej2_base_1.isNullOrUndefined(format)) {\n\t                    val = format(val, field);\n\t                }\n\t                if (!grouped[val]) {\n\t                    grouped[val] = {\n\t                        key: val,\n\t                        count: 0,\n\t                        items: [],\n\t                        aggregates: {},\n\t                        field: field\n\t                    };\n\t                    groupedArray.push(grouped[val]);\n\t                    if (!ej2_base_1.isNullOrUndefined(groupDs)) {\n\t                        var tempObj = groupDs.filter(function (e) { return e.key === grouped[val].key; });\n\t                        grouped[val].count = tempObj[0].count;\n\t                    }\n\t                }\n\t                grouped[val].count = !ej2_base_1.isNullOrUndefined(groupDs) ? grouped[val].count : grouped[val].count += 1;\n\t                grouped[val].items.push(jsonData[i]);\n\t            };\n\t            var this_2 = this;\n\t            for (var i = 0; i < jsonData.length; i++) {\n\t                _loop_2(i);\n\t            }\n\t            if (aggregates && aggregates.length) {\n\t                var _loop_3 = function (i) {\n\t                    var res = {};\n\t                    var fn = void 0;\n\t                    var aggs = aggregates;\n\t                    for (var j = 0; j < aggregates.length; j++) {\n\t                        fn = DataUtil.aggregates[aggregates[j].type];\n\t                        if (!ej2_base_1.isNullOrUndefined(groupDs)) {\n\t                            var temp = groupDs.filter(function (e) { return e.key === groupedArray[i].key; });\n\t                            if (fn) {\n\t                                res[aggs[j].field + ' - ' + aggs[j].type] = fn(temp[0].items, aggs[j].field);\n\t                            }\n\t                        }\n\t                        else {\n\t                            if (fn) {\n\t                                res[aggs[j].field + ' - ' + aggs[j].type] = fn(groupedArray[i].items, aggs[j].field);\n\t                            }\n\t                        }\n\t                    }\n\t                    groupedArray[i].aggregates = res;\n\t                };\n\t                for (var i = 0; i < groupedArray.length; i++) {\n\t                    _loop_3(i);\n\t                }\n\t            }\n\t            return groupedArray;\n\t        };\n\t        DataUtil.buildHierarchy = function (fKey, from, source, lookup, pKey) {\n\t            var i;\n\t            var grp = {};\n\t            var temp;\n\t            if (lookup.result) {\n\t                lookup = lookup.result;\n\t            }\n\t            if (lookup.GroupGuid) {\n\t                this.throwError('DataManager: Do not have support Grouping in hierarchy');\n\t            }\n\t            for (i = 0; i < lookup.length; i++) {\n\t                var fKeyData = this.getObject(fKey, lookup[i]);\n\t                temp = grp[fKeyData] || (grp[fKeyData] = []);\n\t                temp.push(lookup[i]);\n\t            }\n\t            for (i = 0; i < source.length; i++) {\n\t                var fKeyData = this.getObject(pKey || fKey, source[i]);\n\t                source[i][from] = grp[fKeyData];\n\t            }\n\t        };\n\t        DataUtil.getFieldList = function (obj, fields, prefix) {\n\t            if (prefix === undefined) {\n\t                prefix = '';\n\t            }\n\t            if (fields === undefined || fields === null) {\n\t                return this.getFieldList(obj, [], prefix);\n\t            }\n\t            var copyObj = obj;\n\t            var keys = Object.keys(obj);\n\t            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n\t                var prop = keys_1[_i];\n\t                if (typeof copyObj[prop] === 'object' && !(copyObj[prop] instanceof Array)) {\n\t                    this.getFieldList(copyObj[prop], fields, prefix + prop + '.');\n\t                }\n\t                else {\n\t                    fields.push(prefix + prop);\n\t                }\n\t            }\n\t            return fields;\n\t        };\n\t        DataUtil.getObject = function (nameSpace, from) {\n\t            if (!nameSpace) {\n\t                return from;\n\t            }\n\t            if (nameSpace.indexOf('.') === -1) {\n\t                return from[nameSpace];\n\t            }\n\t            var value = from;\n\t            var splits = nameSpace.split('.');\n\t            for (var i = 0; i < splits.length; i++) {\n\t                if (value == null) {\n\t                    break;\n\t                }\n\t                value = value[splits[i]];\n\t            }\n\t            return value;\n\t        };\n\t        DataUtil.sort = function (ds, field, comparer) {\n\t            if (ds.length <= 1) {\n\t                return ds;\n\t            }\n\t            var middle = parseInt((ds.length / 2).toString(), 10);\n\t            var left = ds.slice(0, middle);\n\t            var right = ds.slice(middle);\n\t            left = this.sort(left, field, comparer);\n\t            right = this.sort(right, field, comparer);\n\t            return this.merge(left, right, field, comparer);\n\t        };\n\t        DataUtil.merge = function (left, right, fieldName, comparer) {\n\t            var result = [];\n\t            var current;\n\t            while (left.length > 0 || right.length > 0) {\n\t                if (left.length > 0 && right.length > 0) {\n\t                    if (comparer) {\n\t                        current = comparer(this.getVal(left, 0, fieldName), this.getVal(right, 0, fieldName)) <= 0 ? left : right;\n\t                    }\n\t                    else {\n\t                        current = left[0][fieldName] < left[0][fieldName] ? left : right;\n\t                    }\n\t                }\n\t                else {\n\t                    current = left.length > 0 ? left : right;\n\t                }\n\t                result.push(current.shift());\n\t            }\n\t            return result;\n\t        };\n\t        DataUtil.getVal = function (array, index, field) {\n\t            return field ? this.getObject(field, array[index]) : array[index];\n\t        };\n\t        DataUtil.toLowerCase = function (val) {\n\t            return val ? typeof val === 'string' ? val.toLowerCase() : val.toString() : (val === 0 || val === false) ? val.toString() : '';\n\t        };\n\t        DataUtil.callAdaptorFunction = function (adaptor, fnName, param1, param2) {\n\t            if (fnName in adaptor) {\n\t                var res = adaptor[fnName](param1, param2);\n\t                if (!this.fnOperators.isnull(res)) {\n\t                    param1 = res;\n\t                }\n\t            }\n\t            return param1;\n\t        };\n\t        DataUtil.isPlainObject = function (obj) {\n\t            return (!!obj) && (obj.constructor === Object);\n\t        };\n\t        DataUtil.isCors = function () {\n\t            var xhr = null;\n\t            var request = 'XMLHttpRequest';\n\t            try {\n\t                xhr = new window[request]();\n\t            }\n\t            catch (e) {\n\t            }\n\t            return !!xhr && ('withCredentials' in xhr);\n\t        };\n\t        DataUtil.getGuid = function (prefix) {\n\t            var hexs = '0123456789abcdef';\n\t            var rand;\n\t            return (prefix || '') + '00000000-0000-4000-0000-000000000000'.replace(/0/g, function (val, i) {\n\t                if ('crypto' in window && 'getRandomValues' in crypto) {\n\t                    var arr = new Uint8Array(1);\n\t                    window.crypto.getRandomValues(arr);\n\t                    rand = arr[0] % 16 | 0;\n\t                }\n\t                else {\n\t                    rand = Math.random() * 16 | 0;\n\t                }\n\t                return hexs[i === 19 ? rand & 0x3 | 0x8 : rand];\n\t            });\n\t        };\n\t        DataUtil.isNull = function (val) {\n\t            return val === undefined || val === null;\n\t        };\n\t        DataUtil.getItemFromComparer = function (array, field, comparer) {\n\t            var keyVal;\n\t            var current;\n\t            var key;\n\t            var i = 0;\n\t            var castRequired = typeof DataUtil.getVal(array, 0, field) === 'string';\n\t            if (array.length) {\n\t                while (ej2_base_1.isNullOrUndefined(keyVal) && i < array.length) {\n\t                    keyVal = DataUtil.getVal(array, i, field);\n\t                    key = array[i++];\n\t                }\n\t            }\n\t            for (; i < array.length; i++) {\n\t                current = DataUtil.getVal(array, i, field);\n\t                if (ej2_base_1.isNullOrUndefined(current)) {\n\t                    continue;\n\t                }\n\t                if (castRequired) {\n\t                    keyVal = +keyVal;\n\t                    current = +current;\n\t                }\n\t                if (comparer(keyVal, current) > 0) {\n\t                    keyVal = current;\n\t                    key = array[i];\n\t                }\n\t            }\n\t            return key;\n\t        };\n\t        return DataUtil;\n\t    }());\n\t    DataUtil.serverTimezoneOffset = 0;\n\t    DataUtil.throwError = function (error) {\n\t        try {\n\t            throw new Error(error);\n\t        }\n\t        catch (e) {\n\t            throw e.message + '\\n' + e.stack;\n\t        }\n\t    };\n\t    DataUtil.aggregates = {\n\t        sum: function (ds, field) {\n\t            var result = 0;\n\t            var val;\n\t            var castRequired = typeof DataUtil.getVal(ds, 0, field) !== 'number';\n\t            for (var i = 0; i < ds.length; i++) {\n\t                val = DataUtil.getVal(ds, i, field);\n\t                if (!isNaN(val) && val !== null) {\n\t                    if (castRequired) {\n\t                        val = +val;\n\t                    }\n\t                    result += val;\n\t                }\n\t            }\n\t            return result;\n\t        },\n\t        average: function (ds, field) {\n\t            return DataUtil.aggregates.sum(ds, field) / ds.length;\n\t        },\n\t        min: function (ds, field) {\n\t            var comparer;\n\t            if (typeof field === 'function') {\n\t                comparer = field;\n\t                field = null;\n\t            }\n\t            return DataUtil.getObject(field, DataUtil.getItemFromComparer(ds, field, comparer || DataUtil.fnAscending));\n\t        },\n\t        max: function (ds, field) {\n\t            var comparer;\n\t            if (typeof field === 'function') {\n\t                comparer = field;\n\t                field = null;\n\t            }\n\t            return DataUtil.getObject(field, DataUtil.getItemFromComparer(ds, field, comparer || DataUtil.fnDescending));\n\t        },\n\t        truecount: function (ds, field) {\n\t            return new manager_1.DataManager(ds).executeLocal(new query_1.Query().where(field, 'equal', true, true)).length;\n\t        },\n\t        falsecount: function (ds, field) {\n\t            return new manager_1.DataManager(ds).executeLocal(new query_1.Query().where(field, 'equal', false, true)).length;\n\t        },\n\t        count: function (ds, field) {\n\t            return ds.length;\n\t        }\n\t    };\n\t    DataUtil.operatorSymbols = {\n\t        '<': 'lessthan',\n\t        '>': 'greaterthan',\n\t        '<=': 'lessthanorequal',\n\t        '>=': 'greaterthanorequal',\n\t        '==': 'equal',\n\t        '!=': 'notequal',\n\t        '*=': 'contains',\n\t        '$=': 'endswith',\n\t        '^=': 'startswith'\n\t    };\n\t    DataUtil.odBiOperator = {\n\t        '<': ' lt ',\n\t        '>': ' gt ',\n\t        '<=': ' le ',\n\t        '>=': ' ge ',\n\t        '==': ' eq ',\n\t        '!=': ' ne ',\n\t        'lessthan': ' lt ',\n\t        'lessthanorequal': ' le ',\n\t        'greaterthan': ' gt ',\n\t        'greaterthanorequal': ' ge ',\n\t        'equal': ' eq ',\n\t        'notequal': ' ne '\n\t    };\n\t    DataUtil.odUniOperator = {\n\t        '$=': 'endswith',\n\t        '^=': 'startswith',\n\t        '*=': 'substringof',\n\t        'endswith': 'endswith',\n\t        'startswith': 'startswith',\n\t        'contains': 'substringof'\n\t    };\n\t    DataUtil.odv4UniOperator = {\n\t        '$=': 'endswith',\n\t        '^=': 'startswith',\n\t        '*=': 'contains',\n\t        'endswith': 'endswith',\n\t        'startswith': 'startswith',\n\t        'contains': 'contains'\n\t    };\n\t    DataUtil.fnOperators = {\n\t        equal: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return DataUtil.toLowerCase(actual) === DataUtil.toLowerCase(expected);\n\t            }\n\t            return actual === expected;\n\t        },\n\t        notequal: function (actual, expected, ignoreCase) {\n\t            return !DataUtil.fnOperators.equal(actual, expected, ignoreCase);\n\t        },\n\t        lessthan: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return DataUtil.toLowerCase(actual) < DataUtil.toLowerCase(expected);\n\t            }\n\t            return actual < expected;\n\t        },\n\t        greaterthan: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return DataUtil.toLowerCase(actual) > DataUtil.toLowerCase(expected);\n\t            }\n\t            return actual > expected;\n\t        },\n\t        lessthanorequal: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return DataUtil.toLowerCase(actual) <= DataUtil.toLowerCase(expected);\n\t            }\n\t            return actual <= expected;\n\t        },\n\t        greaterthanorequal: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return DataUtil.toLowerCase(actual) >= DataUtil.toLowerCase(expected);\n\t            }\n\t            return actual >= expected;\n\t        },\n\t        contains: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return !ej2_base_1.isNullOrUndefined(actual) && !ej2_base_1.isNullOrUndefined(expected) &&\n\t                    DataUtil.toLowerCase(actual).indexOf(DataUtil.toLowerCase(expected)) !== -1;\n\t            }\n\t            return !ej2_base_1.isNullOrUndefined(actual) && !ej2_base_1.isNullOrUndefined(expected) &&\n\t                actual.toString().indexOf(expected) !== -1;\n\t        },\n\t        notnull: function (actual) {\n\t            return actual !== null;\n\t        },\n\t        isnull: function (actual) {\n\t            return actual === null;\n\t        },\n\t        startswith: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return actual && expected && DataUtil.startsWith(actual.toLowerCase(), expected.toLowerCase());\n\t            }\n\t            return actual && expected && DataUtil.startsWith(actual, expected);\n\t        },\n\t        endswith: function (actual, expected, ignoreCase) {\n\t            if (ignoreCase) {\n\t                return actual && expected && DataUtil.endsWith(actual.toLowerCase(), expected.toLowerCase());\n\t            }\n\t            return actual && expected && DataUtil.endsWith(actual, expected);\n\t        },\n\t        processSymbols: function (operator) {\n\t            var fnName = DataUtil.operatorSymbols[operator];\n\t            if (fnName) {\n\t                var fn = DataUtil.fnOperators[fnName];\n\t                return fn;\n\t            }\n\t            return DataUtil.throwError('Query - Process Operator : Invalid operator');\n\t        },\n\t        processOperator: function (operator) {\n\t            var fn = DataUtil.fnOperators[operator];\n\t            if (fn) {\n\t                return fn;\n\t            }\n\t            return DataUtil.fnOperators.processSymbols(operator);\n\t        }\n\t    };\n\t    DataUtil.parse = {\n\t        parseJson: function (jsonText) {\n\t            if (typeof jsonText === 'string') {\n\t                jsonText = JSON.parse(jsonText, DataUtil.parse.jsonReviver);\n\t            }\n\t            else if (jsonText instanceof Array) {\n\t                DataUtil.parse.iterateAndReviveArray(jsonText);\n\t            }\n\t            else if (typeof jsonText === 'object') {\n\t                DataUtil.parse.iterateAndReviveJson(jsonText);\n\t            }\n\t            return jsonText;\n\t        },\n\t        iterateAndReviveArray: function (array) {\n\t            for (var i = 0; i < array.length; i++) {\n\t                if (typeof array[i] === 'object') {\n\t                    DataUtil.parse.iterateAndReviveJson(array[i]);\n\t                }\n\t                else if (typeof array[i] === 'string' && !/^[\\s]*\\[|^[\\s]*\\{|\\\"/g.test(array[i])) {\n\t                    array[i] = DataUtil.parse.jsonReviver('', array[i]);\n\t                }\n\t                else {\n\t                    array[i] = DataUtil.parse.parseJson(array[i]);\n\t                }\n\t            }\n\t        },\n\t        iterateAndReviveJson: function (json) {\n\t            var value;\n\t            var keys = Object.keys(json);\n\t            for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {\n\t                var prop = keys_2[_i];\n\t                if (DataUtil.startsWith(prop, '__')) {\n\t                    continue;\n\t                }\n\t                value = json[prop];\n\t                if (typeof value === 'object') {\n\t                    if (value instanceof Array) {\n\t                        DataUtil.parse.iterateAndReviveArray(value);\n\t                    }\n\t                    else if (value) {\n\t                        DataUtil.parse.iterateAndReviveJson(value);\n\t                    }\n\t                }\n\t                else {\n\t                    json[prop] = DataUtil.parse.jsonReviver(json[prop], value);\n\t                }\n\t            }\n\t        },\n\t        jsonReviver: function (field, value) {\n\t            var dupValue = value;\n\t            if (typeof value === 'string') {\n\t                var ms = /^\\/Date\\(([+-]?[0-9]+)([+-][0-9]{4})?\\)\\/$/.exec(value);\n\t                if (ms) {\n\t                    return DataUtil.parse.jsonReplacer({ value: new Date(parseInt(ms[1], 10)) }, false).value;\n\t                }\n\t                else if (/^(\\d{4}\\-\\d\\d\\-\\d\\d([tT][\\d:\\.]*){1})([zZ]|([+\\-])(\\d\\d):?(\\d\\d))?$/.test(value)) {\n\t                    var arr = dupValue.split(/[^0-9]/);\n\t                    value = DataUtil.parse.jsonReplacer({\n\t                        value: new Date(parseInt(arr[0], 10), parseInt(arr[1], 10) - 1, parseInt(arr[2], 10), parseInt(arr[3], 10), parseInt(arr[4], 10), parseInt(arr[5], 10))\n\t                    }, false).value;\n\t                }\n\t            }\n\t            return value;\n\t        },\n\t        isJson: function (jsonData) {\n\t            if (typeof jsonData[0] === 'string') {\n\t                return jsonData;\n\t            }\n\t            return DataUtil.parse.parseJson(jsonData);\n\t        },\n\t        isGuid: function (value) {\n\t            var regex = /[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i;\n\t            var match = regex.exec(value);\n\t            return match != null;\n\t        },\n\t        replacer: function (value, stringify) {\n\t            if (DataUtil.isPlainObject(value)) {\n\t                return DataUtil.parse.jsonReplacer(value, stringify);\n\t            }\n\t            if (value instanceof Array) {\n\t                return DataUtil.parse.arrayReplacer(value);\n\t            }\n\t            if (value instanceof Date) {\n\t                return DataUtil.parse.jsonReplacer({ val: value }, stringify).val;\n\t            }\n\t            return value;\n\t        },\n\t        jsonReplacer: function (val, stringify) {\n\t            if (stringify === void 0) { stringify = true; }\n\t            var value;\n\t            var keys = Object.keys(val);\n\t            for (var _i = 0, keys_3 = keys; _i < keys_3.length; _i++) {\n\t                var prop = keys_3[_i];\n\t                value = val[prop];\n\t                if (!(value instanceof Date)) {\n\t                    continue;\n\t                }\n\t                var d = value;\n\t                var unixstamp = +d - (d.getTimezoneOffset() * 60000);\n\t                val[prop] = new Date(unixstamp - (DataUtil.serverTimezoneOffset * 3600000));\n\t                if (stringify) {\n\t                    val[prop] = val[prop].toJSON();\n\t                }\n\t            }\n\t            return val;\n\t        },\n\t        arrayReplacer: function (val) {\n\t            for (var i = 0; i < val.length; i++) {\n\t                if (DataUtil.isPlainObject(val[i])) {\n\t                    val[i] = DataUtil.parse.jsonReplacer(val[i]);\n\t                }\n\t                else if (val[i] instanceof Date) {\n\t                    val[i] = DataUtil.parse.jsonReplacer({ date: val[i] }).date;\n\t                }\n\t            }\n\t            return val;\n\t        }\n\t    };\n\t    exports.DataUtil = DataUtil;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, util_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var Query = (function () {\n\t        function Query(from) {\n\t            this.subQuery = null;\n\t            this.isChild = false;\n\t            this.queries = [];\n\t            this.key = '';\n\t            this.fKey = '';\n\t            if (typeof from === 'string') {\n\t                this.fromTable = from;\n\t            }\n\t            else if (from && from instanceof Array) {\n\t                this.lookups = from;\n\t            }\n\t            this.expands = [];\n\t            this.sortedColumns = [];\n\t            this.groupedColumns = [];\n\t            this.subQuery = null;\n\t            this.isChild = false;\n\t            this.params = [];\n\t            return this;\n\t        }\n\t        Query.prototype.setKey = function (field) {\n\t            this.key = field;\n\t            return this;\n\t        };\n\t        Query.prototype.using = function (dataManager) {\n\t            this.dataManager = dataManager;\n\t            return this;\n\t        };\n\t        Query.prototype.execute = function (dataManager, done, fail, always) {\n\t            dataManager = dataManager || this.dataManager;\n\t            if (dataManager) {\n\t                return dataManager.executeQuery(this, done, fail, always);\n\t            }\n\t            return util_1.DataUtil.throwError('Query - execute() : dataManager needs to be is set using \"using\" function or should be passed as argument');\n\t        };\n\t        Query.prototype.executeLocal = function (dataManager) {\n\t            dataManager = dataManager || this.dataManager;\n\t            if (dataManager) {\n\t                return dataManager.executeLocal(this);\n\t            }\n\t            return util_1.DataUtil.throwError('Query - executeLocal() : dataManager needs to be is set using \"using\" function or should be passed as argument');\n\t        };\n\t        Query.prototype.clone = function () {\n\t            var cloned = new Query();\n\t            cloned.queries = this.queries.slice(0);\n\t            cloned.key = this.key;\n\t            cloned.isChild = this.isChild;\n\t            cloned.dataManager = this.dataManager;\n\t            cloned.fromTable = this.fromTable;\n\t            cloned.params = this.params.slice(0);\n\t            cloned.expands = this.expands.slice(0);\n\t            cloned.sortedColumns = this.sortedColumns.slice(0);\n\t            cloned.groupedColumns = this.groupedColumns.slice(0);\n\t            cloned.subQuerySelector = this.subQuerySelector;\n\t            cloned.subQuery = this.subQuery;\n\t            cloned.fKey = this.fKey;\n\t            cloned.requiresCounts = this.requiresCounts;\n\t            return cloned;\n\t        };\n\t        Query.prototype.from = function (tableName) {\n\t            this.fromTable = tableName;\n\t            return this;\n\t        };\n\t        Query.prototype.addParams = function (key, value) {\n\t            if (typeof value === 'function') {\n\t                this.params.push({ key: key, fn: value });\n\t            }\n\t            else {\n\t                this.params.push({ key: key, value: value });\n\t            }\n\t            return this;\n\t        };\n\t        Query.prototype.expand = function (tables) {\n\t            if (typeof tables === 'string') {\n\t                this.expands = [].slice.call([tables], 0);\n\t            }\n\t            else {\n\t                this.expands = tables.slice(0);\n\t            }\n\t            return this;\n\t        };\n\t        Query.prototype.where = function (fieldName, operator, value, ignoreCase) {\n\t            operator = operator ? (operator).toLowerCase() : null;\n\t            var predicate = null;\n\t            if (typeof fieldName === 'string') {\n\t                predicate = new Predicate(fieldName, operator, value, ignoreCase);\n\t            }\n\t            else if (fieldName instanceof Predicate) {\n\t                predicate = fieldName;\n\t            }\n\t            this.queries.push({\n\t                fn: 'onWhere',\n\t                e: predicate\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.search = function (searchKey, fieldNames, operator, ignoreCase) {\n\t            if (typeof fieldNames === 'string') {\n\t                fieldNames = [fieldNames];\n\t            }\n\t            operator = operator || 'contains';\n\t            var comparer = util_1.DataUtil.fnOperators[operator];\n\t            this.queries.push({\n\t                fn: 'onSearch',\n\t                e: {\n\t                    fieldNames: fieldNames,\n\t                    operator: operator,\n\t                    searchKey: searchKey,\n\t                    ignoreCase: ignoreCase,\n\t                    comparer: comparer\n\t                }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.sortBy = function (fieldName, comparer, isFromGroup) {\n\t            var order = 'ascending';\n\t            var sorts;\n\t            var temp;\n\t            if (typeof fieldName === 'string' && util_1.DataUtil.endsWith(fieldName.toLowerCase(), ' desc')) {\n\t                fieldName = fieldName.replace(/ desc$/i, '');\n\t                comparer = 'descending';\n\t            }\n\t            if (!comparer || typeof comparer === 'string') {\n\t                order = comparer ? comparer.toLowerCase() : 'ascending';\n\t                comparer = util_1.DataUtil.fnSort(comparer);\n\t            }\n\t            if (isFromGroup) {\n\t                sorts = Query.filterQueries(this.queries, 'onSortBy');\n\t                for (var i = 0; i < sorts.length; i++) {\n\t                    temp = sorts[i].e.fieldName;\n\t                    if (typeof temp === 'string') {\n\t                        if (temp === fieldName) {\n\t                            return this;\n\t                        }\n\t                    }\n\t                    else if (temp instanceof Array) {\n\t                        for (var j = 0; j < temp.length; j++) {\n\t                            if (temp[j] === fieldName || fieldName.toLowerCase() === temp[j] + ' desc') {\n\t                                return this;\n\t                            }\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t            this.queries.push({\n\t                fn: 'onSortBy',\n\t                e: {\n\t                    fieldName: fieldName,\n\t                    comparer: comparer,\n\t                    direction: order\n\t                }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.sortByDesc = function (fieldName) {\n\t            return this.sortBy(fieldName, 'descending');\n\t        };\n\t        Query.prototype.group = function (fieldName, fn, format) {\n\t            this.sortBy(fieldName, null, true);\n\t            this.queries.push({\n\t                fn: 'onGroup',\n\t                e: {\n\t                    fieldName: fieldName,\n\t                    comparer: fn ? fn : null,\n\t                    format: format ? format : null\n\t                }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.page = function (pageIndex, pageSize) {\n\t            this.queries.push({\n\t                fn: 'onPage',\n\t                e: {\n\t                    pageIndex: pageIndex,\n\t                    pageSize: pageSize\n\t                }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.range = function (start, end) {\n\t            this.queries.push({\n\t                fn: 'onRange',\n\t                e: {\n\t                    start: start,\n\t                    end: end\n\t                }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.take = function (nos) {\n\t            this.queries.push({\n\t                fn: 'onTake',\n\t                e: {\n\t                    nos: nos\n\t                }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.skip = function (nos) {\n\t            this.queries.push({\n\t                fn: 'onSkip',\n\t                e: { nos: nos }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.select = function (fieldNames) {\n\t            if (typeof fieldNames === 'string') {\n\t                fieldNames = [].slice.call([fieldNames], 0);\n\t            }\n\t            this.queries.push({\n\t                fn: 'onSelect',\n\t                e: { fieldNames: fieldNames }\n\t            });\n\t            return this;\n\t        };\n\t        Query.prototype.hierarchy = function (query, selectorFn) {\n\t            this.subQuerySelector = selectorFn;\n\t            this.subQuery = query;\n\t            return this;\n\t        };\n\t        Query.prototype.foreignKey = function (key) {\n\t            this.fKey = key;\n\t            return this;\n\t        };\n\t        Query.prototype.requiresCount = function () {\n\t            this.requiresCounts = true;\n\t            return this;\n\t        };\n\t        Query.prototype.aggregate = function (type, field) {\n\t            this.queries.push({\n\t                fn: 'onAggregates',\n\t                e: { field: field, type: type }\n\t            });\n\t            return this;\n\t        };\n\t        Query.filterQueries = function (queries, name) {\n\t            return queries.filter(function (q) {\n\t                return q.fn === name;\n\t            });\n\t        };\n\t        Query.filterQueryLists = function (queries, singles) {\n\t            var filtered = queries.filter(function (q) {\n\t                return singles.indexOf(q.fn) !== -1;\n\t            });\n\t            var res = {};\n\t            for (var i = 0; i < filtered.length; i++) {\n\t                if (!res[filtered[i].fn]) {\n\t                    res[filtered[i].fn] = filtered[i].e;\n\t                }\n\t            }\n\t            return res;\n\t        };\n\t        return Query;\n\t    }());\n\t    exports.Query = Query;\n\t    var Predicate = (function () {\n\t        function Predicate(field, operator, value, ignoreCase) {\n\t            if (ignoreCase === void 0) { ignoreCase = false; }\n\t            this.isComplex = false;\n\t            if (typeof field === 'string') {\n\t                this.field = field;\n\t                this.operator = operator.toLowerCase();\n\t                this.value = value;\n\t                this.ignoreCase = ignoreCase;\n\t                this.isComplex = false;\n\t                this.comparer = util_1.DataUtil.fnOperators.processOperator(this.operator);\n\t            }\n\t            else if (field instanceof Predicate && value instanceof Predicate || value instanceof Array) {\n\t                this.isComplex = true;\n\t                this.condition = operator.toLowerCase();\n\t                this.predicates = [field];\n\t                if (value instanceof Array) {\n\t                    [].push.apply(this.predicates, value);\n\t                }\n\t                else {\n\t                    this.predicates.push(value);\n\t                }\n\t            }\n\t            return this;\n\t        }\n\t        Predicate.and = function () {\n\t            var args = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                args[_i] = arguments[_i];\n\t            }\n\t            return Predicate.combinePredicates([].slice.call(args, 0), 'and');\n\t        };\n\t        Predicate.prototype.and = function (field, operator, value, ignoreCase) {\n\t            return Predicate.combine(this, field, operator, value, 'and', ignoreCase);\n\t        };\n\t        Predicate.or = function () {\n\t            var args = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                args[_i] = arguments[_i];\n\t            }\n\t            return Predicate.combinePredicates([].slice.call(args, 0), 'or');\n\t        };\n\t        Predicate.prototype.or = function (field, operator, value, ignoreCase) {\n\t            return Predicate.combine(this, field, operator, value, 'or', ignoreCase);\n\t        };\n\t        Predicate.fromJson = function (json) {\n\t            if (json instanceof Array) {\n\t                var res = [];\n\t                for (var i = 0, len = json.length; i < len; i++) {\n\t                    res.push(this.fromJSONData(json[i]));\n\t                }\n\t                return res;\n\t            }\n\t            var pred = json;\n\t            return this.fromJSONData(pred);\n\t        };\n\t        Predicate.prototype.validate = function (record) {\n\t            var predicate = this.predicates ? this.predicates : [];\n\t            var isAnd;\n\t            var ret;\n\t            if (!this.isComplex && this.comparer) {\n\t                return this.comparer.call(this, util_1.DataUtil.getObject(this.field, record), this.value, this.ignoreCase);\n\t            }\n\t            isAnd = this.condition === 'and';\n\t            for (var i = 0; i < predicate.length; i++) {\n\t                ret = predicate[i].validate(record);\n\t                if (isAnd) {\n\t                    if (!ret) {\n\t                        return false;\n\t                    }\n\t                }\n\t                else {\n\t                    if (ret) {\n\t                        return true;\n\t                    }\n\t                }\n\t            }\n\t            return isAnd;\n\t        };\n\t        Predicate.prototype.toJson = function () {\n\t            var predicates;\n\t            var p;\n\t            if (this.isComplex) {\n\t                predicates = [];\n\t                p = this.predicates;\n\t                for (var i = 0; i < p.length; i++) {\n\t                    predicates.push(p[i].toJson());\n\t                }\n\t            }\n\t            return {\n\t                isComplex: this.isComplex,\n\t                field: this.field,\n\t                operator: this.operator,\n\t                value: this.value,\n\t                ignoreCase: this.ignoreCase,\n\t                condition: this.condition,\n\t                predicates: predicates\n\t            };\n\t        };\n\t        Predicate.combinePredicates = function (predicates, operator) {\n\t            if (predicates.length === 1) {\n\t                if (!(predicates[0] instanceof Array)) {\n\t                    return predicates[0];\n\t                }\n\t                predicates = predicates[0];\n\t            }\n\t            return new Predicate(predicates[0], operator, predicates.slice(1));\n\t        };\n\t        Predicate.combine = function (pred, field, operator, value, condition, ignoreCase) {\n\t            if (field instanceof Predicate) {\n\t                return Predicate[condition](pred, field);\n\t            }\n\t            if (typeof field === 'string') {\n\t                return Predicate[condition](pred, new Predicate(field, operator, value, ignoreCase));\n\t            }\n\t            return util_1.DataUtil.throwError('Predicate - ' + condition + ' : invalid arguments');\n\t        };\n\t        Predicate.fromJSONData = function (json) {\n\t            var preds = json.predicates || [];\n\t            var len = preds.length;\n\t            var predicates = [];\n\t            var result;\n\t            for (var i = 0; i < len; i++) {\n\t                predicates.push(this.fromJSONData(preds[i]));\n\t            }\n\t            if (!json.isComplex) {\n\t                result = new Predicate(json.field, json.operator, json.value, json.ignoreCase);\n\t            }\n\t            else {\n\t                result = new Predicate(predicates[0], json.condition, predicates.slice(1));\n\t            }\n\t            return result;\n\t        };\n\t        return Predicate;\n\t    }());\n\t    exports.Predicate = Predicate;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {\n\t    var extendStatics = Object.setPrototypeOf ||\n\t        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n\t        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n\t    return function (d, b) {\n\t        extendStatics(d, b);\n\t        function __() { this.constructor = d; }\n\t        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t    };\n\t})();\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(3), __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, util_1, query_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var Adaptor = (function () {\n\t        function Adaptor(ds) {\n\t            this.options = {\n\t                from: 'table',\n\t                requestType: 'json',\n\t                sortBy: 'sorted',\n\t                select: 'select',\n\t                skip: 'skip',\n\t                group: 'group',\n\t                take: 'take',\n\t                search: 'search',\n\t                count: 'requiresCounts',\n\t                where: 'where',\n\t                aggregates: 'aggregates'\n\t            };\n\t            this.type = Adaptor;\n\t            this.dataSource = ds;\n\t            this.pvt = {};\n\t        }\n\t        Adaptor.prototype.processResponse = function (data, ds, query, xhr) {\n\t            return data;\n\t        };\n\t        return Adaptor;\n\t    }());\n\t    exports.Adaptor = Adaptor;\n\t    var JsonAdaptor = (function (_super) {\n\t        __extends(JsonAdaptor, _super);\n\t        function JsonAdaptor() {\n\t            return _super !== null && _super.apply(this, arguments) || this;\n\t        }\n\t        JsonAdaptor.prototype.processQuery = function (dataManager, query) {\n\t            var result = dataManager.dataSource.json.slice(0);\n\t            var count = result.length;\n\t            var countFlg = true;\n\t            var ret;\n\t            var key;\n\t            var agg = {};\n\t            for (var i = 0; i < query.queries.length; i++) {\n\t                key = query.queries[i];\n\t                ret = this[key.fn].call(this, result, key.e, query);\n\t                if (key.fn === 'onAggregates') {\n\t                    agg[key.e.field + ' - ' + key.e.type] = ret;\n\t                }\n\t                else {\n\t                    result = ret !== undefined ? ret : result;\n\t                }\n\t                if (key.fn === 'onPage' || key.fn === 'onSkip' || key.fn === 'onTake' || key.fn === 'onRange') {\n\t                    countFlg = false;\n\t                }\n\t                if (countFlg) {\n\t                    count = result.length;\n\t                }\n\t            }\n\t            if (query.requiresCounts) {\n\t                result = {\n\t                    result: result,\n\t                    count: count,\n\t                    aggregates: agg\n\t                };\n\t            }\n\t            return result;\n\t        };\n\t        JsonAdaptor.prototype.batchRequest = function (dm, changes, e) {\n\t            var i;\n\t            for (i = 0; i < changes.addedRecords.length; i++) {\n\t                this.insert(dm, changes.addedRecords[i]);\n\t            }\n\t            for (i = 0; i < changes.changedRecords.length; i++) {\n\t                this.update(dm, e.key, changes.changedRecords[i]);\n\t            }\n\t            for (i = 0; i < changes.deletedRecords.length; i++) {\n\t                this.remove(dm, e.key, changes.deletedRecords[i]);\n\t            }\n\t            return changes;\n\t        };\n\t        JsonAdaptor.prototype.onWhere = function (ds, e) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            return ds.filter(function (obj) {\n\t                if (e) {\n\t                    return e.validate(obj);\n\t                }\n\t            });\n\t        };\n\t        JsonAdaptor.prototype.onAggregates = function (ds, e) {\n\t            var fn = util_1.DataUtil.aggregates[e.type];\n\t            if (!ds || !fn || ds.length === 0) {\n\t                return null;\n\t            }\n\t            return fn(ds, e.field);\n\t        };\n\t        JsonAdaptor.prototype.onSearch = function (ds, e) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            if (e.fieldNames.length === 0) {\n\t                util_1.DataUtil.getFieldList(ds[0], e.fieldNames);\n\t            }\n\t            return ds.filter(function (obj) {\n\t                for (var j = 0; j < e.fieldNames.length; j++) {\n\t                    if (e.comparer.call(obj, util_1.DataUtil.getObject(e.fieldNames[j], obj), e.searchKey, e.ignoreCase)) {\n\t                        return true;\n\t                    }\n\t                }\n\t                return false;\n\t            });\n\t        };\n\t        JsonAdaptor.prototype.onSortBy = function (ds, e, query) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            var fnCompare;\n\t            var field = util_1.DataUtil.getValue(e.fieldName, query);\n\t            if (!field) {\n\t                return ds.sort(e.comparer);\n\t            }\n\t            if (field instanceof Array) {\n\t                field = field.slice(0);\n\t                for (var i = field.length - 1; i >= 0; i--) {\n\t                    if (!field[i]) {\n\t                        continue;\n\t                    }\n\t                    fnCompare = e.comparer;\n\t                    if (util_1.DataUtil.endsWith(field[i], ' desc')) {\n\t                        fnCompare = util_1.DataUtil.fnSort('descending');\n\t                        field[i] = field[i].replace(' desc', '');\n\t                    }\n\t                    ds = util_1.DataUtil.sort(ds, field[i], fnCompare);\n\t                }\n\t                return ds;\n\t            }\n\t            return util_1.DataUtil.sort(ds, field, e.comparer);\n\t        };\n\t        JsonAdaptor.prototype.onGroup = function (ds, e, query) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            var aggQuery = query_1.Query.filterQueries(query.queries, 'onAggregates');\n\t            var agg = [];\n\t            if (aggQuery.length) {\n\t                var tmp = void 0;\n\t                for (var i = 0; i < aggQuery.length; i++) {\n\t                    tmp = aggQuery[i].e;\n\t                    agg.push({ type: tmp.type, field: util_1.DataUtil.getValue(tmp.field, query) });\n\t                }\n\t            }\n\t            return util_1.DataUtil.group(ds, util_1.DataUtil.getValue(e.fieldName, query), agg, null, null, e.comparer);\n\t        };\n\t        JsonAdaptor.prototype.onPage = function (ds, e, query) {\n\t            var size = util_1.DataUtil.getValue(e.pageSize, query);\n\t            var start = (util_1.DataUtil.getValue(e.pageIndex, query) - 1) * size;\n\t            var end = start + size;\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            return ds.slice(start, end);\n\t        };\n\t        JsonAdaptor.prototype.onRange = function (ds, e) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            return ds.slice(util_1.DataUtil.getValue(e.start), util_1.DataUtil.getValue(e.end));\n\t        };\n\t        JsonAdaptor.prototype.onTake = function (ds, e) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            return ds.slice(0, util_1.DataUtil.getValue(e.nos));\n\t        };\n\t        JsonAdaptor.prototype.onSkip = function (ds, e) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            return ds.slice(util_1.DataUtil.getValue(e.nos));\n\t        };\n\t        JsonAdaptor.prototype.onSelect = function (ds, e) {\n\t            if (!ds || !ds.length) {\n\t                return ds;\n\t            }\n\t            return util_1.DataUtil.select(ds, util_1.DataUtil.getValue(e.fieldNames));\n\t        };\n\t        JsonAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n\t            if (ej2_base_1.isNullOrUndefined(position)) {\n\t                return dm.dataSource.json.push(data);\n\t            }\n\t            else {\n\t                return dm.dataSource.json.splice(position, 0, data);\n\t            }\n\t        };\n\t        JsonAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n\t            var ds = dm.dataSource.json;\n\t            var i;\n\t            if (typeof value === 'object') {\n\t                value = value[keyField];\n\t            }\n\t            for (i = 0; i < ds.length; i++) {\n\t                if (ds[i][keyField] === value) {\n\t                    break;\n\t                }\n\t            }\n\t            return i !== ds.length ? ds.splice(i, 1) : null;\n\t        };\n\t        JsonAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n\t            var ds = dm.dataSource.json;\n\t            var i;\n\t            var key = value[keyField];\n\t            for (i = 0; i < ds.length; i++) {\n\t                if (ds[i][keyField] === key) {\n\t                    break;\n\t                }\n\t            }\n\t            return i < ds.length ? ej2_base_1.merge(ds[i], value) : null;\n\t        };\n\t        return JsonAdaptor;\n\t    }(Adaptor));\n\t    exports.JsonAdaptor = JsonAdaptor;\n\t    var UrlAdaptor = (function (_super) {\n\t        __extends(UrlAdaptor, _super);\n\t        function UrlAdaptor() {\n\t            return _super !== null && _super.apply(this, arguments) || this;\n\t        }\n\t        UrlAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n\t            var queries = this.getQueryRequest(query);\n\t            var singles = query_1.Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n\t            var params = query.params;\n\t            var url = dm.dataSource.url;\n\t            var temp;\n\t            var skip;\n\t            var take = null;\n\t            var options = this.options;\n\t            var request = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n\t            if ('onPage' in singles) {\n\t                temp = singles.onPage;\n\t                skip = util_1.DataUtil.getValue(temp.pageIndex, query);\n\t                take = util_1.DataUtil.getValue(temp.pageSize, query);\n\t                skip = (skip - 1) * take;\n\t            }\n\t            else if ('onRange' in singles) {\n\t                temp = singles.onRange;\n\t                skip = temp.start;\n\t                take = temp.end - temp.start;\n\t            }\n\t            for (var i = 0; i < queries.sorts.length; i++) {\n\t                temp = util_1.DataUtil.getValue(queries.sorts[i].e.fieldName, query);\n\t                request.sorts.push(util_1.DataUtil.callAdaptorFunction(this, 'onEachSort', { name: temp, direction: queries.sorts[i].e.direction }, query));\n\t            }\n\t            if (hierarchyFilters) {\n\t                temp = this.getFiltersFrom(hierarchyFilters, query);\n\t                if (temp) {\n\t                    request.filters.push(util_1.DataUtil.callAdaptorFunction(this, 'onEachWhere', temp.toJson(), query));\n\t                }\n\t            }\n\t            for (var i = 0; i < queries.filters.length; i++) {\n\t                request.filters.push(util_1.DataUtil.callAdaptorFunction(this, 'onEachWhere', queries.filters[i].e.toJson(), query));\n\t                var keys_1 = typeof request.filters[i] === 'object' ? Object.keys(request.filters[i]) : [];\n\t                for (var _i = 0, keys_2 = keys_1; _i < keys_2.length; _i++) {\n\t                    var prop = keys_2[_i];\n\t                    if (util_1.DataUtil.isNull((request)[prop])) {\n\t                        delete request[prop];\n\t                    }\n\t                }\n\t            }\n\t            for (var i = 0; i < queries.searches.length; i++) {\n\t                temp = queries.searches[i].e;\n\t                request.searches.push(util_1.DataUtil.callAdaptorFunction(this, 'onEachSearch', {\n\t                    fields: temp.fieldNames,\n\t                    operator: temp.operator,\n\t                    key: temp.searchKey,\n\t                    ignoreCase: temp.ignoreCase\n\t                }, query));\n\t            }\n\t            for (var i = 0; i < queries.groups.length; i++) {\n\t                request.groups.push(util_1.DataUtil.getValue(queries.groups[i].e.fieldName, query));\n\t            }\n\t            for (var i = 0; i < queries.aggregates.length; i++) {\n\t                temp = queries.aggregates[i].e;\n\t                request.aggregates.push({ type: temp.type, field: util_1.DataUtil.getValue(temp.field, query) });\n\t            }\n\t            var req = {};\n\t            this.getRequestQuery(options, query, singles, request, req);\n\t            util_1.DataUtil.callAdaptorFunction(this, 'addParams', { dm: dm, query: query, params: params, reqParams: req });\n\t            var keys = Object.keys(req);\n\t            for (var _a = 0, keys_3 = keys; _a < keys_3.length; _a++) {\n\t                var prop = keys_3[_a];\n\t                if (util_1.DataUtil.isNull(req[prop]) || req[prop] === '' || req[prop].length === 0) {\n\t                    delete req[prop];\n\t                }\n\t            }\n\t            if (!(options.skip in req && options.take in req) && take !== null) {\n\t                req[options.skip] = util_1.DataUtil.callAdaptorFunction(this, 'onSkip', skip, query);\n\t                req[options.take] = util_1.DataUtil.callAdaptorFunction(this, 'onTake', take, query);\n\t            }\n\t            var p = this.pvt;\n\t            this.pvt = {};\n\t            if (this.options.requestType === 'json') {\n\t                return {\n\t                    data: JSON.stringify(req),\n\t                    url: url,\n\t                    pvtData: p,\n\t                    type: 'POST',\n\t                    contentType: 'application/json; charset=utf-8'\n\t                };\n\t            }\n\t            temp = this.convertToQueryString(req, query, dm);\n\t            temp = (dm.dataSource.url.indexOf('?') !== -1 ? '&' : '/') + temp;\n\t            return {\n\t                type: 'GET', url: temp.length ? url.replace(/\\/*$/, temp) : url, pvtData: p\n\t            };\n\t        };\n\t        UrlAdaptor.prototype.getRequestQuery = function (options, query, singles, request, request1) {\n\t            var param = 'param';\n\t            var req = request1;\n\t            req[options.from] = query.fromTable;\n\t            if (options.expand) {\n\t                req[options.expand] = query.expands;\n\t            }\n\t            req[options.select] = 'onSelect' in singles ?\n\t                util_1.DataUtil.callAdaptorFunction(this, 'onSelect', util_1.DataUtil.getValue(singles.onSelect.fieldNames, query), query) : '';\n\t            req[options.count] = query.requiresCounts ? util_1.DataUtil.callAdaptorFunction(this, 'onCount', query.requiresCounts, query) : '';\n\t            req[options.search] = request.searches.length ? util_1.DataUtil.callAdaptorFunction(this, 'onSearch', request.searches, query) : '';\n\t            req[options.skip] = 'onSkip' in singles ?\n\t                util_1.DataUtil.callAdaptorFunction(this, 'onSkip', util_1.DataUtil.getValue(singles.onSkip.nos, query), query) : '';\n\t            req[options.take] = 'onTake' in singles ?\n\t                util_1.DataUtil.callAdaptorFunction(this, 'onTake', util_1.DataUtil.getValue(singles.onTake.nos, query), query) : '';\n\t            req[options.where] = request.filters.length || request.searches.length ?\n\t                util_1.DataUtil.callAdaptorFunction(this, 'onWhere', request.filters, query) : '';\n\t            req[options.sortBy] = request.sorts.length ? util_1.DataUtil.callAdaptorFunction(this, 'onSortBy', request.sorts, query) : '';\n\t            req[options.group] = request.groups.length ? util_1.DataUtil.callAdaptorFunction(this, 'onGroup', request.groups, query) : '';\n\t            req[options.aggregates] = request.aggregates.length ?\n\t                util_1.DataUtil.callAdaptorFunction(this, 'onAggregates', request.aggregates, query) : '';\n\t            req[param] = [];\n\t        };\n\t        UrlAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n\t            return '';\n\t        };\n\t        UrlAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n\t            var requests = request;\n\t            var pvt = requests.pvtData || {};\n\t            var groupDs = data.groupDs;\n\t            if (xhr && xhr.getResponseHeader('Content-Type') &&\n\t                xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n\t                return (query.requiresCounts ? { result: [], count: 0 } : []);\n\t            }\n\t            var d = JSON.parse(requests.data);\n\t            if (d && d.action === 'batch' && data.addedRecords) {\n\t                changes.addedRecords = data.addedRecords;\n\t                return changes;\n\t            }\n\t            if (data.d) {\n\t                data = data.d;\n\t            }\n\t            var args = {};\n\t            if ('count' in data) {\n\t                args.count = data.count;\n\t            }\n\t            args.result = data.result ? data.result : data;\n\t            this.getAggregateResult(pvt, data, args, groupDs);\n\t            return util_1.DataUtil.isNull(args.count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n\t        };\n\t        UrlAdaptor.prototype.onGroup = function (e) {\n\t            this.pvt.groups = e;\n\t            return e;\n\t        };\n\t        UrlAdaptor.prototype.onAggregates = function (e) {\n\t            this.pvt.aggregates = e;\n\t        };\n\t        UrlAdaptor.prototype.batchRequest = function (dm, changes, e) {\n\t            var url;\n\t            var key;\n\t            return {\n\t                type: 'POST',\n\t                url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.removeUrl || dm.dataSource.url,\n\t                contentType: 'application/json; charset=utf-8',\n\t                dataType: 'json',\n\t                data: JSON.stringify({\n\t                    changed: changes.changedRecords,\n\t                    added: changes.addedRecords,\n\t                    deleted: changes.deletedRecords,\n\t                    action: 'batch',\n\t                    table: e[url],\n\t                    key: e[key]\n\t                })\n\t            };\n\t        };\n\t        UrlAdaptor.prototype.beforeSend = function (dm, request) {\n\t        };\n\t        UrlAdaptor.prototype.insert = function (dm, data, tableName) {\n\t            return {\n\t                url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n\t                data: JSON.stringify({\n\t                    value: data,\n\t                    table: tableName,\n\t                    action: 'insert'\n\t                })\n\t            };\n\t        };\n\t        UrlAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n\t            return {\n\t                type: 'POST',\n\t                url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n\t                data: JSON.stringify({\n\t                    key: value,\n\t                    keyColumn: keyField,\n\t                    table: tableName,\n\t                    action: 'remove'\n\t                })\n\t            };\n\t        };\n\t        UrlAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n\t            return {\n\t                type: 'POST',\n\t                url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n\t                data: JSON.stringify({\n\t                    value: value,\n\t                    action: 'update',\n\t                    keyColumn: keyField,\n\t                    key: value[keyField],\n\t                    table: tableName\n\t                })\n\t            };\n\t        };\n\t        UrlAdaptor.prototype.getFiltersFrom = function (data, query) {\n\t            var key = query.fKey;\n\t            var value;\n\t            var prop = key;\n\t            var pKey = query.key;\n\t            var predicats = [];\n\t            if (typeof data[0] !== 'object') {\n\t                prop = null;\n\t            }\n\t            for (var i = 0; i < data.length; i++) {\n\t                if (typeof data[0] === 'object') {\n\t                    value = util_1.DataUtil.getObject(pKey || prop, data[i]);\n\t                }\n\t                else {\n\t                    value = data[i];\n\t                }\n\t                predicats.push(new query_1.Predicate(key, 'equal', value));\n\t            }\n\t            return query_1.Predicate.or(predicats);\n\t        };\n\t        UrlAdaptor.prototype.getAggregateResult = function (pvt, data, args, groupDs) {\n\t            var pData = data;\n\t            if (data && data.result) {\n\t                pData = data.result;\n\t            }\n\t            if (pvt && pvt.aggregates && pvt.aggregates.length) {\n\t                var agg = pvt.aggregates;\n\t                var fn = void 0;\n\t                var aggregateData = pData;\n\t                var res = {};\n\t                if (data.aggregate) {\n\t                    aggregateData = data.aggregate;\n\t                }\n\t                for (var i = 0; i < agg.length; i++) {\n\t                    fn = util_1.DataUtil.aggregates[agg[i].type];\n\t                    if (fn) {\n\t                        res[agg[i].field + ' - ' + agg[i].type] = fn(aggregateData, agg[i].field);\n\t                    }\n\t                }\n\t                args.aggregates = res;\n\t            }\n\t            if (pvt && pvt.groups && pvt.groups.length) {\n\t                var groups = pvt.groups;\n\t                for (var i = 0; i < groups.length; i++) {\n\t                    var level = null;\n\t                    if (!ej2_base_1.isNullOrUndefined(groupDs)) {\n\t                        groupDs = util_1.DataUtil.group(groupDs, groups[i]);\n\t                    }\n\t                    pData = util_1.DataUtil.group(pData, groups[i], pvt.aggregates, level, groupDs);\n\t                }\n\t                args.result = pData;\n\t            }\n\t            return args;\n\t        };\n\t        UrlAdaptor.prototype.getQueryRequest = function (query) {\n\t            var req = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n\t            req.sorts = query_1.Query.filterQueries(query.queries, 'onSortBy');\n\t            req.groups = query_1.Query.filterQueries(query.queries, 'onGroup');\n\t            req.filters = query_1.Query.filterQueries(query.queries, 'onWhere');\n\t            req.searches = query_1.Query.filterQueries(query.queries, 'onSearch');\n\t            req.aggregates = query_1.Query.filterQueries(query.queries, 'onAggregates');\n\t            return req;\n\t        };\n\t        UrlAdaptor.prototype.addParams = function (options) {\n\t            var req = options.reqParams;\n\t            if (options.params.length) {\n\t                req.params = {};\n\t            }\n\t            for (var _i = 0, _a = options.params; _i < _a.length; _i++) {\n\t                var tmp = _a[_i];\n\t                if (req[tmp.key]) {\n\t                    throw new Error('Query() - addParams: Custom Param is conflicting other request arguments');\n\t                }\n\t                req[tmp.key] = tmp.value;\n\t                if (tmp.fn) {\n\t                    req[tmp.key] = tmp.fn.call(options.query, tmp.key, options.query, options.dm);\n\t                }\n\t                req.params[tmp.key] = req[tmp.key];\n\t            }\n\t        };\n\t        return UrlAdaptor;\n\t    }(Adaptor));\n\t    exports.UrlAdaptor = UrlAdaptor;\n\t    var ODataAdaptor = (function (_super) {\n\t        __extends(ODataAdaptor, _super);\n\t        function ODataAdaptor() {\n\t            var _this = _super.call(this) || this;\n\t            _this.options = ej2_base_1.extend({}, _this.options, {\n\t                requestType: 'get',\n\t                accept: 'application/json;odata=light;q=1,application/json;odata=verbose;q=0.5',\n\t                multipartAccept: 'multipart/mixed',\n\t                sortBy: '$orderby',\n\t                select: '$select',\n\t                skip: '$skip',\n\t                take: '$top',\n\t                count: '$inlinecount',\n\t                where: '$filter',\n\t                expand: '$expand',\n\t                batch: '$batch',\n\t                changeSet: '--changeset_',\n\t                batchPre: 'batch_',\n\t                contentId: 'Content-Id: ',\n\t                batchContent: 'Content-Type: multipart/mixed; boundary=',\n\t                changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n\t                batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 '\n\t            });\n\t            _this.getModuleName = ej2_base_1.getValue('getModulename', _this);\n\t            return _this;\n\t        }\n\t        ODataAdaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n\t            var returnValue = '';\n\t            var operator;\n\t            var guid;\n\t            var val = predicate.value;\n\t            var type = typeof val;\n\t            var field = predicate.field ? ODataAdaptor.getField(predicate.field) : null;\n\t            if (val instanceof Date) {\n\t                val = 'datetime\\'' + util_1.DataUtil.parse.replacer(val) + '\\'';\n\t            }\n\t            if (type === 'string') {\n\t                val = '\\'' + val + '\\'';\n\t                if (requiresCast) {\n\t                    field = 'cast(' + field + ', \\'Edm.String\\')';\n\t                }\n\t                if (util_1.DataUtil.parse.isGuid(val)) {\n\t                    guid = 'guid';\n\t                }\n\t                if (predicate.ignoreCase) {\n\t                    if (!guid) {\n\t                        field = 'tolower(' + field + ')';\n\t                    }\n\t                    val = val.toLowerCase();\n\t                }\n\t            }\n\t            operator = util_1.DataUtil.odBiOperator[predicate.operator];\n\t            if (operator) {\n\t                returnValue += field;\n\t                returnValue += operator;\n\t                if (guid) {\n\t                    returnValue += guid;\n\t                }\n\t                return returnValue + val;\n\t            }\n\t            if (!ej2_base_1.isNullOrUndefined(this.getModuleName)) {\n\t                if (this.getModuleName() === 'ODataV4Adaptor') {\n\t                    operator = util_1.DataUtil.odv4UniOperator[predicate.operator];\n\t                }\n\t            }\n\t            else {\n\t                operator = util_1.DataUtil.odUniOperator[predicate.operator];\n\t            }\n\t            if (operator === 'substringof') {\n\t                var temp = val;\n\t                val = field;\n\t                field = temp;\n\t            }\n\t            returnValue += operator + '(';\n\t            returnValue += field + ',';\n\t            if (guid) {\n\t                returnValue += guid;\n\t            }\n\t            returnValue += val + ')';\n\t            return returnValue;\n\t        };\n\t        ODataAdaptor.prototype.onComplexPredicate = function (predicate, query, requiresCast) {\n\t            var res = [];\n\t            for (var i = 0; i < predicate.predicates.length; i++) {\n\t                res.push('(' + this.onEachWhere(predicate.predicates[i], query, requiresCast) + ')');\n\t            }\n\t            return res.join(' ' + predicate.condition + ' ');\n\t        };\n\t        ODataAdaptor.prototype.onEachWhere = function (filter, query, requiresCast) {\n\t            return filter.isComplex ? this.onComplexPredicate(filter, query, requiresCast) : this.onPredicate(filter, query, requiresCast);\n\t        };\n\t        ODataAdaptor.prototype.onWhere = function (filters) {\n\t            if (this.pvt.search) {\n\t                filters.push(this.onEachWhere(this.pvt.search, null, true));\n\t            }\n\t            return filters.join(' and ');\n\t        };\n\t        ODataAdaptor.prototype.onEachSearch = function (e) {\n\t            if (e.fields && e.fields.length === 0) {\n\t                util_1.DataUtil.throwError('Query() - Search : oData search requires list of field names to search');\n\t            }\n\t            var filter = this.pvt.search || [];\n\t            for (var i = 0; i < e.fields.length; i++) {\n\t                filter.push(new query_1.Predicate(e.fields[i], e.operator, e.key, e.ignoreCase));\n\t            }\n\t            this.pvt.search = filter;\n\t        };\n\t        ODataAdaptor.prototype.onSearch = function (e) {\n\t            this.pvt.search = query_1.Predicate.or(this.pvt.search);\n\t            return '';\n\t        };\n\t        ODataAdaptor.prototype.onEachSort = function (e) {\n\t            var res = [];\n\t            if (e.name instanceof Array) {\n\t                for (var i = 0; i < e.name.length; i++) {\n\t                    res.push(ODataAdaptor.getField(e.name[i]) + (e.direction === 'descending' ? ' desc' : ''));\n\t                }\n\t            }\n\t            else {\n\t                res.push(ODataAdaptor.getField(e.name) + (e.direction === 'descending' ? ' desc' : ''));\n\t            }\n\t            return res.join(',');\n\t        };\n\t        ODataAdaptor.prototype.onSortBy = function (e) {\n\t            return e.reverse().join(',');\n\t        };\n\t        ODataAdaptor.prototype.onGroup = function (e) {\n\t            this.pvt.groups = e;\n\t            return [];\n\t        };\n\t        ODataAdaptor.prototype.onSelect = function (e) {\n\t            for (var i = 0; i < e.length; i++) {\n\t                e[i] = ODataAdaptor.getField(e[i]);\n\t            }\n\t            return e.join(',');\n\t        };\n\t        ODataAdaptor.prototype.onAggregates = function (e) {\n\t            this.pvt.aggregates = e;\n\t            return '';\n\t        };\n\t        ODataAdaptor.prototype.onCount = function (e) {\n\t            return e === true ? 'allpages' : '';\n\t        };\n\t        ODataAdaptor.prototype.beforeSend = function (dm, request, settings) {\n\t            if (util_1.DataUtil.endsWith(settings.url, this.options.batch) && settings.type.toLowerCase() === 'post') {\n\t                request.setRequestHeader('Accept', this.options.multipartAccept);\n\t                request.setRequestHeader('DataServiceVersion', '2.0');\n\t                request.overrideMimeType('text/plain; charset=x-user-defined');\n\t            }\n\t            else {\n\t                request.setRequestHeader('Accept', this.options.accept);\n\t            }\n\t            request.setRequestHeader('DataServiceVersion', '2.0');\n\t            request.setRequestHeader('MaxDataServiceVersion', '2.0');\n\t        };\n\t        ODataAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n\t            var pvtData = 'pvtData';\n\t            if (!ej2_base_1.isNullOrUndefined(data.d)) {\n\t                var dataCopy = (query && query.requiresCounts) ? data.d.results : data.d;\n\t                var metaData = '__metadata';\n\t                if (!ej2_base_1.isNullOrUndefined(dataCopy)) {\n\t                    for (var i = 0; i < dataCopy.length; i++) {\n\t                        if (!ej2_base_1.isNullOrUndefined(dataCopy[i][metaData])) {\n\t                            delete dataCopy[i][metaData];\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t            var pvt = request && request[pvtData];\n\t            var emptyAndBatch = this.processBatchResponse(data, query, xhr, request, changes);\n\t            if (emptyAndBatch) {\n\t                return emptyAndBatch;\n\t            }\n\t            var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n\t            var count = null;\n\t            var version = (versionCheck && parseInt(versionCheck, 10)) || 2;\n\t            if (query && query.requiresCounts) {\n\t                var oDataCount = '__count';\n\t                if (data[oDataCount] || data['odata.count']) {\n\t                    count = data[oDataCount] || data['odata.count'];\n\t                }\n\t                if (data.d) {\n\t                    data = data.d;\n\t                }\n\t                if (data[oDataCount] || data['odata.count']) {\n\t                    count = data[oDataCount] || data['odata.count'];\n\t                }\n\t            }\n\t            if (version === 3 && data.value) {\n\t                data = data.value;\n\t            }\n\t            if (data.d) {\n\t                data = data.d;\n\t            }\n\t            if (version < 3 && data.results) {\n\t                data = data.results;\n\t            }\n\t            var args = {};\n\t            args.count = count;\n\t            args.result = data;\n\t            this.getAggregateResult(pvt, data, args);\n\t            return util_1.DataUtil.isNull(count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n\t        };\n\t        ODataAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n\t            var res = [];\n\t            var table = 'table';\n\t            var tableName = request[table] || '';\n\t            var format = '$format';\n\t            delete request[table];\n\t            if (dm.dataSource.requiresFormat) {\n\t                request[format] = 'json';\n\t            }\n\t            var keys = Object.keys(request);\n\t            for (var _i = 0, keys_4 = keys; _i < keys_4.length; _i++) {\n\t                var prop = keys_4[_i];\n\t                res.push(prop + '=' + request[prop]);\n\t            }\n\t            res = res.join('&');\n\t            if (dm.dataSource.url && dm.dataSource.url.indexOf('?') !== -1 && !tableName) {\n\t                return res;\n\t            }\n\t            return res.length ? tableName + '?' + res : tableName || '';\n\t        };\n\t        ODataAdaptor.prototype.insert = function (dm, data, tableName) {\n\t            return {\n\t                url: dm.dataSource.url.replace(/\\/*$/, tableName ? '/' + tableName : ''),\n\t                data: JSON.stringify(data)\n\t            };\n\t        };\n\t        ODataAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n\t            return {\n\t                type: 'DELETE',\n\t                url: dm.dataSource.url.replace(/\\/*$/, tableName ? '/' + tableName : '') + '(' + value + ')'\n\t            };\n\t        };\n\t        ODataAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n\t            return {\n\t                type: 'PUT',\n\t                url: dm.dataSource.url.replace(/\\/*$/, tableName ? '/' + tableName : '') + '(' + value[keyField] + ')',\n\t                data: JSON.stringify(value),\n\t                accept: this.options.accept\n\t            };\n\t        };\n\t        ODataAdaptor.prototype.batchRequest = function (dm, changes, e) {\n\t            var initialGuid = e.guid = util_1.DataUtil.getGuid(this.options.batchPre);\n\t            var url = dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n\t            var args = {\n\t                url: e.url,\n\t                key: e.key,\n\t                cid: 1,\n\t                cSet: util_1.DataUtil.getGuid(this.options.changeSet)\n\t            };\n\t            var req = '--' + initialGuid + '\\n';\n\t            req += 'Content-Type: multipart/mixed; boundary=' + args.cSet.replace('--', '') + '\\n';\n\t            this.pvt.changeSet = 0;\n\t            req += this.generateInsertRequest(changes.addedRecords, args);\n\t            req += this.generateUpdateRequest(changes.changedRecords, args);\n\t            req += this.generateDeleteRequest(changes.deletedRecords, args);\n\t            req += args.cSet + '--\\n';\n\t            req += '--' + initialGuid + '--';\n\t            return {\n\t                type: 'POST',\n\t                url: url,\n\t                dataType: 'json',\n\t                contentType: 'multipart/mixed; charset=UTF-8;boundary=' + initialGuid,\n\t                data: req\n\t            };\n\t        };\n\t        ODataAdaptor.prototype.generateDeleteRequest = function (arr, e) {\n\t            if (!arr) {\n\t                return '';\n\t            }\n\t            var req = '';\n\t            var stat = {\n\t                'method': 'DELETE ',\n\t                'url': function (data, i, key) { return '(' + data[i][key] + ')'; },\n\t                'data': function (data, i) { return ''; }\n\t            };\n\t            req = this.generateBodyContent(arr, e, stat);\n\t            return req + '\\n';\n\t        };\n\t        ODataAdaptor.prototype.generateInsertRequest = function (arr, e) {\n\t            if (!arr) {\n\t                return '';\n\t            }\n\t            var req = '';\n\t            var stat = {\n\t                'method': 'POST ',\n\t                'url': function (data, i, key) { return ''; },\n\t                'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n\t            };\n\t            req = this.generateBodyContent(arr, e, stat);\n\t            return req;\n\t        };\n\t        ODataAdaptor.prototype.generateUpdateRequest = function (arr, e) {\n\t            if (!arr) {\n\t                return '';\n\t            }\n\t            var req = '';\n\t            var stat = {\n\t                'method': 'PUT ',\n\t                'url': function (data, i, key) { return '(' + data[i][key] + ')'; },\n\t                'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n\t            };\n\t            req = this.generateBodyContent(arr, e, stat);\n\t            return req;\n\t        };\n\t        ODataAdaptor.getField = function (prop) {\n\t            return prop.replace(/\\./g, '/');\n\t        };\n\t        ODataAdaptor.prototype.generateBodyContent = function (arr, e, stat) {\n\t            var req = '';\n\t            for (var i = 0; i < arr.length; i++) {\n\t                req += '\\n' + e.cSet + '\\n';\n\t                req += this.options.changeSetContent + '\\n\\n';\n\t                req += stat.method;\n\t                req += e.url + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n\t                req += 'Accept: ' + this.options.accept + '\\n';\n\t                req += 'Content-Id: ' + this.pvt.changeSet++ + '\\n';\n\t                req += this.options.batchChangeSetContentType + '\\n\\n';\n\t                req += stat.data(arr, i);\n\t            }\n\t            return req;\n\t        };\n\t        ODataAdaptor.prototype.processBatchResponse = function (data, query, xhr, request, changes) {\n\t            if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n\t                return (query.requiresCounts ? { result: [], count: 0 } : []);\n\t            }\n\t            if (request && this.options.batch && util_1.DataUtil.endsWith(request.url, this.options.batch) && request.type.toLowerCase() === 'post') {\n\t                var guid = xhr.getResponseHeader('Content-Type');\n\t                var cIdx = void 0;\n\t                var jsonObj = void 0;\n\t                guid = guid.substring(guid.indexOf('=batchresponse') + 1);\n\t                data = data.split(guid);\n\t                if (data.length < 2) {\n\t                    return {};\n\t                }\n\t                data = data[1];\n\t                var exVal = /(?:\\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(data);\n\t                if (exVal) {\n\t                    data.replace(exVal[0], '');\n\t                }\n\t                var changeGuid = exVal ? exVal[1] : '';\n\t                data = data.split(changeGuid);\n\t                for (var i = data.length; i > -1; i--) {\n\t                    if (!/\\bContent-ID:/i.test(data[i]) || !/\\bHTTP.+201/.test(data[i])) {\n\t                        continue;\n\t                    }\n\t                    cIdx = parseInt(/\\bContent-ID: (\\d+)/i.exec(data[i])[1], 10);\n\t                    if (changes.addedRecords[cIdx]) {\n\t                        jsonObj = util_1.DataUtil.parse.parseJson(/^\\{.+\\}/m.exec(data[i])[0]);\n\t                        ej2_base_1.extend({}, changes.addedRecords[cIdx], this.processResponse(jsonObj));\n\t                    }\n\t                }\n\t                return changes;\n\t            }\n\t            return null;\n\t        };\n\t        return ODataAdaptor;\n\t    }(UrlAdaptor));\n\t    exports.ODataAdaptor = ODataAdaptor;\n\t    var ODataV4Adaptor = (function (_super) {\n\t        __extends(ODataV4Adaptor, _super);\n\t        function ODataV4Adaptor() {\n\t            var _this = _super !== null && _super.apply(this, arguments) || this;\n\t            _this.options = ej2_base_1.extend({}, _this.options, {\n\t                requestType: 'get',\n\t                accept: 'application/json, text/javascript, */*; q=0.01',\n\t                multipartAccept: 'multipart/mixed',\n\t                sortBy: '$orderby',\n\t                select: '$select',\n\t                skip: '$skip',\n\t                take: '$top',\n\t                count: '$count',\n\t                search: '$search',\n\t                where: '$filter',\n\t                expand: '$expand',\n\t                batch: '$batch',\n\t                changeSet: '--changeset_',\n\t                batchPre: 'batch_',\n\t                contentId: 'Content-Id: ',\n\t                batchContent: 'Content-Type: multipart/mixed; boundary=',\n\t                changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n\t                batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 '\n\t            });\n\t            return _this;\n\t        }\n\t        ODataV4Adaptor.prototype.getModulename = function () {\n\t            return 'ODataV4Adaptor';\n\t        };\n\t        ;\n\t        ODataV4Adaptor.prototype.onCount = function (e) {\n\t            return e === true ? 'true' : '';\n\t        };\n\t        ODataV4Adaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n\t            var returnValue = '';\n\t            var val = predicate.value;\n\t            var isDate = val instanceof Date;\n\t            returnValue = _super.prototype.onPredicate.call(this, predicate, query, requiresCast);\n\t            if (isDate) {\n\t                returnValue = returnValue.replace(/datetime'(.*)'$/, '$1');\n\t            }\n\t            return returnValue;\n\t        };\n\t        ODataV4Adaptor.prototype.onEachSearch = function (e) {\n\t            var search = this.pvt.searches || [];\n\t            search.push(e.key);\n\t            this.pvt.searches = search;\n\t        };\n\t        ODataV4Adaptor.prototype.onSearch = function (e) {\n\t            return this.pvt.searches.join(' OR ');\n\t        };\n\t        ODataV4Adaptor.prototype.beforeSend = function (dm, request, settings) {\n\t            request.setRequestHeader('Accept', this.options.accept);\n\t        };\n\t        ODataV4Adaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n\t            var pvtData = 'pvtData';\n\t            var pvt = request && request[pvtData];\n\t            var emptyAndBatch = _super.prototype.processBatchResponse.call(this, data, query, xhr, request, changes);\n\t            if (emptyAndBatch) {\n\t                return emptyAndBatch;\n\t            }\n\t            var count = null;\n\t            var dataCount = '@odata.count';\n\t            if (query && query.requiresCounts) {\n\t                if (dataCount in data) {\n\t                    count = data[dataCount];\n\t                }\n\t            }\n\t            data = data.value;\n\t            var args = {};\n\t            args.count = count;\n\t            args.result = data;\n\t            this.getAggregateResult(pvt, data, args);\n\t            return util_1.DataUtil.isNull(count) ? args.result : { result: args.result, count: count, aggregates: args.aggregates };\n\t        };\n\t        return ODataV4Adaptor;\n\t    }(ODataAdaptor));\n\t    exports.ODataV4Adaptor = ODataV4Adaptor;\n\t    var WebApiAdaptor = (function (_super) {\n\t        __extends(WebApiAdaptor, _super);\n\t        function WebApiAdaptor() {\n\t            return _super !== null && _super.apply(this, arguments) || this;\n\t        }\n\t        WebApiAdaptor.prototype.insert = function (dm, data, tableName) {\n\t            return {\n\t                type: 'POST',\n\t                url: dm.dataSource.url,\n\t                data: JSON.stringify(data)\n\t            };\n\t        };\n\t        WebApiAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n\t            return {\n\t                type: 'DELETE',\n\t                url: dm.dataSource.url + '/' + value,\n\t                data: JSON.stringify(value)\n\t            };\n\t        };\n\t        WebApiAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n\t            return {\n\t                type: 'PUT',\n\t                url: dm.dataSource.url,\n\t                data: JSON.stringify(value)\n\t            };\n\t        };\n\t        WebApiAdaptor.prototype.beforeSend = function (dm, request, settings) {\n\t            request.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');\n\t        };\n\t        WebApiAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n\t            var pvtData = 'pvtData';\n\t            var pvt = request && request[pvtData];\n\t            var count = null;\n\t            var args = {};\n\t            if (request && request.type.toLowerCase() !== 'post') {\n\t                var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n\t                var version = (versionCheck && parseInt(versionCheck, 10)) || 2;\n\t                if (query && query.requiresCounts) {\n\t                    if (!util_1.DataUtil.isNull(data.Count)) {\n\t                        count = data.Count;\n\t                    }\n\t                }\n\t                if (version < 3 && data.Items) {\n\t                    data = data.Items;\n\t                }\n\t                args.count = count;\n\t                args.result = data;\n\t                this.getAggregateResult(pvt, data, args);\n\t            }\n\t            args.result = args.result || data;\n\t            return util_1.DataUtil.isNull(count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n\t        };\n\t        return WebApiAdaptor;\n\t    }(ODataAdaptor));\n\t    exports.WebApiAdaptor = WebApiAdaptor;\n\t    var WebMethodAdaptor = (function (_super) {\n\t        __extends(WebMethodAdaptor, _super);\n\t        function WebMethodAdaptor() {\n\t            return _super !== null && _super.apply(this, arguments) || this;\n\t        }\n\t        WebMethodAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n\t            var obj = new UrlAdaptor().processQuery(dm, query, hierarchyFilters);\n\t            var getData = 'data';\n\t            var data = util_1.DataUtil.parse.parseJson(obj[getData]);\n\t            var result = {};\n\t            var value = 'value';\n\t            if (data.param) {\n\t                for (var i = 0; i < data.param.length; i++) {\n\t                    var param = data.param[i];\n\t                    var key = Object.keys(param)[0];\n\t                    result[key] = param[key];\n\t                }\n\t            }\n\t            result[value] = data;\n\t            var pvtData = 'pvtData';\n\t            var url = 'url';\n\t            return {\n\t                data: JSON.stringify(result),\n\t                url: obj[url],\n\t                pvtData: obj[pvtData],\n\t                type: 'POST',\n\t                contentType: 'application/json; charset=utf-8'\n\t            };\n\t        };\n\t        return WebMethodAdaptor;\n\t    }(UrlAdaptor));\n\t    exports.WebMethodAdaptor = WebMethodAdaptor;\n\t    var RemoteSaveAdaptor = (function (_super) {\n\t        __extends(RemoteSaveAdaptor, _super);\n\t        function RemoteSaveAdaptor() {\n\t            var _this = _super.call(this) || this;\n\t            ej2_base_1.setValue('beforeSend', UrlAdaptor.prototype.beforeSend, _this);\n\t            ej2_base_1.setValue('insert', UrlAdaptor.prototype.insert, _this);\n\t            ej2_base_1.setValue('update', UrlAdaptor.prototype.update, _this);\n\t            ej2_base_1.setValue('remove', UrlAdaptor.prototype.remove, _this);\n\t            return _this;\n\t        }\n\t        RemoteSaveAdaptor.prototype.batchRequest = function (dm, changes, e) {\n\t            var i;\n\t            for (i = 0; i < changes.addedRecords.length; i++) {\n\t                JsonAdaptor.prototype.insert(dm, changes.addedRecords[i]);\n\t            }\n\t            for (i = 0; i < changes.changedRecords.length; i++) {\n\t                JsonAdaptor.prototype.update(dm, e.key, changes.changedRecords[i]);\n\t            }\n\t            for (i = 0; i < changes.deletedRecords.length; i++) {\n\t                JsonAdaptor.prototype.remove(dm, e.key, changes.deletedRecords[i]);\n\t            }\n\t            return {\n\t                type: 'POST',\n\t                url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n\t                contentType: 'application/json; charset=utf-8',\n\t                dataType: 'json',\n\t                data: JSON.stringify({\n\t                    changed: changes.changedRecords,\n\t                    added: changes.addedRecords,\n\t                    deleted: changes.deletedRecords,\n\t                    action: 'batch',\n\t                    table: e.url,\n\t                    key: e.key\n\t                })\n\t            };\n\t        };\n\t        return RemoteSaveAdaptor;\n\t    }(JsonAdaptor));\n\t    exports.RemoteSaveAdaptor = RemoteSaveAdaptor;\n\t    var CacheAdaptor = (function (_super) {\n\t        __extends(CacheAdaptor, _super);\n\t        function CacheAdaptor(adaptor, timeStamp, pageSize) {\n\t            var _this = _super.call(this) || this;\n\t            _this.isCrudAction = false;\n\t            _this.isInsertAction = false;\n\t            if (!ej2_base_1.isNullOrUndefined(adaptor)) {\n\t                _this.cacheAdaptor = adaptor;\n\t            }\n\t            _this.pageSize = pageSize;\n\t            _this.guidId = util_1.DataUtil.getGuid('cacheAdaptor');\n\t            var obj = { keys: [], results: [] };\n\t            window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n\t            var guid = _this.guidId;\n\t            if (!ej2_base_1.isNullOrUndefined(timeStamp)) {\n\t                setInterval(function () {\n\t                    var data;\n\t                    data = util_1.DataUtil.parse.parseJson(window.localStorage.getItem(guid));\n\t                    var forDel = [];\n\t                    for (var i = 0; i < data.results.length; i++) {\n\t                        var currentTime = +new Date();\n\t                        var requestTime = +new Date(data.results[i].timeStamp);\n\t                        data.results[i].timeStamp = currentTime - requestTime;\n\t                        if (currentTime - requestTime > timeStamp) {\n\t                            forDel.push(i);\n\t                        }\n\t                    }\n\t                    for (var i = 0; i < forDel.length; i++) {\n\t                        data.results.splice(forDel[i], 1);\n\t                        data.keys.splice(forDel[i], 1);\n\t                    }\n\t                    window.localStorage.removeItem(guid);\n\t                    window.localStorage.setItem(guid, JSON.stringify(data));\n\t                }, timeStamp);\n\t            }\n\t            return _this;\n\t        }\n\t        CacheAdaptor.prototype.generateKey = function (url, query) {\n\t            var queries = this.getQueryRequest(query);\n\t            var singles = query_1.Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n\t            var key = url;\n\t            var page = 'onPage';\n\t            if (page in singles) {\n\t                key += singles[page].pageIndex;\n\t            }\n\t            queries.sorts.forEach(function (obj) {\n\t                key += obj.e.direction + obj.e.fieldName;\n\t            });\n\t            queries.groups.forEach(function (obj) {\n\t                key += obj.e.fieldName;\n\t            });\n\t            queries.searches.forEach(function (obj) {\n\t                key += obj.e.searchKey;\n\t            });\n\t            for (var filter = 0; filter < queries.filters.length; filter++) {\n\t                var currentFilter = queries.filters[filter];\n\t                if (currentFilter.e.isComplex) {\n\t                    var newQuery = query.clone();\n\t                    newQuery.queries = [];\n\t                    for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n\t                        newQuery.queries.push({ fn: 'onWhere', e: currentFilter.e.predicates[i], filter: query.queries.filter });\n\t                    }\n\t                    key += currentFilter.e.condition + this.generateKey(url, newQuery);\n\t                }\n\t                else {\n\t                    key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n\t                }\n\t            }\n\t            return key;\n\t        };\n\t        CacheAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n\t            var key = this.generateKey(dm.dataSource.url, query);\n\t            var cachedItems;\n\t            cachedItems = util_1.DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n\t            var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n\t            if (data != null && !this.isCrudAction && !this.isInsertAction) {\n\t                return data;\n\t            }\n\t            this.isCrudAction = null;\n\t            this.isInsertAction = null;\n\t            return this.cacheAdaptor.processQuery.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n\t        };\n\t        CacheAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n\t            if (this.isInsertAction || (request && this.cacheAdaptor.options.batch &&\n\t                util_1.DataUtil.endsWith(request.url, this.cacheAdaptor.options.batch) && request.type.toLowerCase() === 'post')) {\n\t                return this.cacheAdaptor.processResponse(data, ds, query, xhr, request, changes);\n\t            }\n\t            data = this.cacheAdaptor.processResponse.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n\t            var key = query ? this.generateKey(ds.dataSource.url, query) : ds.dataSource.url;\n\t            var obj = {};\n\t            obj = util_1.DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n\t            var index = obj.keys.indexOf(key);\n\t            if (index !== -1) {\n\t                obj.results.splice(index, 1);\n\t                obj.keys.splice(index, 1);\n\t            }\n\t            obj.results[obj.keys.push(key) - 1] = { keys: key, result: data.result, timeStamp: new Date(), count: data.count };\n\t            while (obj.results.length > this.pageSize) {\n\t                obj.results.splice(0, 1);\n\t                obj.keys.splice(0, 1);\n\t            }\n\t            window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n\t            return data;\n\t        };\n\t        CacheAdaptor.prototype.beforeSend = function (dm, request, settings) {\n\t            if (util_1.DataUtil.endsWith(settings.url, this.cacheAdaptor.options.batch) && settings.type.toLowerCase() === 'post') {\n\t                request.setRequestHeader('Accept', this.cacheAdaptor.options.multipartAccept);\n\t            }\n\t            if (!dm.dataSource.crossDomain) {\n\t                request.setRequestHeader('Accept', this.cacheAdaptor.options.accept);\n\t            }\n\t        };\n\t        CacheAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n\t            this.isCrudAction = true;\n\t            return this.cacheAdaptor.update(dm, keyField, value, tableName);\n\t        };\n\t        CacheAdaptor.prototype.insert = function (dm, data, tableName) {\n\t            this.isInsertAction = true;\n\t            return this.cacheAdaptor.insert(dm, data, tableName);\n\t        };\n\t        CacheAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n\t            this.isCrudAction = true;\n\t            return this.cacheAdaptor.remove(dm, keyField, value, tableName);\n\t        };\n\t        CacheAdaptor.prototype.batchRequest = function (dm, changes, e) {\n\t            return this.cacheAdaptor.batchRequest(dm, changes, e);\n\t        };\n\t        return CacheAdaptor;\n\t    }(UrlAdaptor));\n\t    exports.CacheAdaptor = CacheAdaptor;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ })\n/******/ ])\n});\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBjM2VmNDQxYTM5ZGJkYjZlZjdkYyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlcnkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FkYXB0b3JzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxPO0FDVkE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7OztpRUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFrRCxjQUFjO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQzs7Ozs7OztpRUNWRDtBQUNBO0FBQ0EsbURBQWtELGNBQWM7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFrQixrQkFBa0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUEyQixlQUFlO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW1DLHlCQUF5QjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFtQyxtQkFBbUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQSxjQUFhO0FBQ2IsaUNBQWdDLGlDQUFpQztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFtQyx1Q0FBdUM7QUFDMUUsZ0RBQStDLGdGQUFnRjtBQUMvSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW1EO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0EsRUFBQyIsImZpbGUiOiJlajItZGF0YS51bWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZmFjdG9yeShyZXF1aXJlKFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIikpIDogZmFjdG9yeShyb290W1wiQHN5bmNmdXNpb24vZWoyLWJhc2VcIl0pO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX18pIHtcbnJldHVybiBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgYzNlZjQ0MWEzOWRiZGI2ZWY3ZGMiLCJkZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCIuL21hbmFnZXJcIiwgXCIuL3F1ZXJ5XCIsIFwiLi9hZGFwdG9yc1wiLCBcIi4vdXRpbFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIG1hbmFnZXJfMSwgcXVlcnlfMSwgYWRhcHRvcnNfMSwgdXRpbF8xKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgICAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBfX2V4cG9ydChtYW5hZ2VyXzEpO1xuICAgIF9fZXhwb3J0KHF1ZXJ5XzEpO1xuICAgIF9fZXhwb3J0KGFkYXB0b3JzXzEpO1xuICAgIF9fZXhwb3J0KHV0aWxfMSk7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCIuL3V0aWxcIiwgXCIuL3F1ZXJ5XCIsIFwiLi9hZGFwdG9yc1wiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGVqMl9iYXNlXzEsIGVqMl9iYXNlXzIsIHV0aWxfMSwgcXVlcnlfMSwgYWRhcHRvcnNfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICB2YXIgRGF0YU1hbmFnZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBEYXRhTWFuYWdlcihkYXRhU291cmNlLCBxdWVyeSwgYWRhcHRvcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuZGF0ZVBhcnNlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdHMgPSBbXTtcbiAgICAgICAgICAgIGlmICghZGF0YVNvdXJjZSAmJiAhdGhpcy5kYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgZGF0YVNvdXJjZSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRhcHRvciA9IGFkYXB0b3IgfHwgZGF0YVNvdXJjZS5hZGFwdG9yO1xuICAgICAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAganNvbjogZGF0YVNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgb2ZmbGluZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZGF0YVNvdXJjZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWRhdGFTb3VyY2UuanNvbikge1xuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlLmpzb24gPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBkYXRhU291cmNlLnVybCxcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0VXJsOiBkYXRhU291cmNlLmluc2VydFVybCxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlVXJsOiBkYXRhU291cmNlLnJlbW92ZVVybCxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVXJsOiBkYXRhU291cmNlLnVwZGF0ZVVybCxcbiAgICAgICAgICAgICAgICAgICAgY3J1ZFVybDogZGF0YVNvdXJjZS5jcnVkVXJsLFxuICAgICAgICAgICAgICAgICAgICBiYXRjaFVybDogZGF0YVNvdXJjZS5iYXRjaFVybCxcbiAgICAgICAgICAgICAgICAgICAganNvbjogZGF0YVNvdXJjZS5qc29uLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBkYXRhU291cmNlLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgICAgIGFjY2VwdDogZGF0YVNvdXJjZS5hY2NlcHQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFTb3VyY2UuZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgdGltZVRpbGxFeHBpcmF0aW9uOiBkYXRhU291cmNlLnRpbWVUaWxsRXhwaXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgY2FjaGluZ1BhZ2VTaXplOiBkYXRhU291cmNlLmNhY2hpbmdQYWdlU2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlQ2FjaGluZzogZGF0YVNvdXJjZS5lbmFibGVDYWNoaW5nLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0VHlwZTogZGF0YVNvdXJjZS5yZXF1ZXN0VHlwZSxcbiAgICAgICAgICAgICAgICAgICAga2V5OiBkYXRhU291cmNlLmtleSxcbiAgICAgICAgICAgICAgICAgICAgY3Jvc3NEb21haW46IGRhdGFTb3VyY2UuY3Jvc3NEb21haW4sXG4gICAgICAgICAgICAgICAgICAgIGpzb25wOiBkYXRhU291cmNlLmpzb25wLFxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogZGF0YVNvdXJjZS5kYXRhVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgb2ZmbGluZTogZGF0YVNvdXJjZS5vZmZsaW5lICE9PSB1bmRlZmluZWQgPyBkYXRhU291cmNlLm9mZmxpbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIDogZGF0YVNvdXJjZS5hZGFwdG9yIGluc3RhbmNlb2YgYWRhcHRvcnNfMS5SZW1vdGVTYXZlQWRhcHRvciA/IGZhbHNlIDogZGF0YVNvdXJjZS51cmwgPyBmYWxzZSA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzRm9ybWF0OiBkYXRhU291cmNlLnJlcXVpcmVzRm9ybWF0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC50aHJvd0Vycm9yKCdEYXRhTWFuYWdlcjogSW52YWxpZCBhcmd1bWVudHMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLnJlcXVpcmVzRm9ybWF0ID09PSB1bmRlZmluZWQgJiYgIXV0aWxfMS5EYXRhVXRpbC5pc0NvcnMoKSkge1xuICAgICAgICAgICAgICAgIGRhdGEucmVxdWlyZXNGb3JtYXQgPSBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEuY3Jvc3NEb21haW4pID8gdHJ1ZSA6IGRhdGEuY3Jvc3NEb21haW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGF0YS5kYXRhVHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5kYXRhVHlwZSA9ICdqc29uJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZGF0YVNvdXJjZSA9IGRhdGE7XG4gICAgICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeSA9IHF1ZXJ5O1xuICAgICAgICAgICAgaWYgKGRhdGEudXJsICYmIGRhdGEub2ZmbGluZSAmJiAhZGF0YS5qc29uLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNEYXRhQXZhaWxhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGFwdG9yID0gYWRhcHRvciB8fCBuZXcgYWRhcHRvcnNfMS5PRGF0YUFkYXB0b3IoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2Uub2ZmbGluZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucmVhZHkgPSB0aGlzLmV4ZWN1dGVRdWVyeShxdWVyeSB8fCBuZXcgcXVlcnlfMS5RdWVyeSgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlYWR5LnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGF0YVNvdXJjZS5vZmZsaW5lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNEYXRhQXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qc29uID0gZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFkYXB0b3IgPSBuZXcgYWRhcHRvcnNfMS5Kc29uQWRhcHRvcigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGFwdG9yID0gZGF0YS5vZmZsaW5lID8gbmV3IGFkYXB0b3JzXzEuSnNvbkFkYXB0b3IoKSA6IG5ldyBhZGFwdG9yc18xLk9EYXRhQWRhcHRvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkYXRhLmpzb25wICYmIHRoaXMuYWRhcHRvciBpbnN0YW5jZW9mIGFkYXB0b3JzXzEuT0RhdGFBZGFwdG9yKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5qc29ucCA9ICdjYWxsYmFjayc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmFkYXB0b3IgPSBhZGFwdG9yIHx8IHRoaXMuYWRhcHRvcjtcbiAgICAgICAgICAgIGlmIChkYXRhLmVuYWJsZUNhY2hpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkYXB0b3IgPSBuZXcgYWRhcHRvcnNfMS5DYWNoZUFkYXB0b3IodGhpcy5hZGFwdG9yLCBkYXRhLnRpbWVUaWxsRXhwaXJhdGlvbiwgZGF0YS5jYWNoaW5nUGFnZVNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLnNldERlZmF1bHRRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICAgICAgdGhpcy5kZWZhdWx0UXVlcnkgPSBxdWVyeTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhTWFuYWdlci5wcm90b3R5cGUuZXhlY3V0ZUxvY2FsID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZGVmYXVsdFF1ZXJ5ICYmICEocXVlcnkgaW5zdGFuY2VvZiBxdWVyeV8xLlF1ZXJ5KSkge1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC50aHJvd0Vycm9yKCdEYXRhTWFuYWdlciAtIGV4ZWN1dGVMb2NhbCgpIDogQSBxdWVyeSBpcyByZXF1aXJlZCB0byBleGVjdXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuZGF0YVNvdXJjZS5qc29uKSB7XG4gICAgICAgICAgICAgICAgdXRpbF8xLkRhdGFVdGlsLnRocm93RXJyb3IoJ0RhdGFNYW5hZ2VyIC0gZXhlY3V0ZUxvY2FsKCkgOiBKc29uIGRhdGEgaXMgcmVxdWlyZWQgdG8gZXhlY3V0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeSB8fCB0aGlzLmRlZmF1bHRRdWVyeTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmFkYXB0b3IucHJvY2Vzc1F1ZXJ5KHRoaXMsIHF1ZXJ5KTtcbiAgICAgICAgICAgIGlmIChxdWVyeS5zdWJRdWVyeSkge1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gcXVlcnkuc3ViUXVlcnkuZnJvbVRhYmxlO1xuICAgICAgICAgICAgICAgIHZhciBsb29rdXAgPSBxdWVyeS5zdWJRdWVyeS5sb29rdXBzO1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSBxdWVyeS5yZXF1aXJlc0NvdW50cyA/IHJlc3VsdC5yZXN1bHQgOlxuICAgICAgICAgICAgICAgICAgICByZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKGxvb2t1cCAmJiBsb29rdXAgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICB1dGlsXzEuRGF0YVV0aWwuYnVpbGRIaWVyYXJjaHkocXVlcnkuc3ViUXVlcnkuZktleSwgZnJvbSwgcmVzLCBsb29rdXAsIHF1ZXJ5LnN1YlF1ZXJ5LmtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNbal1bZnJvbV0gaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzW2pdID0gZWoyX2Jhc2VfMi5leHRlbmQoe30sIHt9LCByZXNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzW2pdW2Zyb21dID0gdGhpcy5hZGFwdG9yLnByb2Nlc3NSZXNwb25zZShxdWVyeS5zdWJRdWVyeS51c2luZyhuZXcgRGF0YU1hbmFnZXIocmVzW2pdW2Zyb21dLnNsaWNlKDApKSkuZXhlY3V0ZUxvY2FsKCksIHRoaXMsIHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkYXB0b3IucHJvY2Vzc1Jlc3BvbnNlKHJlc3VsdCwgdGhpcywgcXVlcnkpO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhTWFuYWdlci5wcm90b3R5cGUuZXhlY3V0ZVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5LCBkb25lLCBmYWlsLCBhbHdheXMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgYWx3YXlzID0gZmFpbDtcbiAgICAgICAgICAgICAgICBmYWlsID0gZG9uZTtcbiAgICAgICAgICAgICAgICBkb25lID0gcXVlcnk7XG4gICAgICAgICAgICAgICAgcXVlcnkgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFxdWVyeSkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdGhpcy5kZWZhdWx0UXVlcnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShxdWVyeSBpbnN0YW5jZW9mIHF1ZXJ5XzEuUXVlcnkpKSB7XG4gICAgICAgICAgICAgICAgdXRpbF8xLkRhdGFVdGlsLnRocm93RXJyb3IoJ0RhdGFNYW5hZ2VyIC0gZXhlY3V0ZVF1ZXJ5KCkgOiBBIHF1ZXJ5IGlzIHJlcXVpcmVkIHRvIGV4ZWN1dGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWZmZXJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7IHF1ZXJ5OiBxdWVyeSB9O1xuICAgICAgICAgICAgaWYgKCF0aGlzLmRhdGFTb3VyY2Uub2ZmbGluZSAmJiB0aGlzLmRhdGFTb3VyY2UudXJsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5hZGFwdG9yLnByb2Nlc3NRdWVyeSh0aGlzLCBxdWVyeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYWtlUmVxdWVzdChyZXN1bHQsIGRlZmZlcmVkLCBhcmdzLCBxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBEYXRhTWFuYWdlci5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBfdGhpcy5leGVjdXRlTG9jYWwocXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICBhcmdzID0gRGF0YU1hbmFnZXIuZ2V0RGVmZXJlZEFyZ3MocXVlcnksIHJlcywgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmZlcmVkLnJlc29sdmUoYXJncyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZGVmZmVyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YU1hbmFnZXIuZ2V0RGVmZXJlZEFyZ3MgPSBmdW5jdGlvbiAocXVlcnksIHJlc3VsdCwgYXJncykge1xuICAgICAgICAgICAgaWYgKHF1ZXJ5LnJlcXVpcmVzQ291bnRzKSB7XG4gICAgICAgICAgICAgICAgYXJncy5yZXN1bHQgPSByZXN1bHQucmVzdWx0O1xuICAgICAgICAgICAgICAgIGFyZ3MuY291bnQgPSByZXN1bHQuY291bnQ7XG4gICAgICAgICAgICAgICAgYXJncy5hZ2dyZWdhdGVzID0gcmVzdWx0LmFnZ3JlZ2F0ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcmdzLnJlc3VsdCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhTWFuYWdlci5uZXh0VGljayA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgKHdpbmRvdy5zZXRJbW1lZGlhdGUgfHwgd2luZG93LnNldFRpbWVvdXQpKGZuLCAwKTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLmV4dGVuZFJlcXVlc3QgPSBmdW5jdGlvbiAodXJsLCBmblN1Y2Nlc3MsIGZuRmFpbCkge1xuICAgICAgICAgICAgcmV0dXJuIGVqMl9iYXNlXzIuZXh0ZW5kKHt9LCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IHRoaXMuZGF0YVNvdXJjZS5kYXRhVHlwZSxcbiAgICAgICAgICAgICAgICBjcm9zc0RvbWFpbjogdGhpcy5kYXRhU291cmNlLmNyb3NzRG9tYWluLFxuICAgICAgICAgICAgICAgIGpzb25wOiB0aGlzLmRhdGFTb3VyY2UuanNvbnAsXG4gICAgICAgICAgICAgICAgY2FjaGU6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9uU3VjY2VzczogZm5TdWNjZXNzLFxuICAgICAgICAgICAgICAgIG9uRmFpbHVyZTogZm5GYWlsXG4gICAgICAgICAgICB9LCB1cmwpO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhTWFuYWdlci5wcm90b3R5cGUubWFrZVJlcXVlc3QgPSBmdW5jdGlvbiAodXJsLCBkZWZmZXJlZCwgYXJncywgcXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgaXNTZWxlY3RvciA9ICEhcXVlcnkuc3ViUXVlcnlTZWxlY3RvcjtcbiAgICAgICAgICAgIHZhciBmbkZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGFyZ3MuZXJyb3IgPSBlO1xuICAgICAgICAgICAgICAgIGRlZmZlcmVkLnJlamVjdChhcmdzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uIChkYXRhLCBjb3VudCwgeGhyLCByZXF1ZXN0LCBhY3R1YWwsIGFnZ3JlZ2F0ZXMsIHZpcnR1YWxTZWxlY3RSZWNvcmRzKSB7XG4gICAgICAgICAgICAgICAgYXJncy54aHIgPSB4aHI7XG4gICAgICAgICAgICAgICAgYXJncy5jb3VudCA9IGNvdW50ID8gcGFyc2VJbnQoY291bnQudG9TdHJpbmcoKSwgMTApIDogMDtcbiAgICAgICAgICAgICAgICBhcmdzLnJlc3VsdCA9IGRhdGE7XG4gICAgICAgICAgICAgICAgYXJncy5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICAgICAgICAgICAgICBhcmdzLmFnZ3JlZ2F0ZXMgPSBhZ2dyZWdhdGVzO1xuICAgICAgICAgICAgICAgIGFyZ3MuYWN0dWFsID0gYWN0dWFsO1xuICAgICAgICAgICAgICAgIGFyZ3MudmlydHVhbFNlbGVjdFJlY29yZHMgPSB2aXJ0dWFsU2VsZWN0UmVjb3JkcztcbiAgICAgICAgICAgICAgICBkZWZmZXJlZC5yZXNvbHZlKGFyZ3MpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBmblF1ZXJ5Q2hpbGQgPSBmdW5jdGlvbiAoZGF0YSwgc2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ViRGVmZmVyID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkQXJncyA9IHsgcGFyZW50OiBhcmdzIH07XG4gICAgICAgICAgICAgICAgcXVlcnkuc3ViUXVlcnkuaXNDaGlsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIHN1YlVybCA9IF90aGlzLmFkYXB0b3IucHJvY2Vzc1F1ZXJ5KF90aGlzLCBxdWVyeS5zdWJRdWVyeSwgZGF0YSA/IF90aGlzLmFkYXB0b3IucHJvY2Vzc1Jlc3BvbnNlKGRhdGEpIDogc2VsZWN0b3IpO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZFJlcSA9IF90aGlzLm1ha2VSZXF1ZXN0KHN1YlVybCwgc3ViRGVmZmVyLCBjaGlsZEFyZ3MsIHF1ZXJ5LnN1YlF1ZXJ5KTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzU2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViRGVmZmVyLnRoZW4oZnVuY3Rpb24gKHN1YkRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRpbF8xLkRhdGFVdGlsLmJ1aWxkSGllcmFyY2h5KHF1ZXJ5LnN1YlF1ZXJ5LmZLZXksIHF1ZXJ5LnN1YlF1ZXJ5LmZyb21UYWJsZSwgZGF0YSwgc3ViRGF0YSwgcXVlcnkuc3ViUXVlcnkua2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzKGRhdGEsIHN1YkRhdGEuY291bnQsIHN1YkRhdGEueGhyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgZm5GYWlsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkUmVxO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBmblN1Y2Nlc3MgPSBmdW5jdGlvbiAoZGF0YSwgcmVxdWVzdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0Lmh0dHBSZXF1ZXN0LmdldFJlc3BvbnNlSGVhZGVyKCdDb250ZW50LVR5cGUnKS5pbmRleE9mKCd4bWwnKSA9PT0gLTEgJiYgX3RoaXMuZGF0ZVBhcnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB1dGlsXzEuRGF0YVV0aWwucGFyc2UucGFyc2VKc29uKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gX3RoaXMuYWRhcHRvci5wcm9jZXNzUmVzcG9uc2UoZGF0YSwgX3RoaXMsIHF1ZXJ5LCByZXF1ZXN0Lmh0dHBSZXF1ZXN0LCByZXF1ZXN0KTtcbiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBhZ2dyZWdhdGVzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgdmlydHVhbFNlbGVjdFJlY29yZHMgPSAndmlydHVhbFNlbGVjdFJlY29yZHMnO1xuICAgICAgICAgICAgICAgIHZhciB2aXJ0dWFsUmVjb3JkcyA9IGRhdGFbdmlydHVhbFNlbGVjdFJlY29yZHNdO1xuICAgICAgICAgICAgICAgIGlmIChxdWVyeS5yZXF1aXJlc0NvdW50cykge1xuICAgICAgICAgICAgICAgICAgICBjb3VudCA9IHJlc3VsdC5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlcyA9IHJlc3VsdC5hZ2dyZWdhdGVzO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5LnN1YlF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3MocmVzdWx0LCBjb3VudCwgcmVxdWVzdC5odHRwUmVxdWVzdCwgcmVxdWVzdC50eXBlLCBkYXRhLCBhZ2dyZWdhdGVzLCB2aXJ0dWFsUmVjb3Jkcyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFpc1NlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGZuUXVlcnlDaGlsZChyZXN1bHQsIHJlcXVlc3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmVxID0gdGhpcy5leHRlbmRSZXF1ZXN0KHVybCwgZm5TdWNjZXNzLCBmbkZhaWwpO1xuICAgICAgICAgICAgdmFyIGFqYXggPSBuZXcgZWoyX2Jhc2VfMS5BamF4KHJlcSk7XG4gICAgICAgICAgICBhamF4LmJlZm9yZVNlbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuYmVmb3JlU2VuZChhamF4Lmh0dHBSZXF1ZXN0LCBhamF4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXEgPSBhamF4LnNlbmQoKTtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdHMucHVzaChhamF4KTtcbiAgICAgICAgICAgIGlmIChpc1NlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHF1ZXJ5LnN1YlF1ZXJ5U2VsZWN0b3IuY2FsbCh0aGlzLCB7IHF1ZXJ5OiBxdWVyeS5zdWJRdWVyeSwgcGFyZW50OiBxdWVyeSB9KTtcbiAgICAgICAgICAgICAgICBpZiAocmVzICYmIHJlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSA9IFByb21pc2UuYWxsKFtyZXEsIGZuUXVlcnlDaGlsZChudWxsLCByZXMpXSk7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gYXJnc1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwUmVzdWx0ID0gX3RoaXMuYWRhcHRvci5wcm9jZXNzUmVzcG9uc2UocmVzdWx0WzBdLCBfdGhpcywgcXVlcnksIF90aGlzLnJlcXVlc3RzWzBdLmh0dHBSZXF1ZXN0LCBfdGhpcy5yZXF1ZXN0c1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5LnJlcXVpcmVzQ291bnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgPSBwUmVzdWx0LmNvdW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBSZXN1bHQgPSBwUmVzdWx0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjUmVzdWx0ID0gX3RoaXMuYWRhcHRvci5wcm9jZXNzUmVzcG9uc2UocmVzdWx0WzFdLCBfdGhpcywgcXVlcnkuc3ViUXVlcnksIF90aGlzLnJlcXVlc3RzWzFdLmh0dHBSZXF1ZXN0LCBfdGhpcy5yZXF1ZXN0c1sxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnkuc3ViUXVlcnkucmVxdWlyZXNDb3VudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudCA9IGNSZXN1bHQuY291bnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY1Jlc3VsdCA9IGNSZXN1bHQucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbF8xLkRhdGFVdGlsLmJ1aWxkSGllcmFyY2h5KHF1ZXJ5LnN1YlF1ZXJ5LmZLZXksIHF1ZXJ5LnN1YlF1ZXJ5LmZyb21UYWJsZSwgcFJlc3VsdCwgY1Jlc3VsdCwgcXVlcnkuc3ViUXVlcnkua2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzU2VsZWN0b3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3MocFJlc3VsdCwgY291bnQsIF90aGlzLnJlcXVlc3RzWzBdLmh0dHBSZXF1ZXN0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdG9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLmJlZm9yZVNlbmQgPSBmdW5jdGlvbiAocmVxdWVzdCwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuYWRhcHRvci5iZWZvcmVTZW5kKHRoaXMsIHJlcXVlc3QsIHNldHRpbmdzKTtcbiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gdGhpcy5kYXRhU291cmNlLmhlYWRlcnM7XG4gICAgICAgICAgICB2YXIgcHJvcHM7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaGVhZGVycyAmJiBpIDwgaGVhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHByb3BzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhoZWFkZXJzW2ldKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMSA9IGtleXM7IF9pIDwga2V5c18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGtleXNfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHByb3BzLnB1c2gocHJvcCk7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihwcm9wLCBoZWFkZXJzW2ldW3Byb3BdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERhdGFNYW5hZ2VyLnByb3RvdHlwZS5zYXZlQ2hhbmdlcyA9IGZ1bmN0aW9uIChjaGFuZ2VzLCBrZXksIHRhYmxlTmFtZSwgcXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAodGFibGVOYW1lIGluc3RhbmNlb2YgcXVlcnlfMS5RdWVyeSkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdGFibGVOYW1lO1xuICAgICAgICAgICAgICAgIHRhYmxlTmFtZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgICAgICB1cmw6IHRhYmxlTmFtZSxcbiAgICAgICAgICAgICAgICBrZXk6IGtleSB8fCB0aGlzLmRhdGFTb3VyY2Uua2V5XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHJlcSA9IHRoaXMuYWRhcHRvci5iYXRjaFJlcXVlc3QodGhpcywgY2hhbmdlcywgYXJncywgcXVlcnkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVNvdXJjZS5vZmZsaW5lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWZmID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICB2YXIgYWpheCA9IG5ldyBlajJfYmFzZV8xLkFqYXgocmVxKTtcbiAgICAgICAgICAgIGFqYXguYmVmb3JlU2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5iZWZvcmVTZW5kKGFqYXguaHR0cFJlcXVlc3QsIGFqYXgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFqYXgub25TdWNjZXNzID0gZnVuY3Rpb24gKGRhdGEsIHJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICBkZWZmLnJlc29sdmUoX3RoaXMsIFtfdGhpcy5hZGFwdG9yLnByb2Nlc3NSZXNwb25zZShkYXRhLCBfdGhpcywgbnVsbCwgcmVxdWVzdC5odHRwUmVxdWVzdCwgcmVxdWVzdCwgY2hhbmdlcyldKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhamF4Lm9uRmFpbHVyZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZGVmZi5yZWplY3QoW3sgZXJyb3I6IGUgfV0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFqYXguc2VuZCgpO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmYucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChkYXRhLCB0YWJsZU5hbWUsIHF1ZXJ5LCBwb3NpdGlvbikge1xuICAgICAgICAgICAgZGF0YSA9IHV0aWxfMS5EYXRhVXRpbC5wYXJzZS5yZXBsYWNlcihkYXRhKTtcbiAgICAgICAgICAgIGlmICh0YWJsZU5hbWUgaW5zdGFuY2VvZiBxdWVyeV8xLlF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgPSB0YWJsZU5hbWU7XG4gICAgICAgICAgICAgICAgdGFibGVOYW1lID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXEgPSB0aGlzLmFkYXB0b3IuaW5zZXJ0KHRoaXMsIGRhdGEsIHRhYmxlTmFtZSwgcXVlcnksIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRhdGFTb3VyY2Uub2ZmbGluZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kb0FqYXhSZXF1ZXN0KHJlcSk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFNYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUsIHF1ZXJ5KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVba2V5RmllbGRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRhYmxlTmFtZSBpbnN0YW5jZW9mIHF1ZXJ5XzEuUXVlcnkpIHtcbiAgICAgICAgICAgICAgICBxdWVyeSA9IHRhYmxlTmFtZTtcbiAgICAgICAgICAgICAgICB0YWJsZU5hbWUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlcyA9IHRoaXMuYWRhcHRvci5yZW1vdmUodGhpcywga2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUsIHF1ZXJ5KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRhdGFTb3VyY2Uub2ZmbGluZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kb0FqYXhSZXF1ZXN0KHJlcyk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoa2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUsIHF1ZXJ5KSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHV0aWxfMS5EYXRhVXRpbC5wYXJzZS5yZXBsYWNlcih2YWx1ZSwgIXRoaXMuZGF0YVNvdXJjZS5vZmZsaW5lKTtcbiAgICAgICAgICAgIGlmICh0YWJsZU5hbWUgaW5zdGFuY2VvZiBxdWVyeV8xLlF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgcXVlcnkgPSB0YWJsZU5hbWU7XG4gICAgICAgICAgICAgICAgdGFibGVOYW1lID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLmFkYXB0b3IudXBkYXRlKHRoaXMsIGtleUZpZWxkLCB2YWx1ZSwgdGFibGVOYW1lLCBxdWVyeSk7XG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhU291cmNlLm9mZmxpbmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9BamF4UmVxdWVzdChyZXMpO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhTWFuYWdlci5wcm90b3R5cGUuZG9BamF4UmVxdWVzdCA9IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZGVmZXIgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIHJlcyA9IGVqMl9iYXNlXzIuZXh0ZW5kKHt9LCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlXG4gICAgICAgICAgICB9LCByZXMpO1xuICAgICAgICAgICAgdmFyIGFqYXggPSBuZXcgZWoyX2Jhc2VfMS5BamF4KHJlcyk7XG4gICAgICAgICAgICBhamF4LmJlZm9yZVNlbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuYmVmb3JlU2VuZChhamF4Lmh0dHBSZXF1ZXN0LCBhamF4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhamF4Lm9uU3VjY2VzcyA9IGZ1bmN0aW9uIChyZWNvcmQsIHJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB1dGlsXzEuRGF0YVV0aWwucGFyc2UucGFyc2VKc29uKHJlY29yZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlY29yZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWNvcmQgPSBfdGhpcy5hZGFwdG9yLnByb2Nlc3NSZXNwb25zZSh1dGlsXzEuRGF0YVV0aWwucGFyc2UucGFyc2VKc29uKHJlY29yZCksIF90aGlzLCBudWxsLCByZXF1ZXN0Lmh0dHBSZXF1ZXN0LCByZXF1ZXN0KTtcbiAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKF90aGlzLCBbeyByZWNvcmQ6IHJlY29yZCwgZGF0YU1hbmFnZXI6IF90aGlzIH1dKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhamF4Lm9uRmFpbHVyZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KFt7IGVycm9yOiBlIH1dKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhamF4LnNlbmQoKTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRGF0YU1hbmFnZXI7XG4gICAgfSgpKTtcbiAgICBleHBvcnRzLkRhdGFNYW5hZ2VyID0gRGF0YU1hbmFnZXI7XG4gICAgdmFyIERlZmVycmVkID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gRGVmZXJyZWQoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmUgPSByZXNvbHZlO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy50aGVuID0gdGhpcy5wcm9taXNlLnRoZW4uYmluZCh0aGlzLnByb21pc2UpO1xuICAgICAgICAgICAgdGhpcy5jYXRjaCA9IHRoaXMucHJvbWlzZS5jYXRjaC5iaW5kKHRoaXMucHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERlZmVycmVkO1xuICAgIH0oKSk7XG4gICAgZXhwb3J0cy5EZWZlcnJlZCA9IERlZmVycmVkO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9tYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX187XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiLi9tYW5hZ2VyXCIsIFwiLi9xdWVyeVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGVqMl9iYXNlXzEsIG1hbmFnZXJfMSwgcXVlcnlfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICB2YXIgY29uc3RzID0geyBHcm91cEd1aWQ6ICd7MjcxYmJiYTAtMWVlN30nIH07XG4gICAgdmFyIERhdGFVdGlsID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gRGF0YVV0aWwoKSB7XG4gICAgICAgIH1cbiAgICAgICAgRGF0YVV0aWwuZ2V0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIGluc3QpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUuY2FsbChpbnN0IHx8IHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVV0aWwuZW5kc1dpdGggPSBmdW5jdGlvbiAoaW5wdXQsIHN1YnN0cikge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0LnNsaWNlKC1zdWJzdHIubGVuZ3RoKSA9PT0gc3Vic3RyO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5zdGFydHNXaXRoID0gZnVuY3Rpb24gKGlucHV0LCBzdGFydCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0LnNsaWNlKDAsIHN0YXJ0Lmxlbmd0aCkgPT09IHN0YXJ0O1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5mblNvcnQgPSBmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgIG9yZGVyID0gb3JkZXIgPyBvcmRlci50b0xvd2VyQ2FzZSgpIDogJ2FzY2VuZGluZyc7XG4gICAgICAgICAgICBpZiAob3JkZXIgPT09ICdhc2NlbmRpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm5Bc2NlbmRpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mbkRlc2NlbmRpbmc7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmZuQXNjZW5kaW5nID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgICAgIGlmICh5ID09PSBudWxsIHx8IHkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geC5sb2NhbGVDb21wYXJlKHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHggPT09IG51bGwgfHwgeCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geCAtIHk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmZuRGVzY2VuZGluZyA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgICAgICBpZiAoeSA9PT0gbnVsbCB8fCB5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geC5sb2NhbGVDb21wYXJlKHkpICogLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCA9PT0gbnVsbCB8fCB4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geSAtIHg7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmV4dHJhY3RGaWVsZHMgPSBmdW5jdGlvbiAob2JqLCBmaWVsZHMpIHtcbiAgICAgICAgICAgIHZhciBuZXdPYmogPSB7fTtcbiAgICAgICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T2JqZWN0KGZpZWxkc1swXSwgb2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbmV3T2JqW2ZpZWxkc1tpXS5yZXBsYWNlKCcuJywgJ18nKV0gPSB0aGlzLmdldE9iamVjdChmaWVsZHNbaV0sIG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3T2JqO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5zZWxlY3QgPSBmdW5jdGlvbiAoanNvbkFycmF5LCBmaWVsZHMpIHtcbiAgICAgICAgICAgIHZhciBuZXdEYXRhID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25BcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG5ld0RhdGEucHVzaCh0aGlzLmV4dHJhY3RGaWVsZHMoanNvbkFycmF5W2ldLCBmaWVsZHMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5ncm91cCA9IGZ1bmN0aW9uIChqc29uQXJyYXksIGZpZWxkLCBhZ2dyZWdhdGVzLCBsZXZlbCwgZ3JvdXBEcywgZm9ybWF0KSB7XG4gICAgICAgICAgICBsZXZlbCA9IGxldmVsIHx8IDE7XG4gICAgICAgICAgICB2YXIganNvbkRhdGEgPSBqc29uQXJyYXk7XG4gICAgICAgICAgICB2YXIgZ3VpZCA9ICdHcm91cEd1aWQnO1xuICAgICAgICAgICAgaWYgKGpzb25EYXRhLkdyb3VwR3VpZCA9PT0gY29uc3RzW2d1aWRdKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZ3JvdXBEcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmR4ID0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGdyb3VwRHMuZmlsdGVyKGZ1bmN0aW9uIChlKSB7IHJldHVybiBlLmtleSA9PT0ganNvbkRhdGFbal0ua2V5OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZHggPSBncm91cERzLmluZGV4T2YodGVtcFswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uRGF0YVtqXS5pdGVtcyA9IHRoaXNfMS5ncm91cChqc29uRGF0YVtqXS5pdGVtcywgZmllbGQsIGFnZ3JlZ2F0ZXMsIGpzb25EYXRhLmxldmVsICsgMSwgZ3JvdXBEc1tpbmR4XS5pdGVtcywgZm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb25EYXRhW2pdLmNvdW50ID0gZ3JvdXBEc1tpbmR4XS5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb25EYXRhW2pdLml0ZW1zID0gdGhpc18xLmdyb3VwKGpzb25EYXRhW2pdLml0ZW1zLCBmaWVsZCwgYWdncmVnYXRlcywganNvbkRhdGEubGV2ZWwgKyAxLCBudWxsLCBmb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAganNvbkRhdGFbal0uY291bnQgPSBqc29uRGF0YVtqXS5pdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB0aGlzXzEgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwganNvbkRhdGEubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvb3BfMShqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAganNvbkRhdGEuY2hpbGRMZXZlbHMgKz0gMTtcbiAgICAgICAgICAgICAgICByZXR1cm4ganNvbkRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ3JvdXBlZCA9IHt9O1xuICAgICAgICAgICAgdmFyIGdyb3VwZWRBcnJheSA9IFtdO1xuICAgICAgICAgICAgZ3JvdXBlZEFycmF5Lkdyb3VwR3VpZCA9IGNvbnN0c1tndWlkXTtcbiAgICAgICAgICAgIGdyb3VwZWRBcnJheS5sZXZlbCA9IGxldmVsO1xuICAgICAgICAgICAgZ3JvdXBlZEFycmF5LmNoaWxkTGV2ZWxzID0gMDtcbiAgICAgICAgICAgIGdyb3VwZWRBcnJheS5yZWNvcmRzID0ganNvbkRhdGE7XG4gICAgICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbCA9IHRoaXNfMi5nZXRWYWwoanNvbkRhdGEsIGksIGZpZWxkKTtcbiAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZm9ybWF0KSkge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBmb3JtYXQodmFsLCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZ3JvdXBlZFt2YWxdKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwZWRbdmFsXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogdmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBncm91cGVkQXJyYXkucHVzaChncm91cGVkW3ZhbF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZ3JvdXBEcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wT2JqID0gZ3JvdXBEcy5maWx0ZXIoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUua2V5ID09PSBncm91cGVkW3ZhbF0ua2V5OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwZWRbdmFsXS5jb3VudCA9IHRlbXBPYmpbMF0uY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ3JvdXBlZFt2YWxdLmNvdW50ID0gIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZ3JvdXBEcykgPyBncm91cGVkW3ZhbF0uY291bnQgOiBncm91cGVkW3ZhbF0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICBncm91cGVkW3ZhbF0uaXRlbXMucHVzaChqc29uRGF0YVtpXSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHRoaXNfMiA9IHRoaXM7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25EYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgX2xvb3BfMihpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhZ2dyZWdhdGVzICYmIGFnZ3JlZ2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9sb29wXzMgPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0ge307XG4gICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFnZ3MgPSBhZ2dyZWdhdGVzO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFnZ3JlZ2F0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuID0gRGF0YVV0aWwuYWdncmVnYXRlc1thZ2dyZWdhdGVzW2pdLnR5cGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKGdyb3VwRHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBncm91cERzLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5rZXkgPT09IGdyb3VwZWRBcnJheVtpXS5rZXk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNbYWdnc1tqXS5maWVsZCArICcgLSAnICsgYWdnc1tqXS50eXBlXSA9IGZuKHRlbXBbMF0uaXRlbXMsIGFnZ3Nbal0uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNbYWdnc1tqXS5maWVsZCArICcgLSAnICsgYWdnc1tqXS50eXBlXSA9IGZuKGdyb3VwZWRBcnJheVtpXS5pdGVtcywgYWdnc1tqXS5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwZWRBcnJheVtpXS5hZ2dyZWdhdGVzID0gcmVzO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncm91cGVkQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvb3BfMyhpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZ3JvdXBlZEFycmF5O1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5idWlsZEhpZXJhcmNoeSA9IGZ1bmN0aW9uIChmS2V5LCBmcm9tLCBzb3VyY2UsIGxvb2t1cCwgcEtleSkge1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICB2YXIgZ3JwID0ge307XG4gICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgIGlmIChsb29rdXAucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbG9va3VwID0gbG9va3VwLnJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsb29rdXAuR3JvdXBHdWlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50aHJvd0Vycm9yKCdEYXRhTWFuYWdlcjogRG8gbm90IGhhdmUgc3VwcG9ydCBHcm91cGluZyBpbiBoaWVyYXJjaHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsb29rdXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZktleURhdGEgPSB0aGlzLmdldE9iamVjdChmS2V5LCBsb29rdXBbaV0pO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBncnBbZktleURhdGFdIHx8IChncnBbZktleURhdGFdID0gW10pO1xuICAgICAgICAgICAgICAgIHRlbXAucHVzaChsb29rdXBbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNvdXJjZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmS2V5RGF0YSA9IHRoaXMuZ2V0T2JqZWN0KHBLZXkgfHwgZktleSwgc291cmNlW2ldKTtcbiAgICAgICAgICAgICAgICBzb3VyY2VbaV1bZnJvbV0gPSBncnBbZktleURhdGFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5nZXRGaWVsZExpc3QgPSBmdW5jdGlvbiAob2JqLCBmaWVsZHMsIHByZWZpeCkge1xuICAgICAgICAgICAgaWYgKHByZWZpeCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcHJlZml4ID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmllbGRzID09PSB1bmRlZmluZWQgfHwgZmllbGRzID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRMaXN0KG9iaiwgW10sIHByZWZpeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29weU9iaiA9IG9iajtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwga2V5c18xID0ga2V5czsgX2kgPCBrZXlzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3AgPSBrZXlzXzFbX2ldO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29weU9ialtwcm9wXSA9PT0gJ29iamVjdCcgJiYgIShjb3B5T2JqW3Byb3BdIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RmllbGRMaXN0KGNvcHlPYmpbcHJvcF0sIGZpZWxkcywgcHJlZml4ICsgcHJvcCArICcuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHMucHVzaChwcmVmaXggKyBwcm9wKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmllbGRzO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5nZXRPYmplY3QgPSBmdW5jdGlvbiAobmFtZVNwYWNlLCBmcm9tKSB7XG4gICAgICAgICAgICBpZiAoIW5hbWVTcGFjZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmcm9tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5hbWVTcGFjZS5pbmRleE9mKCcuJykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZyb21bbmFtZVNwYWNlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZyb207XG4gICAgICAgICAgICB2YXIgc3BsaXRzID0gbmFtZVNwYWNlLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlW3NwbGl0c1tpXV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLnNvcnQgPSBmdW5jdGlvbiAoZHMsIGZpZWxkLCBjb21wYXJlcikge1xuICAgICAgICAgICAgaWYgKGRzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1pZGRsZSA9IHBhcnNlSW50KChkcy5sZW5ndGggLyAyKS50b1N0cmluZygpLCAxMCk7XG4gICAgICAgICAgICB2YXIgbGVmdCA9IGRzLnNsaWNlKDAsIG1pZGRsZSk7XG4gICAgICAgICAgICB2YXIgcmlnaHQgPSBkcy5zbGljZShtaWRkbGUpO1xuICAgICAgICAgICAgbGVmdCA9IHRoaXMuc29ydChsZWZ0LCBmaWVsZCwgY29tcGFyZXIpO1xuICAgICAgICAgICAgcmlnaHQgPSB0aGlzLnNvcnQocmlnaHQsIGZpZWxkLCBjb21wYXJlcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXJnZShsZWZ0LCByaWdodCwgZmllbGQsIGNvbXBhcmVyKTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVV0aWwubWVyZ2UgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQsIGZpZWxkTmFtZSwgY29tcGFyZXIpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50O1xuICAgICAgICAgICAgd2hpbGUgKGxlZnQubGVuZ3RoID4gMCB8fCByaWdodC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxlZnQubGVuZ3RoID4gMCAmJiByaWdodC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wYXJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGNvbXBhcmVyKHRoaXMuZ2V0VmFsKGxlZnQsIDAsIGZpZWxkTmFtZSksIHRoaXMuZ2V0VmFsKHJpZ2h0LCAwLCBmaWVsZE5hbWUpKSA8PSAwID8gbGVmdCA6IHJpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGxlZnRbMF1bZmllbGROYW1lXSA8IGxlZnRbMF1bZmllbGROYW1lXSA/IGxlZnQgOiByaWdodDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGxlZnQubGVuZ3RoID4gMCA/IGxlZnQgOiByaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goY3VycmVudC5zaGlmdCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmdldFZhbCA9IGZ1bmN0aW9uIChhcnJheSwgaW5kZXgsIGZpZWxkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmllbGQgPyB0aGlzLmdldE9iamVjdChmaWVsZCwgYXJyYXlbaW5kZXhdKSA6IGFycmF5W2luZGV4XTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVV0aWwudG9Mb3dlckNhc2UgPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsID8gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgPyB2YWwudG9Mb3dlckNhc2UoKSA6IHZhbC50b1N0cmluZygpIDogKHZhbCA9PT0gMCB8fCB2YWwgPT09IGZhbHNlKSA/IHZhbC50b1N0cmluZygpIDogJyc7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmNhbGxBZGFwdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAoYWRhcHRvciwgZm5OYW1lLCBwYXJhbTEsIHBhcmFtMikge1xuICAgICAgICAgICAgaWYgKGZuTmFtZSBpbiBhZGFwdG9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IGFkYXB0b3JbZm5OYW1lXShwYXJhbTEsIHBhcmFtMik7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmZuT3BlcmF0b3JzLmlzbnVsbChyZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtMSA9IHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGFyYW0xO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhVXRpbC5pc1BsYWluT2JqZWN0ID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuICghIW9iaikgJiYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVV0aWwuaXNDb3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHhociA9IG51bGw7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9ICdYTUxIdHRwUmVxdWVzdCc7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHhociA9IG5ldyB3aW5kb3dbcmVxdWVzdF0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gISF4aHIgJiYgKCd3aXRoQ3JlZGVudGlhbHMnIGluIHhocik7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmdldEd1aWQgPSBmdW5jdGlvbiAocHJlZml4KSB7XG4gICAgICAgICAgICB2YXIgaGV4cyA9ICcwMTIzNDU2Nzg5YWJjZGVmJztcbiAgICAgICAgICAgIHZhciByYW5kO1xuICAgICAgICAgICAgcmV0dXJuIChwcmVmaXggfHwgJycpICsgJzAwMDAwMDAwLTAwMDAtNDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcucmVwbGFjZSgvMC9nLCBmdW5jdGlvbiAodmFsLCBpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCdjcnlwdG8nIGluIHdpbmRvdyAmJiAnZ2V0UmFuZG9tVmFsdWVzJyBpbiBjcnlwdG8pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KDEpO1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhcnIpO1xuICAgICAgICAgICAgICAgICAgICByYW5kID0gYXJyWzBdICUgMTYgfCAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZCA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBoZXhzW2kgPT09IDE5ID8gcmFuZCAmIDB4MyB8IDB4OCA6IHJhbmRdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmlzTnVsbCA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWwgPT09IHVuZGVmaW5lZCB8fCB2YWwgPT09IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFVdGlsLmdldEl0ZW1Gcm9tQ29tcGFyZXIgPSBmdW5jdGlvbiAoYXJyYXksIGZpZWxkLCBjb21wYXJlcikge1xuICAgICAgICAgICAgdmFyIGtleVZhbDtcbiAgICAgICAgICAgIHZhciBjdXJyZW50O1xuICAgICAgICAgICAgdmFyIGtleTtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIHZhciBjYXN0UmVxdWlyZWQgPSB0eXBlb2YgRGF0YVV0aWwuZ2V0VmFsKGFycmF5LCAwLCBmaWVsZCkgPT09ICdzdHJpbmcnO1xuICAgICAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHdoaWxlIChlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKGtleVZhbCkgJiYgaSA8IGFycmF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBrZXlWYWwgPSBEYXRhVXRpbC5nZXRWYWwoYXJyYXksIGksIGZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAga2V5ID0gYXJyYXlbaSsrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudCA9IERhdGFVdGlsLmdldFZhbChhcnJheSwgaSwgZmllbGQpO1xuICAgICAgICAgICAgICAgIGlmIChlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKGN1cnJlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FzdFJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleVZhbCA9ICtrZXlWYWw7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSArY3VycmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBhcmVyKGtleVZhbCwgY3VycmVudCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleVZhbCA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGtleSA9IGFycmF5W2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBrZXk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBEYXRhVXRpbDtcbiAgICB9KCkpO1xuICAgIERhdGFVdGlsLnNlcnZlclRpbWV6b25lT2Zmc2V0ID0gMDtcbiAgICBEYXRhVXRpbC50aHJvd0Vycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aHJvdyBlLm1lc3NhZ2UgKyAnXFxuJyArIGUuc3RhY2s7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIERhdGFVdGlsLmFnZ3JlZ2F0ZXMgPSB7XG4gICAgICAgIHN1bTogZnVuY3Rpb24gKGRzLCBmaWVsZCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgICAgICAgICB2YXIgdmFsO1xuICAgICAgICAgICAgdmFyIGNhc3RSZXF1aXJlZCA9IHR5cGVvZiBEYXRhVXRpbC5nZXRWYWwoZHMsIDAsIGZpZWxkKSAhPT0gJ251bWJlcic7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gRGF0YVV0aWwuZ2V0VmFsKGRzLCBpLCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTih2YWwpICYmIHZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FzdFJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSArdmFsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSB2YWw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSxcbiAgICAgICAgYXZlcmFnZTogZnVuY3Rpb24gKGRzLCBmaWVsZCkge1xuICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLmFnZ3JlZ2F0ZXMuc3VtKGRzLCBmaWVsZCkgLyBkcy5sZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIG1pbjogZnVuY3Rpb24gKGRzLCBmaWVsZCkge1xuICAgICAgICAgICAgdmFyIGNvbXBhcmVyO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbXBhcmVyID0gZmllbGQ7XG4gICAgICAgICAgICAgICAgZmllbGQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLmdldE9iamVjdChmaWVsZCwgRGF0YVV0aWwuZ2V0SXRlbUZyb21Db21wYXJlcihkcywgZmllbGQsIGNvbXBhcmVyIHx8IERhdGFVdGlsLmZuQXNjZW5kaW5nKSk7XG4gICAgICAgIH0sXG4gICAgICAgIG1heDogZnVuY3Rpb24gKGRzLCBmaWVsZCkge1xuICAgICAgICAgICAgdmFyIGNvbXBhcmVyO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbXBhcmVyID0gZmllbGQ7XG4gICAgICAgICAgICAgICAgZmllbGQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLmdldE9iamVjdChmaWVsZCwgRGF0YVV0aWwuZ2V0SXRlbUZyb21Db21wYXJlcihkcywgZmllbGQsIGNvbXBhcmVyIHx8IERhdGFVdGlsLmZuRGVzY2VuZGluZykpO1xuICAgICAgICB9LFxuICAgICAgICB0cnVlY291bnQ6IGZ1bmN0aW9uIChkcywgZmllbGQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgbWFuYWdlcl8xLkRhdGFNYW5hZ2VyKGRzKS5leGVjdXRlTG9jYWwobmV3IHF1ZXJ5XzEuUXVlcnkoKS53aGVyZShmaWVsZCwgJ2VxdWFsJywgdHJ1ZSwgdHJ1ZSkpLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZmFsc2Vjb3VudDogZnVuY3Rpb24gKGRzLCBmaWVsZCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBtYW5hZ2VyXzEuRGF0YU1hbmFnZXIoZHMpLmV4ZWN1dGVMb2NhbChuZXcgcXVlcnlfMS5RdWVyeSgpLndoZXJlKGZpZWxkLCAnZXF1YWwnLCBmYWxzZSwgdHJ1ZSkpLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgY291bnQ6IGZ1bmN0aW9uIChkcywgZmllbGQpIHtcbiAgICAgICAgICAgIHJldHVybiBkcy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIERhdGFVdGlsLm9wZXJhdG9yU3ltYm9scyA9IHtcbiAgICAgICAgJzwnOiAnbGVzc3RoYW4nLFxuICAgICAgICAnPic6ICdncmVhdGVydGhhbicsXG4gICAgICAgICc8PSc6ICdsZXNzdGhhbm9yZXF1YWwnLFxuICAgICAgICAnPj0nOiAnZ3JlYXRlcnRoYW5vcmVxdWFsJyxcbiAgICAgICAgJz09JzogJ2VxdWFsJyxcbiAgICAgICAgJyE9JzogJ25vdGVxdWFsJyxcbiAgICAgICAgJyo9JzogJ2NvbnRhaW5zJyxcbiAgICAgICAgJyQ9JzogJ2VuZHN3aXRoJyxcbiAgICAgICAgJ149JzogJ3N0YXJ0c3dpdGgnXG4gICAgfTtcbiAgICBEYXRhVXRpbC5vZEJpT3BlcmF0b3IgPSB7XG4gICAgICAgICc8JzogJyBsdCAnLFxuICAgICAgICAnPic6ICcgZ3QgJyxcbiAgICAgICAgJzw9JzogJyBsZSAnLFxuICAgICAgICAnPj0nOiAnIGdlICcsXG4gICAgICAgICc9PSc6ICcgZXEgJyxcbiAgICAgICAgJyE9JzogJyBuZSAnLFxuICAgICAgICAnbGVzc3RoYW4nOiAnIGx0ICcsXG4gICAgICAgICdsZXNzdGhhbm9yZXF1YWwnOiAnIGxlICcsXG4gICAgICAgICdncmVhdGVydGhhbic6ICcgZ3QgJyxcbiAgICAgICAgJ2dyZWF0ZXJ0aGFub3JlcXVhbCc6ICcgZ2UgJyxcbiAgICAgICAgJ2VxdWFsJzogJyBlcSAnLFxuICAgICAgICAnbm90ZXF1YWwnOiAnIG5lICdcbiAgICB9O1xuICAgIERhdGFVdGlsLm9kVW5pT3BlcmF0b3IgPSB7XG4gICAgICAgICckPSc6ICdlbmRzd2l0aCcsXG4gICAgICAgICdePSc6ICdzdGFydHN3aXRoJyxcbiAgICAgICAgJyo9JzogJ3N1YnN0cmluZ29mJyxcbiAgICAgICAgJ2VuZHN3aXRoJzogJ2VuZHN3aXRoJyxcbiAgICAgICAgJ3N0YXJ0c3dpdGgnOiAnc3RhcnRzd2l0aCcsXG4gICAgICAgICdjb250YWlucyc6ICdzdWJzdHJpbmdvZidcbiAgICB9O1xuICAgIERhdGFVdGlsLm9kdjRVbmlPcGVyYXRvciA9IHtcbiAgICAgICAgJyQ9JzogJ2VuZHN3aXRoJyxcbiAgICAgICAgJ149JzogJ3N0YXJ0c3dpdGgnLFxuICAgICAgICAnKj0nOiAnY29udGFpbnMnLFxuICAgICAgICAnZW5kc3dpdGgnOiAnZW5kc3dpdGgnLFxuICAgICAgICAnc3RhcnRzd2l0aCc6ICdzdGFydHN3aXRoJyxcbiAgICAgICAgJ2NvbnRhaW5zJzogJ2NvbnRhaW5zJ1xuICAgIH07XG4gICAgRGF0YVV0aWwuZm5PcGVyYXRvcnMgPSB7XG4gICAgICAgIGVxdWFsOiBmdW5jdGlvbiAoYWN0dWFsLCBleHBlY3RlZCwgaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgaWYgKGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVV0aWwudG9Mb3dlckNhc2UoYWN0dWFsKSA9PT0gRGF0YVV0aWwudG9Mb3dlckNhc2UoZXhwZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjdHVhbCA9PT0gZXhwZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIG5vdGVxdWFsOiBmdW5jdGlvbiAoYWN0dWFsLCBleHBlY3RlZCwgaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgcmV0dXJuICFEYXRhVXRpbC5mbk9wZXJhdG9ycy5lcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBpZ25vcmVDYXNlKTtcbiAgICAgICAgfSxcbiAgICAgICAgbGVzc3RoYW46IGZ1bmN0aW9uIChhY3R1YWwsIGV4cGVjdGVkLCBpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICBpZiAoaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBEYXRhVXRpbC50b0xvd2VyQ2FzZShhY3R1YWwpIDwgRGF0YVV0aWwudG9Mb3dlckNhc2UoZXhwZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjdHVhbCA8IGV4cGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBncmVhdGVydGhhbjogZnVuY3Rpb24gKGFjdHVhbCwgZXhwZWN0ZWQsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgIGlmIChpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLnRvTG93ZXJDYXNlKGFjdHVhbCkgPiBEYXRhVXRpbC50b0xvd2VyQ2FzZShleHBlY3RlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYWN0dWFsID4gZXhwZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGxlc3N0aGFub3JlcXVhbDogZnVuY3Rpb24gKGFjdHVhbCwgZXhwZWN0ZWQsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgIGlmIChpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLnRvTG93ZXJDYXNlKGFjdHVhbCkgPD0gRGF0YVV0aWwudG9Mb3dlckNhc2UoZXhwZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjdHVhbCA8PSBleHBlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZ3JlYXRlcnRoYW5vcmVxdWFsOiBmdW5jdGlvbiAoYWN0dWFsLCBleHBlY3RlZCwgaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgaWYgKGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVV0aWwudG9Mb3dlckNhc2UoYWN0dWFsKSA+PSBEYXRhVXRpbC50b0xvd2VyQ2FzZShleHBlY3RlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYWN0dWFsID49IGV4cGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBjb250YWluczogZnVuY3Rpb24gKGFjdHVhbCwgZXhwZWN0ZWQsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgIGlmIChpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKGFjdHVhbCkgJiYgIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZXhwZWN0ZWQpICYmXG4gICAgICAgICAgICAgICAgICAgIERhdGFVdGlsLnRvTG93ZXJDYXNlKGFjdHVhbCkuaW5kZXhPZihEYXRhVXRpbC50b0xvd2VyQ2FzZShleHBlY3RlZCkpICE9PSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZChhY3R1YWwpICYmICFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKGV4cGVjdGVkKSAmJlxuICAgICAgICAgICAgICAgIGFjdHVhbC50b1N0cmluZygpLmluZGV4T2YoZXhwZWN0ZWQpICE9PSAtMTtcbiAgICAgICAgfSxcbiAgICAgICAgbm90bnVsbDogZnVuY3Rpb24gKGFjdHVhbCkge1xuICAgICAgICAgICAgcmV0dXJuIGFjdHVhbCAhPT0gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgaXNudWxsOiBmdW5jdGlvbiAoYWN0dWFsKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0dWFsID09PSBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBzdGFydHN3aXRoOiBmdW5jdGlvbiAoYWN0dWFsLCBleHBlY3RlZCwgaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgaWYgKGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0dWFsICYmIGV4cGVjdGVkICYmIERhdGFVdGlsLnN0YXJ0c1dpdGgoYWN0dWFsLnRvTG93ZXJDYXNlKCksIGV4cGVjdGVkLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjdHVhbCAmJiBleHBlY3RlZCAmJiBEYXRhVXRpbC5zdGFydHNXaXRoKGFjdHVhbCwgZXhwZWN0ZWQpO1xuICAgICAgICB9LFxuICAgICAgICBlbmRzd2l0aDogZnVuY3Rpb24gKGFjdHVhbCwgZXhwZWN0ZWQsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgIGlmIChpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjdHVhbCAmJiBleHBlY3RlZCAmJiBEYXRhVXRpbC5lbmRzV2l0aChhY3R1YWwudG9Mb3dlckNhc2UoKSwgZXhwZWN0ZWQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYWN0dWFsICYmIGV4cGVjdGVkICYmIERhdGFVdGlsLmVuZHNXaXRoKGFjdHVhbCwgZXhwZWN0ZWQpO1xuICAgICAgICB9LFxuICAgICAgICBwcm9jZXNzU3ltYm9sczogZnVuY3Rpb24gKG9wZXJhdG9yKSB7XG4gICAgICAgICAgICB2YXIgZm5OYW1lID0gRGF0YVV0aWwub3BlcmF0b3JTeW1ib2xzW29wZXJhdG9yXTtcbiAgICAgICAgICAgIGlmIChmbk5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm4gPSBEYXRhVXRpbC5mbk9wZXJhdG9yc1tmbk5hbWVdO1xuICAgICAgICAgICAgICAgIHJldHVybiBmbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBEYXRhVXRpbC50aHJvd0Vycm9yKCdRdWVyeSAtIFByb2Nlc3MgT3BlcmF0b3IgOiBJbnZhbGlkIG9wZXJhdG9yJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHByb2Nlc3NPcGVyYXRvcjogZnVuY3Rpb24gKG9wZXJhdG9yKSB7XG4gICAgICAgICAgICB2YXIgZm4gPSBEYXRhVXRpbC5mbk9wZXJhdG9yc1tvcGVyYXRvcl07XG4gICAgICAgICAgICBpZiAoZm4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRGF0YVV0aWwuZm5PcGVyYXRvcnMucHJvY2Vzc1N5bWJvbHMob3BlcmF0b3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBEYXRhVXRpbC5wYXJzZSA9IHtcbiAgICAgICAgcGFyc2VKc29uOiBmdW5jdGlvbiAoanNvblRleHQpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YganNvblRleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAganNvblRleHQgPSBKU09OLnBhcnNlKGpzb25UZXh0LCBEYXRhVXRpbC5wYXJzZS5qc29uUmV2aXZlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChqc29uVGV4dCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgRGF0YVV0aWwucGFyc2UuaXRlcmF0ZUFuZFJldml2ZUFycmF5KGpzb25UZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBqc29uVGV4dCA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBEYXRhVXRpbC5wYXJzZS5pdGVyYXRlQW5kUmV2aXZlSnNvbihqc29uVGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ganNvblRleHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGl0ZXJhdGVBbmRSZXZpdmVBcnJheTogZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcnJheVtpXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgRGF0YVV0aWwucGFyc2UuaXRlcmF0ZUFuZFJldml2ZUpzb24oYXJyYXlbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJyYXlbaV0gPT09ICdzdHJpbmcnICYmICEvXltcXHNdKlxcW3xeW1xcc10qXFx7fFxcXCIvZy50ZXN0KGFycmF5W2ldKSkge1xuICAgICAgICAgICAgICAgICAgICBhcnJheVtpXSA9IERhdGFVdGlsLnBhcnNlLmpzb25SZXZpdmVyKCcnLCBhcnJheVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhcnJheVtpXSA9IERhdGFVdGlsLnBhcnNlLnBhcnNlSnNvbihhcnJheVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpdGVyYXRlQW5kUmV2aXZlSnNvbjogZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoanNvbik7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMiA9IGtleXM7IF9pIDwga2V5c18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wID0ga2V5c18yW19pXTtcbiAgICAgICAgICAgICAgICBpZiAoRGF0YVV0aWwuc3RhcnRzV2l0aChwcm9wLCAnX18nKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBqc29uW3Byb3BdO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBEYXRhVXRpbC5wYXJzZS5pdGVyYXRlQW5kUmV2aXZlQXJyYXkodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBEYXRhVXRpbC5wYXJzZS5pdGVyYXRlQW5kUmV2aXZlSnNvbih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb25bcHJvcF0gPSBEYXRhVXRpbC5wYXJzZS5qc29uUmV2aXZlcihqc29uW3Byb3BdLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBqc29uUmV2aXZlcjogZnVuY3Rpb24gKGZpZWxkLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIGR1cFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHZhciBtcyA9IC9eXFwvRGF0ZVxcKChbKy1dP1swLTldKykoWystXVswLTldezR9KT9cXClcXC8kLy5leGVjKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAobXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLnBhcnNlLmpzb25SZXBsYWNlcih7IHZhbHVlOiBuZXcgRGF0ZShwYXJzZUludChtc1sxXSwgMTApKSB9LCBmYWxzZSkudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKC9eKFxcZHs0fVxcLVxcZFxcZFxcLVxcZFxcZChbdFRdW1xcZDpcXC5dKil7MX0pKFt6Wl18KFsrXFwtXSkoXFxkXFxkKTo/KFxcZFxcZCkpPyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcnIgPSBkdXBWYWx1ZS5zcGxpdCgvW14wLTldLyk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gRGF0YVV0aWwucGFyc2UuanNvblJlcGxhY2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgRGF0ZShwYXJzZUludChhcnJbMF0sIDEwKSwgcGFyc2VJbnQoYXJyWzFdLCAxMCkgLSAxLCBwYXJzZUludChhcnJbMl0sIDEwKSwgcGFyc2VJbnQoYXJyWzNdLCAxMCksIHBhcnNlSW50KGFycls0XSwgMTApLCBwYXJzZUludChhcnJbNV0sIDEwKSlcbiAgICAgICAgICAgICAgICAgICAgfSwgZmFsc2UpLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgaXNKc29uOiBmdW5jdGlvbiAoanNvbkRhdGEpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YganNvbkRhdGFbMF0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGpzb25EYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLnBhcnNlLnBhcnNlSnNvbihqc29uRGF0YSk7XG4gICAgICAgIH0sXG4gICAgICAgIGlzR3VpZDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcmVnZXggPSAvW0EtRmEtZjAtOV17OH0oPzotW0EtRmEtZjAtOV17NH0pezN9LVtBLUZhLWYwLTldezEyfS9pO1xuICAgICAgICAgICAgdmFyIG1hdGNoID0gcmVnZXguZXhlYyh2YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2ggIT0gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgcmVwbGFjZXI6IGZ1bmN0aW9uICh2YWx1ZSwgc3RyaW5naWZ5KSB7XG4gICAgICAgICAgICBpZiAoRGF0YVV0aWwuaXNQbGFpbk9iamVjdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVV0aWwucGFyc2UuanNvblJlcGxhY2VyKHZhbHVlLCBzdHJpbmdpZnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVV0aWwucGFyc2UuYXJyYXlSZXBsYWNlcih2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIERhdGFVdGlsLnBhcnNlLmpzb25SZXBsYWNlcih7IHZhbDogdmFsdWUgfSwgc3RyaW5naWZ5KS52YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGpzb25SZXBsYWNlcjogZnVuY3Rpb24gKHZhbCwgc3RyaW5naWZ5KSB7XG4gICAgICAgICAgICBpZiAoc3RyaW5naWZ5ID09PSB2b2lkIDApIHsgc3RyaW5naWZ5ID0gdHJ1ZTsgfVxuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWwpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzMgPSBrZXlzOyBfaSA8IGtleXNfMy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGtleXNfM1tfaV07XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWxbcHJvcF07XG4gICAgICAgICAgICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgdW5peHN0YW1wID0gK2QgLSAoZC5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApO1xuICAgICAgICAgICAgICAgIHZhbFtwcm9wXSA9IG5ldyBEYXRlKHVuaXhzdGFtcCAtIChEYXRhVXRpbC5zZXJ2ZXJUaW1lem9uZU9mZnNldCAqIDM2MDAwMDApKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RyaW5naWZ5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbFtwcm9wXSA9IHZhbFtwcm9wXS50b0pTT04oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9LFxuICAgICAgICBhcnJheVJlcGxhY2VyOiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChEYXRhVXRpbC5pc1BsYWluT2JqZWN0KHZhbFtpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsW2ldID0gRGF0YVV0aWwucGFyc2UuanNvblJlcGxhY2VyKHZhbFtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbFtpXSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsW2ldID0gRGF0YVV0aWwucGFyc2UuanNvblJlcGxhY2VyKHsgZGF0ZTogdmFsW2ldIH0pLmRhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgZXhwb3J0cy5EYXRhVXRpbCA9IERhdGFVdGlsO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy91dGlsLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIi4vdXRpbFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIHV0aWxfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICB2YXIgUXVlcnkgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBRdWVyeShmcm9tKSB7XG4gICAgICAgICAgICB0aGlzLnN1YlF1ZXJ5ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuaXNDaGlsZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5xdWVyaWVzID0gW107XG4gICAgICAgICAgICB0aGlzLmtleSA9ICcnO1xuICAgICAgICAgICAgdGhpcy5mS2V5ID0gJyc7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGZyb20gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mcm9tVGFibGUgPSBmcm9tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZnJvbSAmJiBmcm9tIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvb2t1cHMgPSBmcm9tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5leHBhbmRzID0gW107XG4gICAgICAgICAgICB0aGlzLnNvcnRlZENvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBlZENvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc3ViUXVlcnkgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pc0NoaWxkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnBhcmFtcyA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgUXVlcnkucHJvdG90eXBlLnNldEtleSA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgICAgdGhpcy5rZXkgPSBmaWVsZDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUudXNpbmcgPSBmdW5jdGlvbiAoZGF0YU1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YU1hbmFnZXIgPSBkYXRhTWFuYWdlcjtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUuZXhlY3V0ZSA9IGZ1bmN0aW9uIChkYXRhTWFuYWdlciwgZG9uZSwgZmFpbCwgYWx3YXlzKSB7XG4gICAgICAgICAgICBkYXRhTWFuYWdlciA9IGRhdGFNYW5hZ2VyIHx8IHRoaXMuZGF0YU1hbmFnZXI7XG4gICAgICAgICAgICBpZiAoZGF0YU1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YU1hbmFnZXIuZXhlY3V0ZVF1ZXJ5KHRoaXMsIGRvbmUsIGZhaWwsIGFsd2F5cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdXRpbF8xLkRhdGFVdGlsLnRocm93RXJyb3IoJ1F1ZXJ5IC0gZXhlY3V0ZSgpIDogZGF0YU1hbmFnZXIgbmVlZHMgdG8gYmUgaXMgc2V0IHVzaW5nIFwidXNpbmdcIiBmdW5jdGlvbiBvciBzaG91bGQgYmUgcGFzc2VkIGFzIGFyZ3VtZW50Jyk7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5leGVjdXRlTG9jYWwgPSBmdW5jdGlvbiAoZGF0YU1hbmFnZXIpIHtcbiAgICAgICAgICAgIGRhdGFNYW5hZ2VyID0gZGF0YU1hbmFnZXIgfHwgdGhpcy5kYXRhTWFuYWdlcjtcbiAgICAgICAgICAgIGlmIChkYXRhTWFuYWdlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhTWFuYWdlci5leGVjdXRlTG9jYWwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdXRpbF8xLkRhdGFVdGlsLnRocm93RXJyb3IoJ1F1ZXJ5IC0gZXhlY3V0ZUxvY2FsKCkgOiBkYXRhTWFuYWdlciBuZWVkcyB0byBiZSBpcyBzZXQgdXNpbmcgXCJ1c2luZ1wiIGZ1bmN0aW9uIG9yIHNob3VsZCBiZSBwYXNzZWQgYXMgYXJndW1lbnQnKTtcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNsb25lZCA9IG5ldyBRdWVyeSgpO1xuICAgICAgICAgICAgY2xvbmVkLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuc2xpY2UoMCk7XG4gICAgICAgICAgICBjbG9uZWQua2V5ID0gdGhpcy5rZXk7XG4gICAgICAgICAgICBjbG9uZWQuaXNDaGlsZCA9IHRoaXMuaXNDaGlsZDtcbiAgICAgICAgICAgIGNsb25lZC5kYXRhTWFuYWdlciA9IHRoaXMuZGF0YU1hbmFnZXI7XG4gICAgICAgICAgICBjbG9uZWQuZnJvbVRhYmxlID0gdGhpcy5mcm9tVGFibGU7XG4gICAgICAgICAgICBjbG9uZWQucGFyYW1zID0gdGhpcy5wYXJhbXMuc2xpY2UoMCk7XG4gICAgICAgICAgICBjbG9uZWQuZXhwYW5kcyA9IHRoaXMuZXhwYW5kcy5zbGljZSgwKTtcbiAgICAgICAgICAgIGNsb25lZC5zb3J0ZWRDb2x1bW5zID0gdGhpcy5zb3J0ZWRDb2x1bW5zLnNsaWNlKDApO1xuICAgICAgICAgICAgY2xvbmVkLmdyb3VwZWRDb2x1bW5zID0gdGhpcy5ncm91cGVkQ29sdW1ucy5zbGljZSgwKTtcbiAgICAgICAgICAgIGNsb25lZC5zdWJRdWVyeVNlbGVjdG9yID0gdGhpcy5zdWJRdWVyeVNlbGVjdG9yO1xuICAgICAgICAgICAgY2xvbmVkLnN1YlF1ZXJ5ID0gdGhpcy5zdWJRdWVyeTtcbiAgICAgICAgICAgIGNsb25lZC5mS2V5ID0gdGhpcy5mS2V5O1xuICAgICAgICAgICAgY2xvbmVkLnJlcXVpcmVzQ291bnRzID0gdGhpcy5yZXF1aXJlc0NvdW50cztcbiAgICAgICAgICAgIHJldHVybiBjbG9uZWQ7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5mcm9tID0gZnVuY3Rpb24gKHRhYmxlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tVGFibGUgPSB0YWJsZU5hbWU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLmFkZFBhcmFtcyA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJhbXMucHVzaCh7IGtleToga2V5LCBmbjogdmFsdWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmFtcy5wdXNoKHsga2V5OiBrZXksIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUuZXhwYW5kID0gZnVuY3Rpb24gKHRhYmxlcykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0YWJsZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHBhbmRzID0gW10uc2xpY2UuY2FsbChbdGFibGVzXSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZHMgPSB0YWJsZXMuc2xpY2UoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLndoZXJlID0gZnVuY3Rpb24gKGZpZWxkTmFtZSwgb3BlcmF0b3IsIHZhbHVlLCBpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9yID8gKG9wZXJhdG9yKS50b0xvd2VyQ2FzZSgpIDogbnVsbDtcbiAgICAgICAgICAgIHZhciBwcmVkaWNhdGUgPSBudWxsO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZE5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcHJlZGljYXRlID0gbmV3IFByZWRpY2F0ZShmaWVsZE5hbWUsIG9wZXJhdG9yLCB2YWx1ZSwgaWdub3JlQ2FzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChmaWVsZE5hbWUgaW5zdGFuY2VvZiBQcmVkaWNhdGUpIHtcbiAgICAgICAgICAgICAgICBwcmVkaWNhdGUgPSBmaWVsZE5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgZm46ICdvbldoZXJlJyxcbiAgICAgICAgICAgICAgICBlOiBwcmVkaWNhdGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiAoc2VhcmNoS2V5LCBmaWVsZE5hbWVzLCBvcGVyYXRvciwgaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZE5hbWVzID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGZpZWxkTmFtZXMgPSBbZmllbGROYW1lc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9yIHx8ICdjb250YWlucyc7XG4gICAgICAgICAgICB2YXIgY29tcGFyZXIgPSB1dGlsXzEuRGF0YVV0aWwuZm5PcGVyYXRvcnNbb3BlcmF0b3JdO1xuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZuOiAnb25TZWFyY2gnLFxuICAgICAgICAgICAgICAgIGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGROYW1lczogZmllbGROYW1lcyxcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9yLFxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hLZXk6IHNlYXJjaEtleSxcbiAgICAgICAgICAgICAgICAgICAgaWdub3JlQ2FzZTogaWdub3JlQ2FzZSxcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyZXI6IGNvbXBhcmVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLnNvcnRCeSA9IGZ1bmN0aW9uIChmaWVsZE5hbWUsIGNvbXBhcmVyLCBpc0Zyb21Hcm91cCkge1xuICAgICAgICAgICAgdmFyIG9yZGVyID0gJ2FzY2VuZGluZyc7XG4gICAgICAgICAgICB2YXIgc29ydHM7XG4gICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGROYW1lID09PSAnc3RyaW5nJyAmJiB1dGlsXzEuRGF0YVV0aWwuZW5kc1dpdGgoZmllbGROYW1lLnRvTG93ZXJDYXNlKCksICcgZGVzYycpKSB7XG4gICAgICAgICAgICAgICAgZmllbGROYW1lID0gZmllbGROYW1lLnJlcGxhY2UoLyBkZXNjJC9pLCAnJyk7XG4gICAgICAgICAgICAgICAgY29tcGFyZXIgPSAnZGVzY2VuZGluZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNvbXBhcmVyIHx8IHR5cGVvZiBjb21wYXJlciA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBvcmRlciA9IGNvbXBhcmVyID8gY29tcGFyZXIudG9Mb3dlckNhc2UoKSA6ICdhc2NlbmRpbmcnO1xuICAgICAgICAgICAgICAgIGNvbXBhcmVyID0gdXRpbF8xLkRhdGFVdGlsLmZuU29ydChjb21wYXJlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNGcm9tR3JvdXApIHtcbiAgICAgICAgICAgICAgICBzb3J0cyA9IFF1ZXJ5LmZpbHRlclF1ZXJpZXModGhpcy5xdWVyaWVzLCAnb25Tb3J0QnknKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSBzb3J0c1tpXS5lLmZpZWxkTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXAgPT09IGZpZWxkTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRlbXAgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0ZW1wLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBbal0gPT09IGZpZWxkTmFtZSB8fCBmaWVsZE5hbWUudG9Mb3dlckNhc2UoKSA9PT0gdGVtcFtqXSArICcgZGVzYycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZuOiAnb25Tb3J0QnknLFxuICAgICAgICAgICAgICAgIGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGROYW1lOiBmaWVsZE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmVyOiBjb21wYXJlcixcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBvcmRlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5zb3J0QnlEZXNjID0gZnVuY3Rpb24gKGZpZWxkTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydEJ5KGZpZWxkTmFtZSwgJ2Rlc2NlbmRpbmcnKTtcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLmdyb3VwID0gZnVuY3Rpb24gKGZpZWxkTmFtZSwgZm4sIGZvcm1hdCkge1xuICAgICAgICAgICAgdGhpcy5zb3J0QnkoZmllbGROYW1lLCBudWxsLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMucXVlcmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBmbjogJ29uR3JvdXAnLFxuICAgICAgICAgICAgICAgIGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGROYW1lOiBmaWVsZE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmVyOiBmbiA/IGZuIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQgPyBmb3JtYXQgOiBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLnBhZ2UgPSBmdW5jdGlvbiAocGFnZUluZGV4LCBwYWdlU2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZuOiAnb25QYWdlJyxcbiAgICAgICAgICAgICAgICBlOiB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VJbmRleDogcGFnZUluZGV4LFxuICAgICAgICAgICAgICAgICAgICBwYWdlU2l6ZTogcGFnZVNpemVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUucmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZuOiAnb25SYW5nZScsXG4gICAgICAgICAgICAgICAgZToge1xuICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIGVuZDogZW5kXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLnRha2UgPSBmdW5jdGlvbiAobm9zKSB7XG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgZm46ICdvblRha2UnLFxuICAgICAgICAgICAgICAgIGU6IHtcbiAgICAgICAgICAgICAgICAgICAgbm9zOiBub3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUuc2tpcCA9IGZ1bmN0aW9uIChub3MpIHtcbiAgICAgICAgICAgIHRoaXMucXVlcmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBmbjogJ29uU2tpcCcsXG4gICAgICAgICAgICAgICAgZTogeyBub3M6IG5vcyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUuc2VsZWN0ID0gZnVuY3Rpb24gKGZpZWxkTmFtZXMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGROYW1lcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBmaWVsZE5hbWVzID0gW10uc2xpY2UuY2FsbChbZmllbGROYW1lc10sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZuOiAnb25TZWxlY3QnLFxuICAgICAgICAgICAgICAgIGU6IHsgZmllbGROYW1lczogZmllbGROYW1lcyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5wcm90b3R5cGUuaGllcmFyY2h5ID0gZnVuY3Rpb24gKHF1ZXJ5LCBzZWxlY3RvckZuKSB7XG4gICAgICAgICAgICB0aGlzLnN1YlF1ZXJ5U2VsZWN0b3IgPSBzZWxlY3RvckZuO1xuICAgICAgICAgICAgdGhpcy5zdWJRdWVyeSA9IHF1ZXJ5O1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5mb3JlaWduS2V5ID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgdGhpcy5mS2V5ID0ga2V5O1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5yZXF1aXJlc0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZXF1aXJlc0NvdW50cyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLmFnZ3JlZ2F0ZSA9IGZ1bmN0aW9uICh0eXBlLCBmaWVsZCkge1xuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZuOiAnb25BZ2dyZWdhdGVzJyxcbiAgICAgICAgICAgICAgICBlOiB7IGZpZWxkOiBmaWVsZCwgdHlwZTogdHlwZSB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBRdWVyeS5maWx0ZXJRdWVyaWVzID0gZnVuY3Rpb24gKHF1ZXJpZXMsIG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBxdWVyaWVzLmZpbHRlcihmdW5jdGlvbiAocSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBxLmZuID09PSBuYW1lO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFF1ZXJ5LmZpbHRlclF1ZXJ5TGlzdHMgPSBmdW5jdGlvbiAocXVlcmllcywgc2luZ2xlcykge1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gcXVlcmllcy5maWx0ZXIoZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2luZ2xlcy5pbmRleE9mKHEuZm4pICE9PSAtMTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHJlcyA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWx0ZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICghcmVzW2ZpbHRlcmVkW2ldLmZuXSkge1xuICAgICAgICAgICAgICAgICAgICByZXNbZmlsdGVyZWRbaV0uZm5dID0gZmlsdGVyZWRbaV0uZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUXVlcnk7XG4gICAgfSgpKTtcbiAgICBleHBvcnRzLlF1ZXJ5ID0gUXVlcnk7XG4gICAgdmFyIFByZWRpY2F0ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFByZWRpY2F0ZShmaWVsZCwgb3BlcmF0b3IsIHZhbHVlLCBpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICBpZiAoaWdub3JlQ2FzZSA9PT0gdm9pZCAwKSB7IGlnbm9yZUNhc2UgPSBmYWxzZTsgfVxuICAgICAgICAgICAgdGhpcy5pc0NvbXBsZXggPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgICAgICAgICAgICAgIHRoaXMub3BlcmF0b3IgPSBvcGVyYXRvci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmlnbm9yZUNhc2UgPSBpZ25vcmVDYXNlO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNDb21wbGV4ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wYXJlciA9IHV0aWxfMS5EYXRhVXRpbC5mbk9wZXJhdG9ycy5wcm9jZXNzT3BlcmF0b3IodGhpcy5vcGVyYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChmaWVsZCBpbnN0YW5jZW9mIFByZWRpY2F0ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIFByZWRpY2F0ZSB8fCB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0NvbXBsZXggPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uID0gb3BlcmF0b3IudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZWRpY2F0ZXMgPSBbZmllbGRdO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIFtdLnB1c2guYXBwbHkodGhpcy5wcmVkaWNhdGVzLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWRpY2F0ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgUHJlZGljYXRlLmFuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcmVkaWNhdGUuY29tYmluZVByZWRpY2F0ZXMoW10uc2xpY2UuY2FsbChhcmdzLCAwKSwgJ2FuZCcpO1xuICAgICAgICB9O1xuICAgICAgICBQcmVkaWNhdGUucHJvdG90eXBlLmFuZCA9IGZ1bmN0aW9uIChmaWVsZCwgb3BlcmF0b3IsIHZhbHVlLCBpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJlZGljYXRlLmNvbWJpbmUodGhpcywgZmllbGQsIG9wZXJhdG9yLCB2YWx1ZSwgJ2FuZCcsIGlnbm9yZUNhc2UpO1xuICAgICAgICB9O1xuICAgICAgICBQcmVkaWNhdGUub3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHJlZGljYXRlLmNvbWJpbmVQcmVkaWNhdGVzKFtdLnNsaWNlLmNhbGwoYXJncywgMCksICdvcicpO1xuICAgICAgICB9O1xuICAgICAgICBQcmVkaWNhdGUucHJvdG90eXBlLm9yID0gZnVuY3Rpb24gKGZpZWxkLCBvcGVyYXRvciwgdmFsdWUsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBQcmVkaWNhdGUuY29tYmluZSh0aGlzLCBmaWVsZCwgb3BlcmF0b3IsIHZhbHVlLCAnb3InLCBpZ25vcmVDYXNlKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJlZGljYXRlLmZyb21Kc29uID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgICAgIGlmIChqc29uIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGpzb24ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2godGhpcy5mcm9tSlNPTkRhdGEoanNvbltpXSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWQgPSBqc29uO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJvbUpTT05EYXRhKHByZWQpO1xuICAgICAgICB9O1xuICAgICAgICBQcmVkaWNhdGUucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZSA9IHRoaXMucHJlZGljYXRlcyA/IHRoaXMucHJlZGljYXRlcyA6IFtdO1xuICAgICAgICAgICAgdmFyIGlzQW5kO1xuICAgICAgICAgICAgdmFyIHJldDtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0NvbXBsZXggJiYgdGhpcy5jb21wYXJlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmVyLmNhbGwodGhpcywgdXRpbF8xLkRhdGFVdGlsLmdldE9iamVjdCh0aGlzLmZpZWxkLCByZWNvcmQpLCB0aGlzLnZhbHVlLCB0aGlzLmlnbm9yZUNhc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNBbmQgPSB0aGlzLmNvbmRpdGlvbiA9PT0gJ2FuZCc7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByZWRpY2F0ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHJldCA9IHByZWRpY2F0ZVtpXS52YWxpZGF0ZShyZWNvcmQpO1xuICAgICAgICAgICAgICAgIGlmIChpc0FuZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpc0FuZDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJlZGljYXRlLnByb3RvdHlwZS50b0pzb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcHJlZGljYXRlcztcbiAgICAgICAgICAgIHZhciBwO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNDb21wbGV4KSB7XG4gICAgICAgICAgICAgICAgcHJlZGljYXRlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHAgPSB0aGlzLnByZWRpY2F0ZXM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZXMucHVzaChwW2ldLnRvSnNvbigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzQ29tcGxleDogdGhpcy5pc0NvbXBsZXgsXG4gICAgICAgICAgICAgICAgZmllbGQ6IHRoaXMuZmllbGQsXG4gICAgICAgICAgICAgICAgb3BlcmF0b3I6IHRoaXMub3BlcmF0b3IsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWUsXG4gICAgICAgICAgICAgICAgaWdub3JlQ2FzZTogdGhpcy5pZ25vcmVDYXNlLFxuICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogdGhpcy5jb25kaXRpb24sXG4gICAgICAgICAgICAgICAgcHJlZGljYXRlczogcHJlZGljYXRlc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJlZGljYXRlLmNvbWJpbmVQcmVkaWNhdGVzID0gZnVuY3Rpb24gKHByZWRpY2F0ZXMsIG9wZXJhdG9yKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShwcmVkaWNhdGVzWzBdIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVkaWNhdGVzWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmVkaWNhdGVzID0gcHJlZGljYXRlc1swXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJlZGljYXRlKHByZWRpY2F0ZXNbMF0sIG9wZXJhdG9yLCBwcmVkaWNhdGVzLnNsaWNlKDEpKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJlZGljYXRlLmNvbWJpbmUgPSBmdW5jdGlvbiAocHJlZCwgZmllbGQsIG9wZXJhdG9yLCB2YWx1ZSwgY29uZGl0aW9uLCBpZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICBpZiAoZmllbGQgaW5zdGFuY2VvZiBQcmVkaWNhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJlZGljYXRlW2NvbmRpdGlvbl0ocHJlZCwgZmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJlZGljYXRlW2NvbmRpdGlvbl0ocHJlZCwgbmV3IFByZWRpY2F0ZShmaWVsZCwgb3BlcmF0b3IsIHZhbHVlLCBpZ25vcmVDYXNlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdXRpbF8xLkRhdGFVdGlsLnRocm93RXJyb3IoJ1ByZWRpY2F0ZSAtICcgKyBjb25kaXRpb24gKyAnIDogaW52YWxpZCBhcmd1bWVudHMnKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJlZGljYXRlLmZyb21KU09ORGF0YSA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgICAgICAgICB2YXIgcHJlZHMgPSBqc29uLnByZWRpY2F0ZXMgfHwgW107XG4gICAgICAgICAgICB2YXIgbGVuID0gcHJlZHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcHJlZGljYXRlcy5wdXNoKHRoaXMuZnJvbUpTT05EYXRhKHByZWRzW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWpzb24uaXNDb21wbGV4KSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFByZWRpY2F0ZShqc29uLmZpZWxkLCBqc29uLm9wZXJhdG9yLCBqc29uLnZhbHVlLCBqc29uLmlnbm9yZUNhc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFByZWRpY2F0ZShwcmVkaWNhdGVzWzBdLCBqc29uLmNvbmRpdGlvbiwgcHJlZGljYXRlcy5zbGljZSgxKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUHJlZGljYXRlO1xuICAgIH0oKSk7XG4gICAgZXhwb3J0cy5QcmVkaWNhdGUgPSBQcmVkaWNhdGU7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3F1ZXJ5LmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCIuL3V0aWxcIiwgXCIuL3F1ZXJ5XCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgZWoyX2Jhc2VfMSwgdXRpbF8xLCBxdWVyeV8xKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIHZhciBBZGFwdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQWRhcHRvcihkcykge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIGZyb206ICd0YWJsZScsXG4gICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICBzb3J0Qnk6ICdzb3J0ZWQnLFxuICAgICAgICAgICAgICAgIHNlbGVjdDogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgc2tpcDogJ3NraXAnLFxuICAgICAgICAgICAgICAgIGdyb3VwOiAnZ3JvdXAnLFxuICAgICAgICAgICAgICAgIHRha2U6ICd0YWtlJyxcbiAgICAgICAgICAgICAgICBzZWFyY2g6ICdzZWFyY2gnLFxuICAgICAgICAgICAgICAgIGNvdW50OiAncmVxdWlyZXNDb3VudHMnLFxuICAgICAgICAgICAgICAgIHdoZXJlOiAnd2hlcmUnLFxuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZXM6ICdhZ2dyZWdhdGVzJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IEFkYXB0b3I7XG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2UgPSBkcztcbiAgICAgICAgICAgIHRoaXMucHZ0ID0ge307XG4gICAgICAgIH1cbiAgICAgICAgQWRhcHRvci5wcm90b3R5cGUucHJvY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24gKGRhdGEsIGRzLCBxdWVyeSwgeGhyKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEFkYXB0b3I7XG4gICAgfSgpKTtcbiAgICBleHBvcnRzLkFkYXB0b3IgPSBBZGFwdG9yO1xuICAgIHZhciBKc29uQWRhcHRvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhKc29uQWRhcHRvciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gSnNvbkFkYXB0b3IoKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgSnNvbkFkYXB0b3IucHJvdG90eXBlLnByb2Nlc3NRdWVyeSA9IGZ1bmN0aW9uIChkYXRhTWFuYWdlciwgcXVlcnkpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBkYXRhTWFuYWdlci5kYXRhU291cmNlLmpzb24uc2xpY2UoMCk7XG4gICAgICAgICAgICB2YXIgY291bnQgPSByZXN1bHQubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGNvdW50RmxnID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciByZXQ7XG4gICAgICAgICAgICB2YXIga2V5O1xuICAgICAgICAgICAgdmFyIGFnZyA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyeS5xdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAga2V5ID0gcXVlcnkucXVlcmllc1tpXTtcbiAgICAgICAgICAgICAgICByZXQgPSB0aGlzW2tleS5mbl0uY2FsbCh0aGlzLCByZXN1bHQsIGtleS5lLCBxdWVyeSk7XG4gICAgICAgICAgICAgICAgaWYgKGtleS5mbiA9PT0gJ29uQWdncmVnYXRlcycpIHtcbiAgICAgICAgICAgICAgICAgICAgYWdnW2tleS5lLmZpZWxkICsgJyAtICcgKyBrZXkuZS50eXBlXSA9IHJldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJldCAhPT0gdW5kZWZpbmVkID8gcmV0IDogcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoa2V5LmZuID09PSAnb25QYWdlJyB8fCBrZXkuZm4gPT09ICdvblNraXAnIHx8IGtleS5mbiA9PT0gJ29uVGFrZScgfHwga2V5LmZuID09PSAnb25SYW5nZScpIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnRGbGcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50RmxnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocXVlcnkucmVxdWlyZXNDb3VudHMpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogY291bnQsXG4gICAgICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZXM6IGFnZ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICBKc29uQWRhcHRvci5wcm90b3R5cGUuYmF0Y2hSZXF1ZXN0ID0gZnVuY3Rpb24gKGRtLCBjaGFuZ2VzLCBlKSB7XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjaGFuZ2VzLmFkZGVkUmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0KGRtLCBjaGFuZ2VzLmFkZGVkUmVjb3Jkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2hhbmdlcy5jaGFuZ2VkUmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKGRtLCBlLmtleSwgY2hhbmdlcy5jaGFuZ2VkUmVjb3Jkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2hhbmdlcy5kZWxldGVkUmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKGRtLCBlLmtleSwgY2hhbmdlcy5kZWxldGVkUmVjb3Jkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2hhbmdlcztcbiAgICAgICAgfTtcbiAgICAgICAgSnNvbkFkYXB0b3IucHJvdG90eXBlLm9uV2hlcmUgPSBmdW5jdGlvbiAoZHMsIGUpIHtcbiAgICAgICAgICAgIGlmICghZHMgfHwgIWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkcy5maWx0ZXIoZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLnZhbGlkYXRlKG9iaik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5vbkFnZ3JlZ2F0ZXMgPSBmdW5jdGlvbiAoZHMsIGUpIHtcbiAgICAgICAgICAgIHZhciBmbiA9IHV0aWxfMS5EYXRhVXRpbC5hZ2dyZWdhdGVzW2UudHlwZV07XG4gICAgICAgICAgICBpZiAoIWRzIHx8ICFmbiB8fCBkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmbihkcywgZS5maWVsZCk7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5vblNlYXJjaCA9IGZ1bmN0aW9uIChkcywgZSkge1xuICAgICAgICAgICAgaWYgKCFkcyB8fCAhZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUuZmllbGROYW1lcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB1dGlsXzEuRGF0YVV0aWwuZ2V0RmllbGRMaXN0KGRzWzBdLCBlLmZpZWxkTmFtZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRzLmZpbHRlcihmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBlLmZpZWxkTmFtZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY29tcGFyZXIuY2FsbChvYmosIHV0aWxfMS5EYXRhVXRpbC5nZXRPYmplY3QoZS5maWVsZE5hbWVzW2pdLCBvYmopLCBlLnNlYXJjaEtleSwgZS5pZ25vcmVDYXNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5vblNvcnRCeSA9IGZ1bmN0aW9uIChkcywgZSwgcXVlcnkpIHtcbiAgICAgICAgICAgIGlmICghZHMgfHwgIWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmbkNvbXBhcmU7XG4gICAgICAgICAgICB2YXIgZmllbGQgPSB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUoZS5maWVsZE5hbWUsIHF1ZXJ5KTtcbiAgICAgICAgICAgIGlmICghZmllbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZHMuc29ydChlLmNvbXBhcmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWVsZCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgZmllbGQgPSBmaWVsZC5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZmllbGQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWVsZFtpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm5Db21wYXJlID0gZS5jb21wYXJlcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWxfMS5EYXRhVXRpbC5lbmRzV2l0aChmaWVsZFtpXSwgJyBkZXNjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuQ29tcGFyZSA9IHV0aWxfMS5EYXRhVXRpbC5mblNvcnQoJ2Rlc2NlbmRpbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkW2ldID0gZmllbGRbaV0ucmVwbGFjZSgnIGRlc2MnLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZHMgPSB1dGlsXzEuRGF0YVV0aWwuc29ydChkcywgZmllbGRbaV0sIGZuQ29tcGFyZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1dGlsXzEuRGF0YVV0aWwuc29ydChkcywgZmllbGQsIGUuY29tcGFyZXIpO1xuICAgICAgICB9O1xuICAgICAgICBKc29uQWRhcHRvci5wcm90b3R5cGUub25Hcm91cCA9IGZ1bmN0aW9uIChkcywgZSwgcXVlcnkpIHtcbiAgICAgICAgICAgIGlmICghZHMgfHwgIWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhZ2dRdWVyeSA9IHF1ZXJ5XzEuUXVlcnkuZmlsdGVyUXVlcmllcyhxdWVyeS5xdWVyaWVzLCAnb25BZ2dyZWdhdGVzJyk7XG4gICAgICAgICAgICB2YXIgYWdnID0gW107XG4gICAgICAgICAgICBpZiAoYWdnUXVlcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRtcCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFnZ1F1ZXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRtcCA9IGFnZ1F1ZXJ5W2ldLmU7XG4gICAgICAgICAgICAgICAgICAgIGFnZy5wdXNoKHsgdHlwZTogdG1wLnR5cGUsIGZpZWxkOiB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUodG1wLmZpZWxkLCBxdWVyeSkgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHV0aWxfMS5EYXRhVXRpbC5ncm91cChkcywgdXRpbF8xLkRhdGFVdGlsLmdldFZhbHVlKGUuZmllbGROYW1lLCBxdWVyeSksIGFnZywgbnVsbCwgbnVsbCwgZS5jb21wYXJlcik7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5vblBhZ2UgPSBmdW5jdGlvbiAoZHMsIGUsIHF1ZXJ5KSB7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IHV0aWxfMS5EYXRhVXRpbC5nZXRWYWx1ZShlLnBhZ2VTaXplLCBxdWVyeSk7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSAodXRpbF8xLkRhdGFVdGlsLmdldFZhbHVlKGUucGFnZUluZGV4LCBxdWVyeSkgLSAxKSAqIHNpemU7XG4gICAgICAgICAgICB2YXIgZW5kID0gc3RhcnQgKyBzaXplO1xuICAgICAgICAgICAgaWYgKCFkcyB8fCAhZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRzLnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgICAgICB9O1xuICAgICAgICBKc29uQWRhcHRvci5wcm90b3R5cGUub25SYW5nZSA9IGZ1bmN0aW9uIChkcywgZSkge1xuICAgICAgICAgICAgaWYgKCFkcyB8fCAhZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRzLnNsaWNlKHV0aWxfMS5EYXRhVXRpbC5nZXRWYWx1ZShlLnN0YXJ0KSwgdXRpbF8xLkRhdGFVdGlsLmdldFZhbHVlKGUuZW5kKSk7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5vblRha2UgPSBmdW5jdGlvbiAoZHMsIGUpIHtcbiAgICAgICAgICAgIGlmICghZHMgfHwgIWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkcy5zbGljZSgwLCB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUoZS5ub3MpKTtcbiAgICAgICAgfTtcbiAgICAgICAgSnNvbkFkYXB0b3IucHJvdG90eXBlLm9uU2tpcCA9IGZ1bmN0aW9uIChkcywgZSkge1xuICAgICAgICAgICAgaWYgKCFkcyB8fCAhZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRzLnNsaWNlKHV0aWxfMS5EYXRhVXRpbC5nZXRWYWx1ZShlLm5vcykpO1xuICAgICAgICB9O1xuICAgICAgICBKc29uQWRhcHRvci5wcm90b3R5cGUub25TZWxlY3QgPSBmdW5jdGlvbiAoZHMsIGUpIHtcbiAgICAgICAgICAgIGlmICghZHMgfHwgIWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1dGlsXzEuRGF0YVV0aWwuc2VsZWN0KGRzLCB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUoZS5maWVsZE5hbWVzKSk7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoZG0sIGRhdGEsIHRhYmxlTmFtZSwgcXVlcnksIHBvc2l0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZChwb3NpdGlvbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZG0uZGF0YVNvdXJjZS5qc29uLnB1c2goZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZG0uZGF0YVNvdXJjZS5qc29uLnNwbGljZShwb3NpdGlvbiwgMCwgZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZG0sIGtleUZpZWxkLCB2YWx1ZSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICB2YXIgZHMgPSBkbS5kYXRhU291cmNlLmpzb247XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVtrZXlGaWVsZF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZHNbaV1ba2V5RmllbGRdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaSAhPT0gZHMubGVuZ3RoID8gZHMuc3BsaWNlKGksIDEpIDogbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgSnNvbkFkYXB0b3IucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkbSwga2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgIHZhciBkcyA9IGRtLmRhdGFTb3VyY2UuanNvbjtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgdmFyIGtleSA9IHZhbHVlW2tleUZpZWxkXTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChkc1tpXVtrZXlGaWVsZF0gPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaSA8IGRzLmxlbmd0aCA/IGVqMl9iYXNlXzEubWVyZ2UoZHNbaV0sIHZhbHVlKSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBKc29uQWRhcHRvcjtcbiAgICB9KEFkYXB0b3IpKTtcbiAgICBleHBvcnRzLkpzb25BZGFwdG9yID0gSnNvbkFkYXB0b3I7XG4gICAgdmFyIFVybEFkYXB0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVXJsQWRhcHRvciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVXJsQWRhcHRvcigpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgfVxuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS5wcm9jZXNzUXVlcnkgPSBmdW5jdGlvbiAoZG0sIHF1ZXJ5LCBoaWVyYXJjaHlGaWx0ZXJzKSB7XG4gICAgICAgICAgICB2YXIgcXVlcmllcyA9IHRoaXMuZ2V0UXVlcnlSZXF1ZXN0KHF1ZXJ5KTtcbiAgICAgICAgICAgIHZhciBzaW5nbGVzID0gcXVlcnlfMS5RdWVyeS5maWx0ZXJRdWVyeUxpc3RzKHF1ZXJ5LnF1ZXJpZXMsIFsnb25TZWxlY3QnLCAnb25QYWdlJywgJ29uU2tpcCcsICdvblRha2UnLCAnb25SYW5nZSddKTtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBxdWVyeS5wYXJhbXM7XG4gICAgICAgICAgICB2YXIgdXJsID0gZG0uZGF0YVNvdXJjZS51cmw7XG4gICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgIHZhciBza2lwO1xuICAgICAgICAgICAgdmFyIHRha2UgPSBudWxsO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHsgc29ydHM6IFtdLCBncm91cHM6IFtdLCBmaWx0ZXJzOiBbXSwgc2VhcmNoZXM6IFtdLCBhZ2dyZWdhdGVzOiBbXSB9O1xuICAgICAgICAgICAgaWYgKCdvblBhZ2UnIGluIHNpbmdsZXMpIHtcbiAgICAgICAgICAgICAgICB0ZW1wID0gc2luZ2xlcy5vblBhZ2U7XG4gICAgICAgICAgICAgICAgc2tpcCA9IHV0aWxfMS5EYXRhVXRpbC5nZXRWYWx1ZSh0ZW1wLnBhZ2VJbmRleCwgcXVlcnkpO1xuICAgICAgICAgICAgICAgIHRha2UgPSB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUodGVtcC5wYWdlU2l6ZSwgcXVlcnkpO1xuICAgICAgICAgICAgICAgIHNraXAgPSAoc2tpcCAtIDEpICogdGFrZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCdvblJhbmdlJyBpbiBzaW5nbGVzKSB7XG4gICAgICAgICAgICAgICAgdGVtcCA9IHNpbmdsZXMub25SYW5nZTtcbiAgICAgICAgICAgICAgICBza2lwID0gdGVtcC5zdGFydDtcbiAgICAgICAgICAgICAgICB0YWtlID0gdGVtcC5lbmQgLSB0ZW1wLnN0YXJ0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyaWVzLnNvcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGVtcCA9IHV0aWxfMS5EYXRhVXRpbC5nZXRWYWx1ZShxdWVyaWVzLnNvcnRzW2ldLmUuZmllbGROYW1lLCBxdWVyeSk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5zb3J0cy5wdXNoKHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvbkVhY2hTb3J0JywgeyBuYW1lOiB0ZW1wLCBkaXJlY3Rpb246IHF1ZXJpZXMuc29ydHNbaV0uZS5kaXJlY3Rpb24gfSwgcXVlcnkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoaWVyYXJjaHlGaWx0ZXJzKSB7XG4gICAgICAgICAgICAgICAgdGVtcCA9IHRoaXMuZ2V0RmlsdGVyc0Zyb20oaGllcmFyY2h5RmlsdGVycywgcXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICh0ZW1wKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3QuZmlsdGVycy5wdXNoKHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvbkVhY2hXaGVyZScsIHRlbXAudG9Kc29uKCksIHF1ZXJ5KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyaWVzLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0LmZpbHRlcnMucHVzaCh1dGlsXzEuRGF0YVV0aWwuY2FsbEFkYXB0b3JGdW5jdGlvbih0aGlzLCAnb25FYWNoV2hlcmUnLCBxdWVyaWVzLmZpbHRlcnNbaV0uZS50b0pzb24oKSwgcXVlcnkpKTtcbiAgICAgICAgICAgICAgICB2YXIga2V5c18xID0gdHlwZW9mIHJlcXVlc3QuZmlsdGVyc1tpXSA9PT0gJ29iamVjdCcgPyBPYmplY3Qua2V5cyhyZXF1ZXN0LmZpbHRlcnNbaV0pIDogW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzIgPSBrZXlzXzE7IF9pIDwga2V5c18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGtleXNfMltfaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh1dGlsXzEuRGF0YVV0aWwuaXNOdWxsKChyZXF1ZXN0KVtwcm9wXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXF1ZXN0W3Byb3BdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyaWVzLnNlYXJjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGVtcCA9IHF1ZXJpZXMuc2VhcmNoZXNbaV0uZTtcbiAgICAgICAgICAgICAgICByZXF1ZXN0LnNlYXJjaGVzLnB1c2godXRpbF8xLkRhdGFVdGlsLmNhbGxBZGFwdG9yRnVuY3Rpb24odGhpcywgJ29uRWFjaFNlYXJjaCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzOiB0ZW1wLmZpZWxkTmFtZXMsXG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiB0ZW1wLm9wZXJhdG9yLFxuICAgICAgICAgICAgICAgICAgICBrZXk6IHRlbXAuc2VhcmNoS2V5LFxuICAgICAgICAgICAgICAgICAgICBpZ25vcmVDYXNlOiB0ZW1wLmlnbm9yZUNhc2VcbiAgICAgICAgICAgICAgICB9LCBxdWVyeSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyaWVzLmdyb3Vwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHJlcXVlc3QuZ3JvdXBzLnB1c2godXRpbF8xLkRhdGFVdGlsLmdldFZhbHVlKHF1ZXJpZXMuZ3JvdXBzW2ldLmUuZmllbGROYW1lLCBxdWVyeSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyaWVzLmFnZ3JlZ2F0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0ZW1wID0gcXVlcmllcy5hZ2dyZWdhdGVzW2ldLmU7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5hZ2dyZWdhdGVzLnB1c2goeyB0eXBlOiB0ZW1wLnR5cGUsIGZpZWxkOiB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUodGVtcC5maWVsZCwgcXVlcnkpIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlcSA9IHt9O1xuICAgICAgICAgICAgdGhpcy5nZXRSZXF1ZXN0UXVlcnkob3B0aW9ucywgcXVlcnksIHNpbmdsZXMsIHJlcXVlc3QsIHJlcSk7XG4gICAgICAgICAgICB1dGlsXzEuRGF0YVV0aWwuY2FsbEFkYXB0b3JGdW5jdGlvbih0aGlzLCAnYWRkUGFyYW1zJywgeyBkbTogZG0sIHF1ZXJ5OiBxdWVyeSwgcGFyYW1zOiBwYXJhbXMsIHJlcVBhcmFtczogcmVxIH0pO1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyZXEpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBrZXlzXzMgPSBrZXlzOyBfYSA8IGtleXNfMy5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGtleXNfM1tfYV07XG4gICAgICAgICAgICAgICAgaWYgKHV0aWxfMS5EYXRhVXRpbC5pc051bGwocmVxW3Byb3BdKSB8fCByZXFbcHJvcF0gPT09ICcnIHx8IHJlcVtwcm9wXS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHJlcVtwcm9wXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShvcHRpb25zLnNraXAgaW4gcmVxICYmIG9wdGlvbnMudGFrZSBpbiByZXEpICYmIHRha2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXFbb3B0aW9ucy5za2lwXSA9IHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvblNraXAnLCBza2lwLCBxdWVyeSk7XG4gICAgICAgICAgICAgICAgcmVxW29wdGlvbnMudGFrZV0gPSB1dGlsXzEuRGF0YVV0aWwuY2FsbEFkYXB0b3JGdW5jdGlvbih0aGlzLCAnb25UYWtlJywgdGFrZSwgcXVlcnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHAgPSB0aGlzLnB2dDtcbiAgICAgICAgICAgIHRoaXMucHZ0ID0ge307XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJlcXVlc3RUeXBlID09PSAnanNvbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShyZXEpLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgcHZ0RGF0YTogcCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRlbXAgPSB0aGlzLmNvbnZlcnRUb1F1ZXJ5U3RyaW5nKHJlcSwgcXVlcnksIGRtKTtcbiAgICAgICAgICAgIHRlbXAgPSAoZG0uZGF0YVNvdXJjZS51cmwuaW5kZXhPZignPycpICE9PSAtMSA/ICcmJyA6ICcvJykgKyB0ZW1wO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnR0VUJywgdXJsOiB0ZW1wLmxlbmd0aCA/IHVybC5yZXBsYWNlKC9cXC8qJC8sIHRlbXApIDogdXJsLCBwdnREYXRhOiBwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS5nZXRSZXF1ZXN0UXVlcnkgPSBmdW5jdGlvbiAob3B0aW9ucywgcXVlcnksIHNpbmdsZXMsIHJlcXVlc3QsIHJlcXVlc3QxKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW0gPSAncGFyYW0nO1xuICAgICAgICAgICAgdmFyIHJlcSA9IHJlcXVlc3QxO1xuICAgICAgICAgICAgcmVxW29wdGlvbnMuZnJvbV0gPSBxdWVyeS5mcm9tVGFibGU7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5leHBhbmQpIHtcbiAgICAgICAgICAgICAgICByZXFbb3B0aW9ucy5leHBhbmRdID0gcXVlcnkuZXhwYW5kcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcVtvcHRpb25zLnNlbGVjdF0gPSAnb25TZWxlY3QnIGluIHNpbmdsZXMgP1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvblNlbGVjdCcsIHV0aWxfMS5EYXRhVXRpbC5nZXRWYWx1ZShzaW5nbGVzLm9uU2VsZWN0LmZpZWxkTmFtZXMsIHF1ZXJ5KSwgcXVlcnkpIDogJyc7XG4gICAgICAgICAgICByZXFbb3B0aW9ucy5jb3VudF0gPSBxdWVyeS5yZXF1aXJlc0NvdW50cyA/IHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvbkNvdW50JywgcXVlcnkucmVxdWlyZXNDb3VudHMsIHF1ZXJ5KSA6ICcnO1xuICAgICAgICAgICAgcmVxW29wdGlvbnMuc2VhcmNoXSA9IHJlcXVlc3Quc2VhcmNoZXMubGVuZ3RoID8gdXRpbF8xLkRhdGFVdGlsLmNhbGxBZGFwdG9yRnVuY3Rpb24odGhpcywgJ29uU2VhcmNoJywgcmVxdWVzdC5zZWFyY2hlcywgcXVlcnkpIDogJyc7XG4gICAgICAgICAgICByZXFbb3B0aW9ucy5za2lwXSA9ICdvblNraXAnIGluIHNpbmdsZXMgP1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvblNraXAnLCB1dGlsXzEuRGF0YVV0aWwuZ2V0VmFsdWUoc2luZ2xlcy5vblNraXAubm9zLCBxdWVyeSksIHF1ZXJ5KSA6ICcnO1xuICAgICAgICAgICAgcmVxW29wdGlvbnMudGFrZV0gPSAnb25UYWtlJyBpbiBzaW5nbGVzID9cbiAgICAgICAgICAgICAgICB1dGlsXzEuRGF0YVV0aWwuY2FsbEFkYXB0b3JGdW5jdGlvbih0aGlzLCAnb25UYWtlJywgdXRpbF8xLkRhdGFVdGlsLmdldFZhbHVlKHNpbmdsZXMub25UYWtlLm5vcywgcXVlcnkpLCBxdWVyeSkgOiAnJztcbiAgICAgICAgICAgIHJlcVtvcHRpb25zLndoZXJlXSA9IHJlcXVlc3QuZmlsdGVycy5sZW5ndGggfHwgcmVxdWVzdC5zZWFyY2hlcy5sZW5ndGggP1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvbldoZXJlJywgcmVxdWVzdC5maWx0ZXJzLCBxdWVyeSkgOiAnJztcbiAgICAgICAgICAgIHJlcVtvcHRpb25zLnNvcnRCeV0gPSByZXF1ZXN0LnNvcnRzLmxlbmd0aCA/IHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvblNvcnRCeScsIHJlcXVlc3Quc29ydHMsIHF1ZXJ5KSA6ICcnO1xuICAgICAgICAgICAgcmVxW29wdGlvbnMuZ3JvdXBdID0gcmVxdWVzdC5ncm91cHMubGVuZ3RoID8gdXRpbF8xLkRhdGFVdGlsLmNhbGxBZGFwdG9yRnVuY3Rpb24odGhpcywgJ29uR3JvdXAnLCByZXF1ZXN0Lmdyb3VwcywgcXVlcnkpIDogJyc7XG4gICAgICAgICAgICByZXFbb3B0aW9ucy5hZ2dyZWdhdGVzXSA9IHJlcXVlc3QuYWdncmVnYXRlcy5sZW5ndGggP1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC5jYWxsQWRhcHRvckZ1bmN0aW9uKHRoaXMsICdvbkFnZ3JlZ2F0ZXMnLCByZXF1ZXN0LmFnZ3JlZ2F0ZXMsIHF1ZXJ5KSA6ICcnO1xuICAgICAgICAgICAgcmVxW3BhcmFtXSA9IFtdO1xuICAgICAgICB9O1xuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS5jb252ZXJ0VG9RdWVyeVN0cmluZyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBxdWVyeSwgZG0pIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUucHJvY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24gKGRhdGEsIGRzLCBxdWVyeSwgeGhyLCByZXF1ZXN0LCBjaGFuZ2VzKSB7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdHMgPSByZXF1ZXN0O1xuICAgICAgICAgICAgdmFyIHB2dCA9IHJlcXVlc3RzLnB2dERhdGEgfHwge307XG4gICAgICAgICAgICB2YXIgZ3JvdXBEcyA9IGRhdGEuZ3JvdXBEcztcbiAgICAgICAgICAgIGlmICh4aHIgJiYgeGhyLmdldFJlc3BvbnNlSGVhZGVyKCdDb250ZW50LVR5cGUnKSAmJlxuICAgICAgICAgICAgICAgIHhoci5nZXRSZXNwb25zZUhlYWRlcignQ29udGVudC1UeXBlJykuaW5kZXhPZigneG1sJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChxdWVyeS5yZXF1aXJlc0NvdW50cyA/IHsgcmVzdWx0OiBbXSwgY291bnQ6IDAgfSA6IFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkID0gSlNPTi5wYXJzZShyZXF1ZXN0cy5kYXRhKTtcbiAgICAgICAgICAgIGlmIChkICYmIGQuYWN0aW9uID09PSAnYmF0Y2gnICYmIGRhdGEuYWRkZWRSZWNvcmRzKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlcy5hZGRlZFJlY29yZHMgPSBkYXRhLmFkZGVkUmVjb3JkcztcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hhbmdlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLmQpIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gZGF0YS5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7fTtcbiAgICAgICAgICAgIGlmICgnY291bnQnIGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBhcmdzLmNvdW50ID0gZGF0YS5jb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFyZ3MucmVzdWx0ID0gZGF0YS5yZXN1bHQgPyBkYXRhLnJlc3VsdCA6IGRhdGE7XG4gICAgICAgICAgICB0aGlzLmdldEFnZ3JlZ2F0ZVJlc3VsdChwdnQsIGRhdGEsIGFyZ3MsIGdyb3VwRHMpO1xuICAgICAgICAgICAgcmV0dXJuIHV0aWxfMS5EYXRhVXRpbC5pc051bGwoYXJncy5jb3VudCkgPyBhcmdzLnJlc3VsdCA6IHsgcmVzdWx0OiBhcmdzLnJlc3VsdCwgY291bnQ6IGFyZ3MuY291bnQsIGFnZ3JlZ2F0ZXM6IGFyZ3MuYWdncmVnYXRlcyB9O1xuICAgICAgICB9O1xuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS5vbkdyb3VwID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMucHZ0Lmdyb3VwcyA9IGU7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUub25BZ2dyZWdhdGVzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMucHZ0LmFnZ3JlZ2F0ZXMgPSBlO1xuICAgICAgICB9O1xuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS5iYXRjaFJlcXVlc3QgPSBmdW5jdGlvbiAoZG0sIGNoYW5nZXMsIGUpIHtcbiAgICAgICAgICAgIHZhciB1cmw7XG4gICAgICAgICAgICB2YXIga2V5O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBkbS5kYXRhU291cmNlLmJhdGNoVXJsIHx8IGRtLmRhdGFTb3VyY2UuY3J1ZFVybCB8fCBkbS5kYXRhU291cmNlLnJlbW92ZVVybCB8fCBkbS5kYXRhU291cmNlLnVybCxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkOiBjaGFuZ2VzLmNoYW5nZWRSZWNvcmRzLFxuICAgICAgICAgICAgICAgICAgICBhZGRlZDogY2hhbmdlcy5hZGRlZFJlY29yZHMsXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQ6IGNoYW5nZXMuZGVsZXRlZFJlY29yZHMsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ2JhdGNoJyxcbiAgICAgICAgICAgICAgICAgICAgdGFibGU6IGVbdXJsXSxcbiAgICAgICAgICAgICAgICAgICAga2V5OiBlW2tleV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUuYmVmb3JlU2VuZCA9IGZ1bmN0aW9uIChkbSwgcmVxdWVzdCkge1xuICAgICAgICB9O1xuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoZG0sIGRhdGEsIHRhYmxlTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1cmw6IGRtLmRhdGFTb3VyY2UuaW5zZXJ0VXJsIHx8IGRtLmRhdGFTb3VyY2UuY3J1ZFVybCB8fCBkbS5kYXRhU291cmNlLnVybCxcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBkYXRhLFxuICAgICAgICAgICAgICAgICAgICB0YWJsZTogdGFibGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIFVybEFkYXB0b3IucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChkbSwga2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogZG0uZGF0YVNvdXJjZS5yZW1vdmVVcmwgfHwgZG0uZGF0YVNvdXJjZS5jcnVkVXJsIHx8IGRtLmRhdGFTb3VyY2UudXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAga2V5Q29sdW1uOiBrZXlGaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgdGFibGU6IHRhYmxlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncmVtb3ZlJ1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBVcmxBZGFwdG9yLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZG0sIGtleUZpZWxkLCB2YWx1ZSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IGRtLmRhdGFTb3VyY2UudXBkYXRlVXJsIHx8IGRtLmRhdGFTb3VyY2UuY3J1ZFVybCB8fCBkbS5kYXRhU291cmNlLnVybCxcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAndXBkYXRlJyxcbiAgICAgICAgICAgICAgICAgICAga2V5Q29sdW1uOiBrZXlGaWVsZCxcbiAgICAgICAgICAgICAgICAgICAga2V5OiB2YWx1ZVtrZXlGaWVsZF0sXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlOiB0YWJsZU5hbWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUuZ2V0RmlsdGVyc0Zyb20gPSBmdW5jdGlvbiAoZGF0YSwgcXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBxdWVyeS5mS2V5O1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIHByb3AgPSBrZXk7XG4gICAgICAgICAgICB2YXIgcEtleSA9IHF1ZXJ5LmtleTtcbiAgICAgICAgICAgIHZhciBwcmVkaWNhdHMgPSBbXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVswXSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBwcm9wID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVswXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB1dGlsXzEuRGF0YVV0aWwuZ2V0T2JqZWN0KHBLZXkgfHwgcHJvcCwgZGF0YVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGFbaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByZWRpY2F0cy5wdXNoKG5ldyBxdWVyeV8xLlByZWRpY2F0ZShrZXksICdlcXVhbCcsIHZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcXVlcnlfMS5QcmVkaWNhdGUub3IocHJlZGljYXRzKTtcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUuZ2V0QWdncmVnYXRlUmVzdWx0ID0gZnVuY3Rpb24gKHB2dCwgZGF0YSwgYXJncywgZ3JvdXBEcykge1xuICAgICAgICAgICAgdmFyIHBEYXRhID0gZGF0YTtcbiAgICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcERhdGEgPSBkYXRhLnJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwdnQgJiYgcHZ0LmFnZ3JlZ2F0ZXMgJiYgcHZ0LmFnZ3JlZ2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFnZyA9IHB2dC5hZ2dyZWdhdGVzO1xuICAgICAgICAgICAgICAgIHZhciBmbiA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgYWdncmVnYXRlRGF0YSA9IHBEYXRhO1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5hZ2dyZWdhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlRGF0YSA9IGRhdGEuYWdncmVnYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFnZy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBmbiA9IHV0aWxfMS5EYXRhVXRpbC5hZ2dyZWdhdGVzW2FnZ1tpXS50eXBlXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNbYWdnW2ldLmZpZWxkICsgJyAtICcgKyBhZ2dbaV0udHlwZV0gPSBmbihhZ2dyZWdhdGVEYXRhLCBhZ2dbaV0uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFyZ3MuYWdncmVnYXRlcyA9IHJlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwdnQgJiYgcHZ0Lmdyb3VwcyAmJiBwdnQuZ3JvdXBzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSBwdnQuZ3JvdXBzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZChncm91cERzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBEcyA9IHV0aWxfMS5EYXRhVXRpbC5ncm91cChncm91cERzLCBncm91cHNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBEYXRhID0gdXRpbF8xLkRhdGFVdGlsLmdyb3VwKHBEYXRhLCBncm91cHNbaV0sIHB2dC5hZ2dyZWdhdGVzLCBsZXZlbCwgZ3JvdXBEcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFyZ3MucmVzdWx0ID0gcERhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYXJncztcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUuZ2V0UXVlcnlSZXF1ZXN0ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgICAgICB2YXIgcmVxID0geyBzb3J0czogW10sIGdyb3VwczogW10sIGZpbHRlcnM6IFtdLCBzZWFyY2hlczogW10sIGFnZ3JlZ2F0ZXM6IFtdIH07XG4gICAgICAgICAgICByZXEuc29ydHMgPSBxdWVyeV8xLlF1ZXJ5LmZpbHRlclF1ZXJpZXMocXVlcnkucXVlcmllcywgJ29uU29ydEJ5Jyk7XG4gICAgICAgICAgICByZXEuZ3JvdXBzID0gcXVlcnlfMS5RdWVyeS5maWx0ZXJRdWVyaWVzKHF1ZXJ5LnF1ZXJpZXMsICdvbkdyb3VwJyk7XG4gICAgICAgICAgICByZXEuZmlsdGVycyA9IHF1ZXJ5XzEuUXVlcnkuZmlsdGVyUXVlcmllcyhxdWVyeS5xdWVyaWVzLCAnb25XaGVyZScpO1xuICAgICAgICAgICAgcmVxLnNlYXJjaGVzID0gcXVlcnlfMS5RdWVyeS5maWx0ZXJRdWVyaWVzKHF1ZXJ5LnF1ZXJpZXMsICdvblNlYXJjaCcpO1xuICAgICAgICAgICAgcmVxLmFnZ3JlZ2F0ZXMgPSBxdWVyeV8xLlF1ZXJ5LmZpbHRlclF1ZXJpZXMocXVlcnkucXVlcmllcywgJ29uQWdncmVnYXRlcycpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcTtcbiAgICAgICAgfTtcbiAgICAgICAgVXJsQWRhcHRvci5wcm90b3R5cGUuYWRkUGFyYW1zID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciByZXEgPSBvcHRpb25zLnJlcVBhcmFtcztcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnBhcmFtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXEucGFyYW1zID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gb3B0aW9ucy5wYXJhbXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRtcCA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICBpZiAocmVxW3RtcC5rZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUXVlcnkoKSAtIGFkZFBhcmFtczogQ3VzdG9tIFBhcmFtIGlzIGNvbmZsaWN0aW5nIG90aGVyIHJlcXVlc3QgYXJndW1lbnRzJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlcVt0bXAua2V5XSA9IHRtcC52YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodG1wLmZuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcVt0bXAua2V5XSA9IHRtcC5mbi5jYWxsKG9wdGlvbnMucXVlcnksIHRtcC5rZXksIG9wdGlvbnMucXVlcnksIG9wdGlvbnMuZG0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXEucGFyYW1zW3RtcC5rZXldID0gcmVxW3RtcC5rZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVXJsQWRhcHRvcjtcbiAgICB9KEFkYXB0b3IpKTtcbiAgICBleHBvcnRzLlVybEFkYXB0b3IgPSBVcmxBZGFwdG9yO1xuICAgIHZhciBPRGF0YUFkYXB0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoT0RhdGFBZGFwdG9yLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBPRGF0YUFkYXB0b3IoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3B0aW9ucyA9IGVqMl9iYXNlXzEuZXh0ZW5kKHt9LCBfdGhpcy5vcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6ICdnZXQnLFxuICAgICAgICAgICAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb247b2RhdGE9bGlnaHQ7cT0xLGFwcGxpY2F0aW9uL2pzb247b2RhdGE9dmVyYm9zZTtxPTAuNScsXG4gICAgICAgICAgICAgICAgbXVsdGlwYXJ0QWNjZXB0OiAnbXVsdGlwYXJ0L21peGVkJyxcbiAgICAgICAgICAgICAgICBzb3J0Qnk6ICckb3JkZXJieScsXG4gICAgICAgICAgICAgICAgc2VsZWN0OiAnJHNlbGVjdCcsXG4gICAgICAgICAgICAgICAgc2tpcDogJyRza2lwJyxcbiAgICAgICAgICAgICAgICB0YWtlOiAnJHRvcCcsXG4gICAgICAgICAgICAgICAgY291bnQ6ICckaW5saW5lY291bnQnLFxuICAgICAgICAgICAgICAgIHdoZXJlOiAnJGZpbHRlcicsXG4gICAgICAgICAgICAgICAgZXhwYW5kOiAnJGV4cGFuZCcsXG4gICAgICAgICAgICAgICAgYmF0Y2g6ICckYmF0Y2gnLFxuICAgICAgICAgICAgICAgIGNoYW5nZVNldDogJy0tY2hhbmdlc2V0XycsXG4gICAgICAgICAgICAgICAgYmF0Y2hQcmU6ICdiYXRjaF8nLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRJZDogJ0NvbnRlbnQtSWQ6ICcsXG4gICAgICAgICAgICAgICAgYmF0Y2hDb250ZW50OiAnQ29udGVudC1UeXBlOiBtdWx0aXBhcnQvbWl4ZWQ7IGJvdW5kYXJ5PScsXG4gICAgICAgICAgICAgICAgY2hhbmdlU2V0Q29udGVudDogJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vaHR0cFxcbkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IGJpbmFyeSAnLFxuICAgICAgICAgICAgICAgIGJhdGNoQ2hhbmdlU2V0Q29udGVudFR5cGU6ICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTggJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpcy5nZXRNb2R1bGVOYW1lID0gZWoyX2Jhc2VfMS5nZXRWYWx1ZSgnZ2V0TW9kdWxlbmFtZScsIF90aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBPRGF0YUFkYXB0b3IucHJvdG90eXBlLm9uUHJlZGljYXRlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgcXVlcnksIHJlcXVpcmVzQ2FzdCkge1xuICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gJyc7XG4gICAgICAgICAgICB2YXIgb3BlcmF0b3I7XG4gICAgICAgICAgICB2YXIgZ3VpZDtcbiAgICAgICAgICAgIHZhciB2YWwgPSBwcmVkaWNhdGUudmFsdWU7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IHR5cGVvZiB2YWw7XG4gICAgICAgICAgICB2YXIgZmllbGQgPSBwcmVkaWNhdGUuZmllbGQgPyBPRGF0YUFkYXB0b3IuZ2V0RmllbGQocHJlZGljYXRlLmZpZWxkKSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhbCA9ICdkYXRldGltZVxcJycgKyB1dGlsXzEuRGF0YVV0aWwucGFyc2UucmVwbGFjZXIodmFsKSArICdcXCcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gJ1xcJycgKyB2YWwgKyAnXFwnJztcbiAgICAgICAgICAgICAgICBpZiAocmVxdWlyZXNDYXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkID0gJ2Nhc3QoJyArIGZpZWxkICsgJywgXFwnRWRtLlN0cmluZ1xcJyknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodXRpbF8xLkRhdGFVdGlsLnBhcnNlLmlzR3VpZCh2YWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIGd1aWQgPSAnZ3VpZCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcmVkaWNhdGUuaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWd1aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkID0gJ3RvbG93ZXIoJyArIGZpZWxkICsgJyknO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHZhbC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wZXJhdG9yID0gdXRpbF8xLkRhdGFVdGlsLm9kQmlPcGVyYXRvcltwcmVkaWNhdGUub3BlcmF0b3JdO1xuICAgICAgICAgICAgaWYgKG9wZXJhdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgKz0gZmllbGQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgKz0gb3BlcmF0b3I7XG4gICAgICAgICAgICAgICAgaWYgKGd1aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgKz0gZ3VpZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlICsgdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZ2V0TW9kdWxlTmFtZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdPRGF0YVY0QWRhcHRvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3IgPSB1dGlsXzEuRGF0YVV0aWwub2R2NFVuaU9wZXJhdG9yW3ByZWRpY2F0ZS5vcGVyYXRvcl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3BlcmF0b3IgPSB1dGlsXzEuRGF0YVV0aWwub2RVbmlPcGVyYXRvcltwcmVkaWNhdGUub3BlcmF0b3JdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yID09PSAnc3Vic3RyaW5nb2YnKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB2YWw7XG4gICAgICAgICAgICAgICAgdmFsID0gZmllbGQ7XG4gICAgICAgICAgICAgICAgZmllbGQgPSB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuVmFsdWUgKz0gb3BlcmF0b3IgKyAnKCc7XG4gICAgICAgICAgICByZXR1cm5WYWx1ZSArPSBmaWVsZCArICcsJztcbiAgICAgICAgICAgIGlmIChndWlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgKz0gZ3VpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVyblZhbHVlICs9IHZhbCArICcpJztcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5vbkNvbXBsZXhQcmVkaWNhdGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCBxdWVyeSwgcmVxdWlyZXNDYXN0KSB7XG4gICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByZWRpY2F0ZS5wcmVkaWNhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goJygnICsgdGhpcy5vbkVhY2hXaGVyZShwcmVkaWNhdGUucHJlZGljYXRlc1tpXSwgcXVlcnksIHJlcXVpcmVzQ2FzdCkgKyAnKScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qb2luKCcgJyArIHByZWRpY2F0ZS5jb25kaXRpb24gKyAnICcpO1xuICAgICAgICB9O1xuICAgICAgICBPRGF0YUFkYXB0b3IucHJvdG90eXBlLm9uRWFjaFdoZXJlID0gZnVuY3Rpb24gKGZpbHRlciwgcXVlcnksIHJlcXVpcmVzQ2FzdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlci5pc0NvbXBsZXggPyB0aGlzLm9uQ29tcGxleFByZWRpY2F0ZShmaWx0ZXIsIHF1ZXJ5LCByZXF1aXJlc0Nhc3QpIDogdGhpcy5vblByZWRpY2F0ZShmaWx0ZXIsIHF1ZXJ5LCByZXF1aXJlc0Nhc3QpO1xuICAgICAgICB9O1xuICAgICAgICBPRGF0YUFkYXB0b3IucHJvdG90eXBlLm9uV2hlcmUgPSBmdW5jdGlvbiAoZmlsdGVycykge1xuICAgICAgICAgICAgaWYgKHRoaXMucHZ0LnNlYXJjaCkge1xuICAgICAgICAgICAgICAgIGZpbHRlcnMucHVzaCh0aGlzLm9uRWFjaFdoZXJlKHRoaXMucHZ0LnNlYXJjaCwgbnVsbCwgdHJ1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcnMuam9pbignIGFuZCAnKTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5vbkVhY2hTZWFyY2ggPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUuZmllbGRzICYmIGUuZmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHV0aWxfMS5EYXRhVXRpbC50aHJvd0Vycm9yKCdRdWVyeSgpIC0gU2VhcmNoIDogb0RhdGEgc2VhcmNoIHJlcXVpcmVzIGxpc3Qgb2YgZmllbGQgbmFtZXMgdG8gc2VhcmNoJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gdGhpcy5wdnQuc2VhcmNoIHx8IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmZpZWxkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGZpbHRlci5wdXNoKG5ldyBxdWVyeV8xLlByZWRpY2F0ZShlLmZpZWxkc1tpXSwgZS5vcGVyYXRvciwgZS5rZXksIGUuaWdub3JlQ2FzZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wdnQuc2VhcmNoID0gZmlsdGVyO1xuICAgICAgICB9O1xuICAgICAgICBPRGF0YUFkYXB0b3IucHJvdG90eXBlLm9uU2VhcmNoID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMucHZ0LnNlYXJjaCA9IHF1ZXJ5XzEuUHJlZGljYXRlLm9yKHRoaXMucHZ0LnNlYXJjaCk7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUub25FYWNoU29ydCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICBpZiAoZS5uYW1lIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGUubmFtZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChPRGF0YUFkYXB0b3IuZ2V0RmllbGQoZS5uYW1lW2ldKSArIChlLmRpcmVjdGlvbiA9PT0gJ2Rlc2NlbmRpbmcnID8gJyBkZXNjJyA6ICcnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goT0RhdGFBZGFwdG9yLmdldEZpZWxkKGUubmFtZSkgKyAoZS5kaXJlY3Rpb24gPT09ICdkZXNjZW5kaW5nJyA/ICcgZGVzYycgOiAnJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qb2luKCcsJyk7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUub25Tb3J0QnkgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGUucmV2ZXJzZSgpLmpvaW4oJywnKTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5vbkdyb3VwID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMucHZ0Lmdyb3VwcyA9IGU7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUub25TZWxlY3QgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZVtpXSA9IE9EYXRhQWRhcHRvci5nZXRGaWVsZChlW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlLmpvaW4oJywnKTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5vbkFnZ3JlZ2F0ZXMgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5wdnQuYWdncmVnYXRlcyA9IGU7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUub25Db3VudCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gZSA9PT0gdHJ1ZSA/ICdhbGxwYWdlcycgOiAnJztcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5iZWZvcmVTZW5kID0gZnVuY3Rpb24gKGRtLCByZXF1ZXN0LCBzZXR0aW5ncykge1xuICAgICAgICAgICAgaWYgKHV0aWxfMS5EYXRhVXRpbC5lbmRzV2l0aChzZXR0aW5ncy51cmwsIHRoaXMub3B0aW9ucy5iYXRjaCkgJiYgc2V0dGluZ3MudHlwZS50b0xvd2VyQ2FzZSgpID09PSAncG9zdCcpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsIHRoaXMub3B0aW9ucy5tdWx0aXBhcnRBY2NlcHQpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignRGF0YVNlcnZpY2VWZXJzaW9uJywgJzIuMCcpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3Qub3ZlcnJpZGVNaW1lVHlwZSgndGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCB0aGlzLm9wdGlvbnMuYWNjZXB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignRGF0YVNlcnZpY2VWZXJzaW9uJywgJzIuMCcpO1xuICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdNYXhEYXRhU2VydmljZVZlcnNpb24nLCAnMi4wJyk7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUucHJvY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24gKGRhdGEsIGRzLCBxdWVyeSwgeGhyLCByZXF1ZXN0LCBjaGFuZ2VzKSB7XG4gICAgICAgICAgICB2YXIgcHZ0RGF0YSA9ICdwdnREYXRhJztcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZChkYXRhLmQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFDb3B5ID0gKHF1ZXJ5ICYmIHF1ZXJ5LnJlcXVpcmVzQ291bnRzKSA/IGRhdGEuZC5yZXN1bHRzIDogZGF0YS5kO1xuICAgICAgICAgICAgICAgIHZhciBtZXRhRGF0YSA9ICdfX21ldGFkYXRhJztcbiAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZGF0YUNvcHkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YUNvcHkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZChkYXRhQ29weVtpXVttZXRhRGF0YV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGFDb3B5W2ldW21ldGFEYXRhXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwdnQgPSByZXF1ZXN0ICYmIHJlcXVlc3RbcHZ0RGF0YV07XG4gICAgICAgICAgICB2YXIgZW1wdHlBbmRCYXRjaCA9IHRoaXMucHJvY2Vzc0JhdGNoUmVzcG9uc2UoZGF0YSwgcXVlcnksIHhociwgcmVxdWVzdCwgY2hhbmdlcyk7XG4gICAgICAgICAgICBpZiAoZW1wdHlBbmRCYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbXB0eUFuZEJhdGNoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZlcnNpb25DaGVjayA9IHhociAmJiByZXF1ZXN0LmdldFJlc3BvbnNlSGVhZGVyKCdEYXRhU2VydmljZVZlcnNpb24nKTtcbiAgICAgICAgICAgIHZhciBjb3VudCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9ICh2ZXJzaW9uQ2hlY2sgJiYgcGFyc2VJbnQodmVyc2lvbkNoZWNrLCAxMCkpIHx8IDI7XG4gICAgICAgICAgICBpZiAocXVlcnkgJiYgcXVlcnkucmVxdWlyZXNDb3VudHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgb0RhdGFDb3VudCA9ICdfX2NvdW50JztcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVtvRGF0YUNvdW50XSB8fCBkYXRhWydvZGF0YS5jb3VudCddKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gZGF0YVtvRGF0YUNvdW50XSB8fCBkYXRhWydvZGF0YS5jb3VudCddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChkYXRhW29EYXRhQ291bnRdIHx8IGRhdGFbJ29kYXRhLmNvdW50J10pIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQgPSBkYXRhW29EYXRhQ291bnRdIHx8IGRhdGFbJ29kYXRhLmNvdW50J107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZlcnNpb24gPT09IDMgJiYgZGF0YS52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRhdGEuZCkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmVyc2lvbiA8IDMgJiYgZGF0YS5yZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgICAgICBhcmdzLmNvdW50ID0gY291bnQ7XG4gICAgICAgICAgICBhcmdzLnJlc3VsdCA9IGRhdGE7XG4gICAgICAgICAgICB0aGlzLmdldEFnZ3JlZ2F0ZVJlc3VsdChwdnQsIGRhdGEsIGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIHV0aWxfMS5EYXRhVXRpbC5pc051bGwoY291bnQpID8gYXJncy5yZXN1bHQgOiB7IHJlc3VsdDogYXJncy5yZXN1bHQsIGNvdW50OiBhcmdzLmNvdW50LCBhZ2dyZWdhdGVzOiBhcmdzLmFnZ3JlZ2F0ZXMgfTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5jb252ZXJ0VG9RdWVyeVN0cmluZyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBxdWVyeSwgZG0pIHtcbiAgICAgICAgICAgIHZhciByZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciB0YWJsZSA9ICd0YWJsZSc7XG4gICAgICAgICAgICB2YXIgdGFibGVOYW1lID0gcmVxdWVzdFt0YWJsZV0gfHwgJyc7XG4gICAgICAgICAgICB2YXIgZm9ybWF0ID0gJyRmb3JtYXQnO1xuICAgICAgICAgICAgZGVsZXRlIHJlcXVlc3RbdGFibGVdO1xuICAgICAgICAgICAgaWYgKGRtLmRhdGFTb3VyY2UucmVxdWlyZXNGb3JtYXQpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0W2Zvcm1hdF0gPSAnanNvbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJlcXVlc3QpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzQgPSBrZXlzOyBfaSA8IGtleXNfNC5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGtleXNfNFtfaV07XG4gICAgICAgICAgICAgICAgcmVzLnB1c2gocHJvcCArICc9JyArIHJlcXVlc3RbcHJvcF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzID0gcmVzLmpvaW4oJyYnKTtcbiAgICAgICAgICAgIGlmIChkbS5kYXRhU291cmNlLnVybCAmJiBkbS5kYXRhU291cmNlLnVybC5pbmRleE9mKCc/JykgIT09IC0xICYmICF0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcy5sZW5ndGggPyB0YWJsZU5hbWUgKyAnPycgKyByZXMgOiB0YWJsZU5hbWUgfHwgJyc7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKGRtLCBkYXRhLCB0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdXJsOiBkbS5kYXRhU291cmNlLnVybC5yZXBsYWNlKC9cXC8qJC8sIHRhYmxlTmFtZSA/ICcvJyArIHRhYmxlTmFtZSA6ICcnKSxcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZG0sIGtleUZpZWxkLCB2YWx1ZSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgIHVybDogZG0uZGF0YVNvdXJjZS51cmwucmVwbGFjZSgvXFwvKiQvLCB0YWJsZU5hbWUgPyAnLycgKyB0YWJsZU5hbWUgOiAnJykgKyAnKCcgKyB2YWx1ZSArICcpJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZG0sIGtleUZpZWxkLCB2YWx1ZSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQVVQnLFxuICAgICAgICAgICAgICAgIHVybDogZG0uZGF0YVNvdXJjZS51cmwucmVwbGFjZSgvXFwvKiQvLCB0YWJsZU5hbWUgPyAnLycgKyB0YWJsZU5hbWUgOiAnJykgKyAnKCcgKyB2YWx1ZVtrZXlGaWVsZF0gKyAnKScsXG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkodmFsdWUpLFxuICAgICAgICAgICAgICAgIGFjY2VwdDogdGhpcy5vcHRpb25zLmFjY2VwdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5iYXRjaFJlcXVlc3QgPSBmdW5jdGlvbiAoZG0sIGNoYW5nZXMsIGUpIHtcbiAgICAgICAgICAgIHZhciBpbml0aWFsR3VpZCA9IGUuZ3VpZCA9IHV0aWxfMS5EYXRhVXRpbC5nZXRHdWlkKHRoaXMub3B0aW9ucy5iYXRjaFByZSk7XG4gICAgICAgICAgICB2YXIgdXJsID0gZG0uZGF0YVNvdXJjZS51cmwucmVwbGFjZSgvXFwvKiQvLCAnLycgKyB0aGlzLm9wdGlvbnMuYmF0Y2gpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgdXJsOiBlLnVybCxcbiAgICAgICAgICAgICAgICBrZXk6IGUua2V5LFxuICAgICAgICAgICAgICAgIGNpZDogMSxcbiAgICAgICAgICAgICAgICBjU2V0OiB1dGlsXzEuRGF0YVV0aWwuZ2V0R3VpZCh0aGlzLm9wdGlvbnMuY2hhbmdlU2V0KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciByZXEgPSAnLS0nICsgaW5pdGlhbEd1aWQgKyAnXFxuJztcbiAgICAgICAgICAgIHJlcSArPSAnQ29udGVudC1UeXBlOiBtdWx0aXBhcnQvbWl4ZWQ7IGJvdW5kYXJ5PScgKyBhcmdzLmNTZXQucmVwbGFjZSgnLS0nLCAnJykgKyAnXFxuJztcbiAgICAgICAgICAgIHRoaXMucHZ0LmNoYW5nZVNldCA9IDA7XG4gICAgICAgICAgICByZXEgKz0gdGhpcy5nZW5lcmF0ZUluc2VydFJlcXVlc3QoY2hhbmdlcy5hZGRlZFJlY29yZHMsIGFyZ3MpO1xuICAgICAgICAgICAgcmVxICs9IHRoaXMuZ2VuZXJhdGVVcGRhdGVSZXF1ZXN0KGNoYW5nZXMuY2hhbmdlZFJlY29yZHMsIGFyZ3MpO1xuICAgICAgICAgICAgcmVxICs9IHRoaXMuZ2VuZXJhdGVEZWxldGVSZXF1ZXN0KGNoYW5nZXMuZGVsZXRlZFJlY29yZHMsIGFyZ3MpO1xuICAgICAgICAgICAgcmVxICs9IGFyZ3MuY1NldCArICctLVxcbic7XG4gICAgICAgICAgICByZXEgKz0gJy0tJyArIGluaXRpYWxHdWlkICsgJy0tJztcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdtdWx0aXBhcnQvbWl4ZWQ7IGNoYXJzZXQ9VVRGLTg7Ym91bmRhcnk9JyArIGluaXRpYWxHdWlkLFxuICAgICAgICAgICAgICAgIGRhdGE6IHJlcVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5nZW5lcmF0ZURlbGV0ZVJlcXVlc3QgPSBmdW5jdGlvbiAoYXJyLCBlKSB7XG4gICAgICAgICAgICBpZiAoIWFycikge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXEgPSAnJztcbiAgICAgICAgICAgIHZhciBzdGF0ID0ge1xuICAgICAgICAgICAgICAgICdtZXRob2QnOiAnREVMRVRFICcsXG4gICAgICAgICAgICAgICAgJ3VybCc6IGZ1bmN0aW9uIChkYXRhLCBpLCBrZXkpIHsgcmV0dXJuICcoJyArIGRhdGFbaV1ba2V5XSArICcpJzsgfSxcbiAgICAgICAgICAgICAgICAnZGF0YSc6IGZ1bmN0aW9uIChkYXRhLCBpKSB7IHJldHVybiAnJzsgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcSA9IHRoaXMuZ2VuZXJhdGVCb2R5Q29udGVudChhcnIsIGUsIHN0YXQpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcSArICdcXG4nO1xuICAgICAgICB9O1xuICAgICAgICBPRGF0YUFkYXB0b3IucHJvdG90eXBlLmdlbmVyYXRlSW5zZXJ0UmVxdWVzdCA9IGZ1bmN0aW9uIChhcnIsIGUpIHtcbiAgICAgICAgICAgIGlmICghYXJyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlcSA9ICcnO1xuICAgICAgICAgICAgdmFyIHN0YXQgPSB7XG4gICAgICAgICAgICAgICAgJ21ldGhvZCc6ICdQT1NUICcsXG4gICAgICAgICAgICAgICAgJ3VybCc6IGZ1bmN0aW9uIChkYXRhLCBpLCBrZXkpIHsgcmV0dXJuICcnOyB9LFxuICAgICAgICAgICAgICAgICdkYXRhJzogZnVuY3Rpb24gKGRhdGEsIGkpIHsgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGFbaV0pICsgJ1xcblxcbic7IH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXEgPSB0aGlzLmdlbmVyYXRlQm9keUNvbnRlbnQoYXJyLCBlLCBzdGF0KTtcbiAgICAgICAgICAgIHJldHVybiByZXE7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhQWRhcHRvci5wcm90b3R5cGUuZ2VuZXJhdGVVcGRhdGVSZXF1ZXN0ID0gZnVuY3Rpb24gKGFyciwgZSkge1xuICAgICAgICAgICAgaWYgKCFhcnIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVxID0gJyc7XG4gICAgICAgICAgICB2YXIgc3RhdCA9IHtcbiAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ1BVVCAnLFxuICAgICAgICAgICAgICAgICd1cmwnOiBmdW5jdGlvbiAoZGF0YSwgaSwga2V5KSB7IHJldHVybiAnKCcgKyBkYXRhW2ldW2tleV0gKyAnKSc7IH0sXG4gICAgICAgICAgICAgICAgJ2RhdGEnOiBmdW5jdGlvbiAoZGF0YSwgaSkgeyByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YVtpXSkgKyAnXFxuXFxuJzsgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcSA9IHRoaXMuZ2VuZXJhdGVCb2R5Q29udGVudChhcnIsIGUsIHN0YXQpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLmdldEZpZWxkID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wLnJlcGxhY2UoL1xcLi9nLCAnLycpO1xuICAgICAgICB9O1xuICAgICAgICBPRGF0YUFkYXB0b3IucHJvdG90eXBlLmdlbmVyYXRlQm9keUNvbnRlbnQgPSBmdW5jdGlvbiAoYXJyLCBlLCBzdGF0KSB7XG4gICAgICAgICAgICB2YXIgcmVxID0gJyc7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHJlcSArPSAnXFxuJyArIGUuY1NldCArICdcXG4nO1xuICAgICAgICAgICAgICAgIHJlcSArPSB0aGlzLm9wdGlvbnMuY2hhbmdlU2V0Q29udGVudCArICdcXG5cXG4nO1xuICAgICAgICAgICAgICAgIHJlcSArPSBzdGF0Lm1ldGhvZDtcbiAgICAgICAgICAgICAgICByZXEgKz0gZS51cmwgKyBzdGF0LnVybChhcnIsIGksIGUua2V5KSArICcgSFRUUC8xLjFcXG4nO1xuICAgICAgICAgICAgICAgIHJlcSArPSAnQWNjZXB0OiAnICsgdGhpcy5vcHRpb25zLmFjY2VwdCArICdcXG4nO1xuICAgICAgICAgICAgICAgIHJlcSArPSAnQ29udGVudC1JZDogJyArIHRoaXMucHZ0LmNoYW5nZVNldCsrICsgJ1xcbic7XG4gICAgICAgICAgICAgICAgcmVxICs9IHRoaXMub3B0aW9ucy5iYXRjaENoYW5nZVNldENvbnRlbnRUeXBlICsgJ1xcblxcbic7XG4gICAgICAgICAgICAgICAgcmVxICs9IHN0YXQuZGF0YShhcnIsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFBZGFwdG9yLnByb3RvdHlwZS5wcm9jZXNzQmF0Y2hSZXNwb25zZSA9IGZ1bmN0aW9uIChkYXRhLCBxdWVyeSwgeGhyLCByZXF1ZXN0LCBjaGFuZ2VzKSB7XG4gICAgICAgICAgICBpZiAoeGhyICYmIHhoci5nZXRSZXNwb25zZUhlYWRlcignQ29udGVudC1UeXBlJykgJiYgeGhyLmdldFJlc3BvbnNlSGVhZGVyKCdDb250ZW50LVR5cGUnKS5pbmRleE9mKCd4bWwnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHF1ZXJ5LnJlcXVpcmVzQ291bnRzID8geyByZXN1bHQ6IFtdLCBjb3VudDogMCB9IDogW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlcXVlc3QgJiYgdGhpcy5vcHRpb25zLmJhdGNoICYmIHV0aWxfMS5EYXRhVXRpbC5lbmRzV2l0aChyZXF1ZXN0LnVybCwgdGhpcy5vcHRpb25zLmJhdGNoKSAmJiByZXF1ZXN0LnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ3Bvc3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGd1aWQgPSB4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtVHlwZScpO1xuICAgICAgICAgICAgICAgIHZhciBjSWR4ID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIHZhciBqc29uT2JqID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGd1aWQgPSBndWlkLnN1YnN0cmluZyhndWlkLmluZGV4T2YoJz1iYXRjaHJlc3BvbnNlJykgKyAxKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gZGF0YS5zcGxpdChndWlkKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YSA9IGRhdGFbMV07XG4gICAgICAgICAgICAgICAgdmFyIGV4VmFsID0gLyg/OlxcYkNvbnRlbnQtVHlwZS4rYm91bmRhcnk9KShjaGFuZ2VzZXRyZXNwb25zZS4rKS9pLmV4ZWMoZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4VmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmVwbGFjZShleFZhbFswXSwgJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlR3VpZCA9IGV4VmFsID8gZXhWYWxbMV0gOiAnJztcbiAgICAgICAgICAgICAgICBkYXRhID0gZGF0YS5zcGxpdChjaGFuZ2VHdWlkKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZGF0YS5sZW5ndGg7IGkgPiAtMTsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghL1xcYkNvbnRlbnQtSUQ6L2kudGVzdChkYXRhW2ldKSB8fCAhL1xcYkhUVFAuKzIwMS8udGVzdChkYXRhW2ldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY0lkeCA9IHBhcnNlSW50KC9cXGJDb250ZW50LUlEOiAoXFxkKykvaS5leGVjKGRhdGFbaV0pWzFdLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VzLmFkZGVkUmVjb3Jkc1tjSWR4XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAganNvbk9iaiA9IHV0aWxfMS5EYXRhVXRpbC5wYXJzZS5wYXJzZUpzb24oL15cXHsuK1xcfS9tLmV4ZWMoZGF0YVtpXSlbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5leHRlbmQoe30sIGNoYW5nZXMuYWRkZWRSZWNvcmRzW2NJZHhdLCB0aGlzLnByb2Nlc3NSZXNwb25zZShqc29uT2JqKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoYW5nZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE9EYXRhQWRhcHRvcjtcbiAgICB9KFVybEFkYXB0b3IpKTtcbiAgICBleHBvcnRzLk9EYXRhQWRhcHRvciA9IE9EYXRhQWRhcHRvcjtcbiAgICB2YXIgT0RhdGFWNEFkYXB0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoT0RhdGFWNEFkYXB0b3IsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIE9EYXRhVjRBZGFwdG9yKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vcHRpb25zID0gZWoyX2Jhc2VfMS5leHRlbmQoe30sIF90aGlzLm9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0VHlwZTogJ2dldCcsXG4gICAgICAgICAgICAgICAgYWNjZXB0OiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMScsXG4gICAgICAgICAgICAgICAgbXVsdGlwYXJ0QWNjZXB0OiAnbXVsdGlwYXJ0L21peGVkJyxcbiAgICAgICAgICAgICAgICBzb3J0Qnk6ICckb3JkZXJieScsXG4gICAgICAgICAgICAgICAgc2VsZWN0OiAnJHNlbGVjdCcsXG4gICAgICAgICAgICAgICAgc2tpcDogJyRza2lwJyxcbiAgICAgICAgICAgICAgICB0YWtlOiAnJHRvcCcsXG4gICAgICAgICAgICAgICAgY291bnQ6ICckY291bnQnLFxuICAgICAgICAgICAgICAgIHNlYXJjaDogJyRzZWFyY2gnLFxuICAgICAgICAgICAgICAgIHdoZXJlOiAnJGZpbHRlcicsXG4gICAgICAgICAgICAgICAgZXhwYW5kOiAnJGV4cGFuZCcsXG4gICAgICAgICAgICAgICAgYmF0Y2g6ICckYmF0Y2gnLFxuICAgICAgICAgICAgICAgIGNoYW5nZVNldDogJy0tY2hhbmdlc2V0XycsXG4gICAgICAgICAgICAgICAgYmF0Y2hQcmU6ICdiYXRjaF8nLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRJZDogJ0NvbnRlbnQtSWQ6ICcsXG4gICAgICAgICAgICAgICAgYmF0Y2hDb250ZW50OiAnQ29udGVudC1UeXBlOiBtdWx0aXBhcnQvbWl4ZWQ7IGJvdW5kYXJ5PScsXG4gICAgICAgICAgICAgICAgY2hhbmdlU2V0Q29udGVudDogJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vaHR0cFxcbkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IGJpbmFyeSAnLFxuICAgICAgICAgICAgICAgIGJhdGNoQ2hhbmdlU2V0Q29udGVudFR5cGU6ICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTggJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgT0RhdGFWNEFkYXB0b3IucHJvdG90eXBlLmdldE1vZHVsZW5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ09EYXRhVjRBZGFwdG9yJztcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBPRGF0YVY0QWRhcHRvci5wcm90b3R5cGUub25Db3VudCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gZSA9PT0gdHJ1ZSA/ICd0cnVlJyA6ICcnO1xuICAgICAgICB9O1xuICAgICAgICBPRGF0YVY0QWRhcHRvci5wcm90b3R5cGUub25QcmVkaWNhdGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCBxdWVyeSwgcmVxdWlyZXNDYXN0KSB7XG4gICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSAnJztcbiAgICAgICAgICAgIHZhciB2YWwgPSBwcmVkaWNhdGUudmFsdWU7XG4gICAgICAgICAgICB2YXIgaXNEYXRlID0gdmFsIGluc3RhbmNlb2YgRGF0ZTtcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gX3N1cGVyLnByb3RvdHlwZS5vblByZWRpY2F0ZS5jYWxsKHRoaXMsIHByZWRpY2F0ZSwgcXVlcnksIHJlcXVpcmVzQ2FzdCk7XG4gICAgICAgICAgICBpZiAoaXNEYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSByZXR1cm5WYWx1ZS5yZXBsYWNlKC9kYXRldGltZScoLiopJyQvLCAnJDEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFWNEFkYXB0b3IucHJvdG90eXBlLm9uRWFjaFNlYXJjaCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgc2VhcmNoID0gdGhpcy5wdnQuc2VhcmNoZXMgfHwgW107XG4gICAgICAgICAgICBzZWFyY2gucHVzaChlLmtleSk7XG4gICAgICAgICAgICB0aGlzLnB2dC5zZWFyY2hlcyA9IHNlYXJjaDtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFWNEFkYXB0b3IucHJvdG90eXBlLm9uU2VhcmNoID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnB2dC5zZWFyY2hlcy5qb2luKCcgT1IgJyk7XG4gICAgICAgIH07XG4gICAgICAgIE9EYXRhVjRBZGFwdG9yLnByb3RvdHlwZS5iZWZvcmVTZW5kID0gZnVuY3Rpb24gKGRtLCByZXF1ZXN0LCBzZXR0aW5ncykge1xuICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCB0aGlzLm9wdGlvbnMuYWNjZXB0KTtcbiAgICAgICAgfTtcbiAgICAgICAgT0RhdGFWNEFkYXB0b3IucHJvdG90eXBlLnByb2Nlc3NSZXNwb25zZSA9IGZ1bmN0aW9uIChkYXRhLCBkcywgcXVlcnksIHhociwgcmVxdWVzdCwgY2hhbmdlcykge1xuICAgICAgICAgICAgdmFyIHB2dERhdGEgPSAncHZ0RGF0YSc7XG4gICAgICAgICAgICB2YXIgcHZ0ID0gcmVxdWVzdCAmJiByZXF1ZXN0W3B2dERhdGFdO1xuICAgICAgICAgICAgdmFyIGVtcHR5QW5kQmF0Y2ggPSBfc3VwZXIucHJvdG90eXBlLnByb2Nlc3NCYXRjaFJlc3BvbnNlLmNhbGwodGhpcywgZGF0YSwgcXVlcnksIHhociwgcmVxdWVzdCwgY2hhbmdlcyk7XG4gICAgICAgICAgICBpZiAoZW1wdHlBbmRCYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbXB0eUFuZEJhdGNoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNvdW50ID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBkYXRhQ291bnQgPSAnQG9kYXRhLmNvdW50JztcbiAgICAgICAgICAgIGlmIChxdWVyeSAmJiBxdWVyeS5yZXF1aXJlc0NvdW50cykge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhQ291bnQgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjb3VudCA9IGRhdGFbZGF0YUNvdW50XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhID0gZGF0YS52YWx1ZTtcbiAgICAgICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgICAgICBhcmdzLmNvdW50ID0gY291bnQ7XG4gICAgICAgICAgICBhcmdzLnJlc3VsdCA9IGRhdGE7XG4gICAgICAgICAgICB0aGlzLmdldEFnZ3JlZ2F0ZVJlc3VsdChwdnQsIGRhdGEsIGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIHV0aWxfMS5EYXRhVXRpbC5pc051bGwoY291bnQpID8gYXJncy5yZXN1bHQgOiB7IHJlc3VsdDogYXJncy5yZXN1bHQsIGNvdW50OiBjb3VudCwgYWdncmVnYXRlczogYXJncy5hZ2dyZWdhdGVzIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBPRGF0YVY0QWRhcHRvcjtcbiAgICB9KE9EYXRhQWRhcHRvcikpO1xuICAgIGV4cG9ydHMuT0RhdGFWNEFkYXB0b3IgPSBPRGF0YVY0QWRhcHRvcjtcbiAgICB2YXIgV2ViQXBpQWRhcHRvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhXZWJBcGlBZGFwdG9yLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBXZWJBcGlBZGFwdG9yKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIFdlYkFwaUFkYXB0b3IucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChkbSwgZGF0YSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICB1cmw6IGRtLmRhdGFTb3VyY2UudXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBXZWJBcGlBZGFwdG9yLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZG0sIGtleUZpZWxkLCB2YWx1ZSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgIHVybDogZG0uZGF0YVNvdXJjZS51cmwgKyAnLycgKyB2YWx1ZSxcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIFdlYkFwaUFkYXB0b3IucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkbSwga2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BVVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBkbS5kYXRhU291cmNlLnVybCxcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIFdlYkFwaUFkYXB0b3IucHJvdG90eXBlLmJlZm9yZVNlbmQgPSBmdW5jdGlvbiAoZG0sIHJlcXVlc3QsIHNldHRpbmdzKSB7XG4gICAgICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxJyk7XG4gICAgICAgIH07XG4gICAgICAgIFdlYkFwaUFkYXB0b3IucHJvdG90eXBlLnByb2Nlc3NSZXNwb25zZSA9IGZ1bmN0aW9uIChkYXRhLCBkcywgcXVlcnksIHhociwgcmVxdWVzdCwgY2hhbmdlcykge1xuICAgICAgICAgICAgdmFyIHB2dERhdGEgPSAncHZ0RGF0YSc7XG4gICAgICAgICAgICB2YXIgcHZ0ID0gcmVxdWVzdCAmJiByZXF1ZXN0W3B2dERhdGFdO1xuICAgICAgICAgICAgdmFyIGNvdW50ID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgICAgICBpZiAocmVxdWVzdCAmJiByZXF1ZXN0LnR5cGUudG9Mb3dlckNhc2UoKSAhPT0gJ3Bvc3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZlcnNpb25DaGVjayA9IHhociAmJiByZXF1ZXN0LmdldFJlc3BvbnNlSGVhZGVyKCdEYXRhU2VydmljZVZlcnNpb24nKTtcbiAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbiA9ICh2ZXJzaW9uQ2hlY2sgJiYgcGFyc2VJbnQodmVyc2lvbkNoZWNrLCAxMCkpIHx8IDI7XG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5ICYmIHF1ZXJ5LnJlcXVpcmVzQ291bnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdXRpbF8xLkRhdGFVdGlsLmlzTnVsbChkYXRhLkNvdW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgPSBkYXRhLkNvdW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMyAmJiBkYXRhLkl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLkl0ZW1zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcmdzLmNvdW50ID0gY291bnQ7XG4gICAgICAgICAgICAgICAgYXJncy5yZXN1bHQgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QWdncmVnYXRlUmVzdWx0KHB2dCwgZGF0YSwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcmdzLnJlc3VsdCA9IGFyZ3MucmVzdWx0IHx8IGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdXRpbF8xLkRhdGFVdGlsLmlzTnVsbChjb3VudCkgPyBhcmdzLnJlc3VsdCA6IHsgcmVzdWx0OiBhcmdzLnJlc3VsdCwgY291bnQ6IGFyZ3MuY291bnQsIGFnZ3JlZ2F0ZXM6IGFyZ3MuYWdncmVnYXRlcyB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gV2ViQXBpQWRhcHRvcjtcbiAgICB9KE9EYXRhQWRhcHRvcikpO1xuICAgIGV4cG9ydHMuV2ViQXBpQWRhcHRvciA9IFdlYkFwaUFkYXB0b3I7XG4gICAgdmFyIFdlYk1ldGhvZEFkYXB0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoV2ViTWV0aG9kQWRhcHRvciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gV2ViTWV0aG9kQWRhcHRvcigpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgfVxuICAgICAgICBXZWJNZXRob2RBZGFwdG9yLnByb3RvdHlwZS5wcm9jZXNzUXVlcnkgPSBmdW5jdGlvbiAoZG0sIHF1ZXJ5LCBoaWVyYXJjaHlGaWx0ZXJzKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gbmV3IFVybEFkYXB0b3IoKS5wcm9jZXNzUXVlcnkoZG0sIHF1ZXJ5LCBoaWVyYXJjaHlGaWx0ZXJzKTtcbiAgICAgICAgICAgIHZhciBnZXREYXRhID0gJ2RhdGEnO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB1dGlsXzEuRGF0YVV0aWwucGFyc2UucGFyc2VKc29uKG9ialtnZXREYXRhXSk7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAndmFsdWUnO1xuICAgICAgICAgICAgaWYgKGRhdGEucGFyYW0pIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEucGFyYW0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtID0gZGF0YS5wYXJhbVtpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IE9iamVjdC5rZXlzKHBhcmFtKVswXTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBwYXJhbVtrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdFt2YWx1ZV0gPSBkYXRhO1xuICAgICAgICAgICAgdmFyIHB2dERhdGEgPSAncHZ0RGF0YSc7XG4gICAgICAgICAgICB2YXIgdXJsID0gJ3VybCc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHJlc3VsdCksXG4gICAgICAgICAgICAgICAgdXJsOiBvYmpbdXJsXSxcbiAgICAgICAgICAgICAgICBwdnREYXRhOiBvYmpbcHZ0RGF0YV0sXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBXZWJNZXRob2RBZGFwdG9yO1xuICAgIH0oVXJsQWRhcHRvcikpO1xuICAgIGV4cG9ydHMuV2ViTWV0aG9kQWRhcHRvciA9IFdlYk1ldGhvZEFkYXB0b3I7XG4gICAgdmFyIFJlbW90ZVNhdmVBZGFwdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFJlbW90ZVNhdmVBZGFwdG9yLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBSZW1vdGVTYXZlQWRhcHRvcigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBlajJfYmFzZV8xLnNldFZhbHVlKCdiZWZvcmVTZW5kJywgVXJsQWRhcHRvci5wcm90b3R5cGUuYmVmb3JlU2VuZCwgX3RoaXMpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5zZXRWYWx1ZSgnaW5zZXJ0JywgVXJsQWRhcHRvci5wcm90b3R5cGUuaW5zZXJ0LCBfdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8xLnNldFZhbHVlKCd1cGRhdGUnLCBVcmxBZGFwdG9yLnByb3RvdHlwZS51cGRhdGUsIF90aGlzKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzEuc2V0VmFsdWUoJ3JlbW92ZScsIFVybEFkYXB0b3IucHJvdG90eXBlLnJlbW92ZSwgX3RoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIFJlbW90ZVNhdmVBZGFwdG9yLnByb3RvdHlwZS5iYXRjaFJlcXVlc3QgPSBmdW5jdGlvbiAoZG0sIGNoYW5nZXMsIGUpIHtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNoYW5nZXMuYWRkZWRSZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgSnNvbkFkYXB0b3IucHJvdG90eXBlLmluc2VydChkbSwgY2hhbmdlcy5hZGRlZFJlY29yZHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNoYW5nZXMuY2hhbmdlZFJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBKc29uQWRhcHRvci5wcm90b3R5cGUudXBkYXRlKGRtLCBlLmtleSwgY2hhbmdlcy5jaGFuZ2VkUmVjb3Jkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2hhbmdlcy5kZWxldGVkUmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIEpzb25BZGFwdG9yLnByb3RvdHlwZS5yZW1vdmUoZG0sIGUua2V5LCBjaGFuZ2VzLmRlbGV0ZWRSZWNvcmRzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogZG0uZGF0YVNvdXJjZS5iYXRjaFVybCB8fCBkbS5kYXRhU291cmNlLmNydWRVcmwgfHwgZG0uZGF0YVNvdXJjZS51cmwsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZDogY2hhbmdlcy5jaGFuZ2VkUmVjb3JkcyxcbiAgICAgICAgICAgICAgICAgICAgYWRkZWQ6IGNoYW5nZXMuYWRkZWRSZWNvcmRzLFxuICAgICAgICAgICAgICAgICAgICBkZWxldGVkOiBjaGFuZ2VzLmRlbGV0ZWRSZWNvcmRzLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdiYXRjaCcsXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlOiBlLnVybCxcbiAgICAgICAgICAgICAgICAgICAga2V5OiBlLmtleVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUmVtb3RlU2F2ZUFkYXB0b3I7XG4gICAgfShKc29uQWRhcHRvcikpO1xuICAgIGV4cG9ydHMuUmVtb3RlU2F2ZUFkYXB0b3IgPSBSZW1vdGVTYXZlQWRhcHRvcjtcbiAgICB2YXIgQ2FjaGVBZGFwdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKENhY2hlQWRhcHRvciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQ2FjaGVBZGFwdG9yKGFkYXB0b3IsIHRpbWVTdGFtcCwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5pc0NydWRBY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmlzSW5zZXJ0QWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoYWRhcHRvcikpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5jYWNoZUFkYXB0b3IgPSBhZGFwdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMucGFnZVNpemUgPSBwYWdlU2l6ZTtcbiAgICAgICAgICAgIF90aGlzLmd1aWRJZCA9IHV0aWxfMS5EYXRhVXRpbC5nZXRHdWlkKCdjYWNoZUFkYXB0b3InKTtcbiAgICAgICAgICAgIHZhciBvYmogPSB7IGtleXM6IFtdLCByZXN1bHRzOiBbXSB9O1xuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKF90aGlzLmd1aWRJZCwgSlNPTi5zdHJpbmdpZnkob2JqKSk7XG4gICAgICAgICAgICB2YXIgZ3VpZCA9IF90aGlzLmd1aWRJZDtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZCh0aW1lU3RhbXApKSB7XG4gICAgICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHV0aWxfMS5EYXRhVXRpbC5wYXJzZS5wYXJzZUpzb24od2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGd1aWQpKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvckRlbCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEucmVzdWx0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gK25ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdFRpbWUgPSArbmV3IERhdGUoZGF0YS5yZXN1bHRzW2ldLnRpbWVTdGFtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHNbaV0udGltZVN0YW1wID0gY3VycmVudFRpbWUgLSByZXF1ZXN0VGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSAtIHJlcXVlc3RUaW1lID4gdGltZVN0YW1wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yRGVsLnB1c2goaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmb3JEZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucmVzdWx0cy5zcGxpY2UoZm9yRGVsW2ldLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEua2V5cy5zcGxpY2UoZm9yRGVsW2ldLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oZ3VpZCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShndWlkLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICAgICAgfSwgdGltZVN0YW1wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBDYWNoZUFkYXB0b3IucHJvdG90eXBlLmdlbmVyYXRlS2V5ID0gZnVuY3Rpb24gKHVybCwgcXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBxdWVyaWVzID0gdGhpcy5nZXRRdWVyeVJlcXVlc3QocXVlcnkpO1xuICAgICAgICAgICAgdmFyIHNpbmdsZXMgPSBxdWVyeV8xLlF1ZXJ5LmZpbHRlclF1ZXJ5TGlzdHMocXVlcnkucXVlcmllcywgWydvblNlbGVjdCcsICdvblBhZ2UnLCAnb25Ta2lwJywgJ29uVGFrZScsICdvblJhbmdlJ10pO1xuICAgICAgICAgICAgdmFyIGtleSA9IHVybDtcbiAgICAgICAgICAgIHZhciBwYWdlID0gJ29uUGFnZSc7XG4gICAgICAgICAgICBpZiAocGFnZSBpbiBzaW5nbGVzKSB7XG4gICAgICAgICAgICAgICAga2V5ICs9IHNpbmdsZXNbcGFnZV0ucGFnZUluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcmllcy5zb3J0cy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICBrZXkgKz0gb2JqLmUuZGlyZWN0aW9uICsgb2JqLmUuZmllbGROYW1lO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBxdWVyaWVzLmdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICBrZXkgKz0gb2JqLmUuZmllbGROYW1lO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBxdWVyaWVzLnNlYXJjaGVzLmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgIGtleSArPSBvYmouZS5zZWFyY2hLZXk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIGZpbHRlciA9IDA7IGZpbHRlciA8IHF1ZXJpZXMuZmlsdGVycy5sZW5ndGg7IGZpbHRlcisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBxdWVyaWVzLmZpbHRlcnNbZmlsdGVyXTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEZpbHRlci5lLmlzQ29tcGxleCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3UXVlcnkgPSBxdWVyeS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICBuZXdRdWVyeS5xdWVyaWVzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3VycmVudEZpbHRlci5lLnByZWRpY2F0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1F1ZXJ5LnF1ZXJpZXMucHVzaCh7IGZuOiAnb25XaGVyZScsIGU6IGN1cnJlbnRGaWx0ZXIuZS5wcmVkaWNhdGVzW2ldLCBmaWx0ZXI6IHF1ZXJ5LnF1ZXJpZXMuZmlsdGVyIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGtleSArPSBjdXJyZW50RmlsdGVyLmUuY29uZGl0aW9uICsgdGhpcy5nZW5lcmF0ZUtleSh1cmwsIG5ld1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGtleSArPSBjdXJyZW50RmlsdGVyLmUuZmllbGQgKyBjdXJyZW50RmlsdGVyLmUub3BlcmF0b3IgKyBjdXJyZW50RmlsdGVyLmUudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgfTtcbiAgICAgICAgQ2FjaGVBZGFwdG9yLnByb3RvdHlwZS5wcm9jZXNzUXVlcnkgPSBmdW5jdGlvbiAoZG0sIHF1ZXJ5LCBoaWVyYXJjaHlGaWx0ZXJzKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5nZW5lcmF0ZUtleShkbS5kYXRhU291cmNlLnVybCwgcXVlcnkpO1xuICAgICAgICAgICAgdmFyIGNhY2hlZEl0ZW1zO1xuICAgICAgICAgICAgY2FjaGVkSXRlbXMgPSB1dGlsXzEuRGF0YVV0aWwucGFyc2UucGFyc2VKc29uKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmd1aWRJZCkpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBjYWNoZWRJdGVtcyA/IGNhY2hlZEl0ZW1zLnJlc3VsdHNbY2FjaGVkSXRlbXMua2V5cy5pbmRleE9mKGtleSldIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChkYXRhICE9IG51bGwgJiYgIXRoaXMuaXNDcnVkQWN0aW9uICYmICF0aGlzLmlzSW5zZXJ0QWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzQ3J1ZEFjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmlzSW5zZXJ0QWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhY2hlQWRhcHRvci5wcm9jZXNzUXVlcnkuYXBwbHkodGhpcy5jYWNoZUFkYXB0b3IsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSk7XG4gICAgICAgIH07XG4gICAgICAgIENhY2hlQWRhcHRvci5wcm90b3R5cGUucHJvY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24gKGRhdGEsIGRzLCBxdWVyeSwgeGhyLCByZXF1ZXN0LCBjaGFuZ2VzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0luc2VydEFjdGlvbiB8fCAocmVxdWVzdCAmJiB0aGlzLmNhY2hlQWRhcHRvci5vcHRpb25zLmJhdGNoICYmXG4gICAgICAgICAgICAgICAgdXRpbF8xLkRhdGFVdGlsLmVuZHNXaXRoKHJlcXVlc3QudXJsLCB0aGlzLmNhY2hlQWRhcHRvci5vcHRpb25zLmJhdGNoKSAmJiByZXF1ZXN0LnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ3Bvc3QnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNhY2hlQWRhcHRvci5wcm9jZXNzUmVzcG9uc2UoZGF0YSwgZHMsIHF1ZXJ5LCB4aHIsIHJlcXVlc3QsIGNoYW5nZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YSA9IHRoaXMuY2FjaGVBZGFwdG9yLnByb2Nlc3NSZXNwb25zZS5hcHBseSh0aGlzLmNhY2hlQWRhcHRvciwgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDApKTtcbiAgICAgICAgICAgIHZhciBrZXkgPSBxdWVyeSA/IHRoaXMuZ2VuZXJhdGVLZXkoZHMuZGF0YVNvdXJjZS51cmwsIHF1ZXJ5KSA6IGRzLmRhdGFTb3VyY2UudXJsO1xuICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICAgICAgb2JqID0gdXRpbF8xLkRhdGFVdGlsLnBhcnNlLnBhcnNlSnNvbih3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5ndWlkSWQpKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IG9iai5rZXlzLmluZGV4T2Yoa2V5KTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBvYmoucmVzdWx0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIG9iai5rZXlzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYmoucmVzdWx0c1tvYmoua2V5cy5wdXNoKGtleSkgLSAxXSA9IHsga2V5czoga2V5LCByZXN1bHQ6IGRhdGEucmVzdWx0LCB0aW1lU3RhbXA6IG5ldyBEYXRlKCksIGNvdW50OiBkYXRhLmNvdW50IH07XG4gICAgICAgICAgICB3aGlsZSAob2JqLnJlc3VsdHMubGVuZ3RoID4gdGhpcy5wYWdlU2l6ZSkge1xuICAgICAgICAgICAgICAgIG9iai5yZXN1bHRzLnNwbGljZSgwLCAxKTtcbiAgICAgICAgICAgICAgICBvYmoua2V5cy5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5ndWlkSWQsIEpTT04uc3RyaW5naWZ5KG9iaikpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgIENhY2hlQWRhcHRvci5wcm90b3R5cGUuYmVmb3JlU2VuZCA9IGZ1bmN0aW9uIChkbSwgcmVxdWVzdCwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgIGlmICh1dGlsXzEuRGF0YVV0aWwuZW5kc1dpdGgoc2V0dGluZ3MudXJsLCB0aGlzLmNhY2hlQWRhcHRvci5vcHRpb25zLmJhdGNoKSAmJiBzZXR0aW5ncy50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICdwb3N0Jykge1xuICAgICAgICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgdGhpcy5jYWNoZUFkYXB0b3Iub3B0aW9ucy5tdWx0aXBhcnRBY2NlcHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkbS5kYXRhU291cmNlLmNyb3NzRG9tYWluKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCB0aGlzLmNhY2hlQWRhcHRvci5vcHRpb25zLmFjY2VwdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENhY2hlQWRhcHRvci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRtLCBrZXlGaWVsZCwgdmFsdWUsIHRhYmxlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5pc0NydWRBY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVBZGFwdG9yLnVwZGF0ZShkbSwga2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUpO1xuICAgICAgICB9O1xuICAgICAgICBDYWNoZUFkYXB0b3IucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChkbSwgZGF0YSwgdGFibGVOYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmlzSW5zZXJ0QWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhY2hlQWRhcHRvci5pbnNlcnQoZG0sIGRhdGEsIHRhYmxlTmFtZSk7XG4gICAgICAgIH07XG4gICAgICAgIENhY2hlQWRhcHRvci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGRtLCBrZXlGaWVsZCwgdmFsdWUsIHRhYmxlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5pc0NydWRBY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVBZGFwdG9yLnJlbW92ZShkbSwga2V5RmllbGQsIHZhbHVlLCB0YWJsZU5hbWUpO1xuICAgICAgICB9O1xuICAgICAgICBDYWNoZUFkYXB0b3IucHJvdG90eXBlLmJhdGNoUmVxdWVzdCA9IGZ1bmN0aW9uIChkbSwgY2hhbmdlcywgZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVBZGFwdG9yLmJhdGNoUmVxdWVzdChkbSwgY2hhbmdlcywgZSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDYWNoZUFkYXB0b3I7XG4gICAgfShVcmxBZGFwdG9yKSk7XG4gICAgZXhwb3J0cy5DYWNoZUFkYXB0b3IgPSBDYWNoZUFkYXB0b3I7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2FkYXB0b3JzLmpzXG4vLyBtb2R1bGUgaWQgPSA1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0="]}